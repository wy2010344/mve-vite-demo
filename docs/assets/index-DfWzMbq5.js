import{c as K,A as P,Y as h,o as _,B as R,W as B,D as G,u as Y,h as J,b as Q,f as a,j as U,i as D,t as Z,E as p,G as w,H as k,I as E,J as ee,y as $,K as y,L as te,M as ne,N as C}from"./index-Bn6QTqXa.js";import{c as re,f as b,h as se,W as ae,S as I,a as oe}from"./index-kFouXtHG.js";import{e as ie}from"./explain-BfYJqPeK.js";import{a as le}from"./onlyMobile-BnCzafOQ.js";import{f as ce}from"./fixRightTop-CsVmRhcQ.js";import{t as me}from"./themeDropdown-CfiI-V9V.js";import de from"./demoList-CkdQZycw.js";import{f as fe}from"./chunk-KZPPZA2C-rvBpA5M9.js";import{O as ue,e as he,m as ye}from"./index-XVZQUbQ5.js";import"./index-DJ5LxReq.js";import"./iconBase-UU481Axx.js";import"./index-BxY9dVzG.js";import"./index-BlR3DG8s.js";import"./mve-icon-2ZBqkA6T.js";import"./canvasRender-DlxfwZGY.js";import"./_commonjsHelpers-CqkleIqs.js";const z="select-cell";function Ce(){ie(()=>{}),le(function({width:f},g){g&&ce(function(){re(),me()});const s=K(h.fromDate(new Date),P),c=_(r=>{const o=s.get();return new R(o.year,o.month,b.get())}),x=_(()=>{const r=s.get();return B.from(r.year,r.month,r.day,b.get())}),V=window;V.__date=s;const l=new ue("y",{maxScroll(){return S.get()},targetSnap:G([{beforeForce:1,size:m()*5,afterForce:1}])}),S=l.measureMaxScroll();function m(){return f()/7}const u=_(()=>l.get()>=5*m()),T=Y(()=>{const r=m(),o=r*5,e=te(p(s.get()),b.get())-1;return E({0:0,[o]:-r*e},C)}),N=he({direction:"x",getValue:s.get,compare(r,o){const e=p(o).valueOf(),i=p(r).valueOf()-e;let n=0;return i>=k?n=1:i<=-k&&(n=-1),n},callback(r){const o=p(s.get());o.setTime(o.getTime()+r*k),s.set(h.fromDate(o))}});let M=s.get();J(()=>N.onAnimation(),function(r){r||(M.equals(s.get())||Q(()=>{u()?l.animateTo(m()*5):l.animateTo(0)}),M=s.get())});const v=ye({getSize(){return H.clientWidth}});se(s.get,z);const j=Y(()=>{const r=m()*5;return E({0:m()*7,[r]:m()*2},C)}),H=a.div({s_height:"100%",s_overflow:"hidden",s_userSelect:"none",onTouchMove(r){r.preventDefault()},onWheel:l.wheelEventListener,onPointerDown:l.pointerEventListner,children(r){v.hookCompare(x,function(e,t){return u()?e.cells[0].toNumber()-t.cells[0].toNumber():0}),v.hookCompare(c,function(e,t){return u()?0:e.toNumber()-t.toNumber()});const o=a.div({s_transform(){return`translateY(${-l.get()}px)`},className:"flex flex-col",s_minHeight(){return`calc(100% + ${f()}px * 5 / 7)`},children(){a.div({className:"bg-base-100 relative z-10",s_display:"flex",s_alignItems:"stretch",s_transform(){return`translateY(${Math.max(l.get(),0)}px)`},children(){a.h1({className:"text-display-large",childrenType:"text",children(){return s.get().month}}),a.div({className:"flex flex-col items-start justify-center",children(){a.div({className:"text-title-large",childrenType:"text",children(){return s.get().year}}),a.div({className:"text-title-medium",childrenType:"text",children(){return`月 ${s.get().day}日`}})}})}}),a.div({s_zIndex:1,s_position:"relative",s_height(){return`${m()*7}px`},children(){a.div({className:"bg-base-300",s_overflow:"hidden",s_height(){const e=l.get();return`${j(e)}px`},s_transform(){return`translateY(${Math.max(l.get(),0)}px)`},onPointerDown(e){Z(v.getMoveEvent(e,"x",{callback(t,i){if(u()){const n=p(s.get());n.setTime(n.getTime()+t*ae),t&&s.set(h.fromDate(n))}else{const n=t<0?c().lastMonth():c().nextMonth();s.get().day>n.days?s.set(h.from(n.year,n.month,n.days)):s.set(h.from(n.year,n.month,s.get().day))}}}))},children(){a.div({s_position:"relative",s_transform(){return`translateX(${-v.get()}px)`},children(){U(u,function(){D(()=>{const e=x();return[e.beforeWeek(),e,e.nextWeek()]},e=>e.cells[0].toNumber(),function(e,t){q(e(),t)})},function(){D(()=>{const e=c();return[e.lastMonth(),e,e.nextMonth()]},e=>e.toNumber(),function(e,t){X(e(),t)})})}})}})}}),a.div({className:" flex-1",data_a:"99",plugin:N.plugin,children(){a.div({className:"relative",s_transform(){return`translateX(${-N.get()}px)`},children(){D(()=>{const e=s.get();return[e.beforeDay(),e,e.nextDay()]},e=>e.toNumber(),function(e,t){w.div({attrs(i){const n=t();n!=1&&(i.s_position="absolute",i.s_inset=0,i.s_transform=`translateX(${(n-1)*100}%)`)},children(){de(fe.number.int({max:17,min:15}))}})})}})}})}});S.hookInit(r,o)}});function X(r,o){function e(){const t=s.get(),i=r;return t.year==i.year&&t.month==i.month}return w.div({attrs(t){const i=o();if(i==1){const n=l.get();t.s_transform=` translateY(${T(n)}px)`}else t.s_position="absolute",t.s_inset=0,t.s_transform=`translateX(${(i-1)*100}%)`},children(){W(()=>{const t=l.get();return`translateY(${-T(t)}px)`}),a.div({children(){for(let t=0;t<6;t++)a.div({className:"flex items-center justify-center relative",children(){for(let i=0;i<7;i++){const n=r.fullDayOf(i,t);let d=r;n.type=="last"?d=r.lastMonth():n.type=="next"&&(d=r.nextMonth()),O(i,{year:d.year,month:d.month,day:n.day});const F=I.fromYmd(d.year,d.month,n.day).getLunarDay(),A=_(()=>n.type=="this"&&e()&&s.get().day==n.day);L({day:n.day,onClick(){s.set(h.from(d.year,d.month,n.day))},lunarDay:F,selected:A,hide(){return u()?!1:n.type!="this"}})}}})}})}})}function W(r){a.div({className:"bg-base-300 relative z-10",s_display:"flex",s_alignItems:"center",s_justifyContent:"space-between",s_transform:r,children(){for(let o=0;o<7;o++)a.div({className:"flex-1 aspect-square flex items-center justify-center",childrenType:"text",children(){return oe[c().weekDay(o)]}})}})}function q(r,o){w.div({attrs(e){e.className="self-start",o()!=1&&(e.s_position="absolute",e.s_inset=0,e.s_transform=`translateX(${(o()-1)*100}%)`)},children(){W(),a.div({className:"flex items-center justify-center relative",children(){for(let e=0;e<7;e++){const t=r.cells[e];O(e,t);const n=I.fromYmd(t.year,t.month,t.day).getLunarDay();L({hide(){return!1},day:t.day,lunarDay:n,selected(){return ne(t,s.get())},onClick(){s.set(t)}})}}})}})}})}function O(f,g){f==0&&a.div({className:"absolute left-0 text-label-small",childrenType:"text",children(){return ee(p(g),b.get())}})}function L({day:f,lunarDay:g,hide:s,selected:c,onClick:x}){a.div({s_flex:1,s_aspectRatio:1,s_display:"flex",s_flexDirection:"column",s_alignItems:"center",s_justifyContent:"center",className(){return s()?y` opacity-30`:""},onClick:x,children(){a.div({s_aspectRatio:1,s_display:"grid",s_placeItems:"center",s_position:"relative",children(){a.div({id(){return c()?z:""},className(){return $(y`absolute inset-0  rounded-full z-0`,c()&&y`bg-primary`)}}),a.span({s_position:"relative",className(){return $(c()?y`text-primary-content`:y`text-base-content`,y`transition-all`)},childrenType:"text",children:f})}}),a.div({s_fontSize:"10px",childrenType:"text",className:"text-neutral-500",children:g.getName()})}})}export{Ce as default};
