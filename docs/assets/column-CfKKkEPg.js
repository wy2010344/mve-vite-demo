import{m as E,c as I,b9 as t}from"./index-BdTCZeBf.js";import{TaskContext as N,ColumnContext as k,priorityTypes as h}from"./type-Dy4uOjPx.js";import{L as T,t as D}from"./task-BgSqXJ5g.js";import{HookRender as A,ArrayRender as C,If as S}from"./xmlRender-DvTUnvyT.js";import{r as w}from"./mve-icon-BCevzIn5.js";import F from"./indicator-B6W5iM_b.js";import{f}from"./chunk-LSEVNFON-G8OzWBoO.js";import"./iconBase-C9j_FKPc.js";function B({title:v,type:i}){const{dragId:p,tasks:n}=N.consume(),u=E(function(){return n.get().filter(e=>e.type==i)}),d=I(void 0);k.provide({type:i,getActive:d.get});function b(e){var s;const o=Array.from(document.querySelectorAll(`[data-column="${i}"]`)),r=100,a=(s=o.reduce((m,x)=>{const y=x.getBoundingClientRect(),g=e-(y.top+r/2);return g<0&&g>m.offset?{offset:g,element:x}:m},{offset:Number.NEGATIVE_INFINITY,element:o.at(-1)}).element)==null?void 0:s.dataset.before;return d.get()!=a&&d.set(a),a}return t.createElement("div",{className:"daisy-card bg-base-200 w-80 shrink-0 h-full"},t.createElement("div",{className:"daisy-card-body p-4 flex flex-col h-full "},t.createElement("div",{className:"flex items-center justify-between mb-4"},t.createElement("div",{className:"flex items-center gap-2"},t.createElement("h3",{className:"daisy-card-title text-sm font-medium"},v),t.createElement("div",{className:"daisy-badge daisy-badge-neutral daisy-badge-sm"},()=>u().length)),t.createElement("button",{className:"daisy-btn daisy-btn-ghost daisy-btn-sm daisy-btn-circle",onClick:()=>{n.set(n.get().concat({type:i,id:Date.now()+"",title:f.book.title(),description:f.book.series(),priority:h[f.number.int({min:0,max:2})],assignee:f.book.author(),dueDate:"2024-01-15"}))}},t.createElement(A,{render:()=>{T(w,"24px")}}))),t.createElement("div",{className:"space-y-3 min-h-[200px] flex-1 overflow-y-auto -mx-4 px-4",onDragOver:e=>{e.preventDefault(),e.dataTransfer.dropEffect="move",b(e.clientY)},onDragLeave:e=>{d.set(void 0)},onDrop:e=>{const o=b(e.clientY),r=p.get();if(o!=r){const c=n.get().find(s=>s.id==r),a=c.type==i?c:{...c,type:i},l=n.get().filter(s=>s.id!=r);if(o=="")l.push(a);else{const s=l.findIndex(m=>m.id==o);l.splice(s,0,a)}n.set(l)}d.set(void 0)}},t.createElement(C,{getArray:u,getKey:e=>e.id,render:function(e,o,r){D({getTask:e,onDelete(c){n.set(n.get().filter(a=>a.id!=r))},onDragStart(c){p.set(r)}})}}),t.createElement(F,null),t.createElement(S,{condition:()=>u().length,whenTrue:()=>{t.renderChild(t.createElement("div",{className:"text-center text-base-content/50 text-sm py-8"},"拖拽任务到这里或点击 + 添加新任务"))}}))))}export{B as default};
