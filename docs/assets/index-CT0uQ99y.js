import"./canvasRender-CK3mhhFQ.js";import{aV as Ot,x as V,ar as ct,C as Ft,ab as St,af as tt,ah as b,aW as lt,a8 as $,a9 as Tt,aX as Pt,c as k,h as W,b as I,l as kt,aY as Wt,k as X,Q as yt,o as j,aZ as zt,a_ as Ct,r as Bt,j as Gt,a$ as Et,t as et,aa as nt,b0 as ft,a7 as _t,a1 as z,b1 as Ht,f as rt,y as J,aM as wt,b2 as vt,n as Xt,b3 as Yt,z as Mt,F as $t,i as Kt,b4 as Vt,b5 as jt,aT as Ut,ae as Zt,b6 as qt,e as At,b7 as Jt,b8 as U,b9 as Qt,ba as te,bb as ee,d as ne,bc as re,ao as ut,bd as _}from"./index-Dxu4lnfn.js";function g(t,n,e){return e?function(i){return(i.keyCode==t||i.key==n)&&i.code==e}:function(i){return i.keyCode==t||i.key==n}}function gt(t,n){const e=[];t.firstChild&&e.push(t.firstChild);let i=e.pop();for(;i&&!n(i);)i.nextSibling&&e.push(i.nextSibling),i.firstChild&&e.push(i.firstChild),i=e.pop()}const B={DOM:{supportTouch:Ot(()=>"ontouchstart"in window),addEvent(t,n,e){t.addEventListener(n,e)},removeEvent(t,n,e){t.removeEventListener(n,e)},preventDefault(t){t.preventDefault()},stopPropagation(t){t.stopPropagation()},getSelectionRange(t){let{anchorNode:n,anchorOffset:e,focusNode:i,focusOffset:r}=Z(t);if(!n||!i)return null;if(n==t&&i==t)return{start:e>0&&t.textContent?t.textContent.length:0,end:r>0&&t.textContent?t.textContent.length:0,dir:r>=e?"->":"<-"};if(n.nodeType===Node.ELEMENT_NODE){const s=document.createTextNode("");n.insertBefore(s,n.childNodes[e]),n=s,e=0}if(i.nodeType===Node.ELEMENT_NODE){const s=document.createTextNode("");i.insertBefore(s,i.childNodes[r]),i=s,r=0}const o={start:0,end:0};return gt(t,function(s){if(s==n&&s==i)return o.start+=e,o.end+=r,o.dir=e<=r?"->":"<-",!0;if(s===n)if(o.start+=e,!o.dir)o.dir="->";else return!0;else if(s===i)if(o.end+=r,!o.dir)o.dir="<-";else return!0;s.nodeType===Node.TEXT_NODE&&(o.dir!="->"&&(o.start+=s.nodeValue.length),o.dir!="<-"&&(o.end+=s.nodeValue.length))}),t.normalize(),o},setSelectionRange(t,n){if(!n){const l=Z(t);return l.removeAllRanges(),l}const e={...n},i=Z(t);let r,o=0,s,a=0;if(e.dir||(e.dir="->"),e.start<0&&(e.start=0),e.end<0&&(e.end=0),e.dir=="<-"){const{start:l,end:f}=e;e.start=f,e.end=l}let c=0;return gt(t,l=>{if(l.nodeType!==Node.TEXT_NODE)return;const f=(l.nodeValue||"").length;if(c+f>e.start&&(r||(r=l,o=e.start-c),c+f>e.end))return s=l,a=e.end-c,!0;c+=f}),r||(r=t,o=t.childNodes.length),s||(s=t,a=t.childNodes.length),e.dir=="<-"&&([r,o,s,a]=[s,a,r,o]),i.setBaseAndExtent(r,o,s,a),i},keyCode:{BACKSPACE:g(8,"Backspace"),ENTER:g(13,"Enter"),TAB:g(9,"Tab"),ESCAPE:g(27,"Escape"),CAPSLOCK:g(20,"CapsLock"),ARROWLEFT:g(37,"ArrowLeft"),ARROWUP:g(38,"ArrowUp"),ARROWRIGHT:g(39,"ArrowRight"),ARROWDOWN:g(40,"ArrowDown"),CONTROL:g(17,"Control"),SHIFT:g(16,"Shift"),SHIFTLEFT:g(16,"Shift","ShiftLeft"),SHIFTRIGHT:g(16,"Shift","ShiftRight"),META:g(91,"Meta"),METALEFT:g(91,"Meta","MetaLeft"),METARIGHT:g(91,"Meta","MetaRight"),ALT:g(18,"Alt"),ALTLEFT:g(18,"Alt","AltLeft"),ALTRIGHT:g(18,"Alt","AltRight"),A:g(65,"a"),Z:g(90,"z"),V:g(86,"v"),C:g(67,"c"),X:g(88,"x")}},isIE:!1},ie=(function(){const t={type:"FF",version:0,documentMode:""};if(!globalThis.navigator)return t;const n=navigator.userAgent,e=n.indexOf("Opera")>-1,i=n.indexOf("compatible")>-1&&n.indexOf("MSIE")>-1&&!e,r=n.indexOf("Firefox")>-1,o=n.indexOf("Safari")>-1;return i&&(B.isIE=!0,new RegExp("MSIE (\\d+\\.\\d+);").test(n),t.type="IE",t.version=parseFloat(RegExp.$1),t.documentMode=document.documentMode),r&&(t.type="FF"),e&&(t.type="Opera"),o&&(t.type="Safari"),t})();function oe(t){return{scrollLeft:0,scrollTop:0,range:{start:t.length,end:t.length},value:t}}function Z(t){return t.parentNode?.nodeType==Node.DOCUMENT_FRAGMENT_NODE?t.parentNode.getSelection():window.getSelection()}function Q(t){return t.history[t.currentIndex]}function dt(t){return{currentIndex:0,history:[oe(t)]}}function K(t){const n=t.textContent||"",e=B.DOM.getSelectionRange(t);if(!e)throw"error-1";return{scrollTop:t.scrollTop,scrollLeft:t.scrollLeft,value:n,range:e}}function se(t){return ae(t,`
`,1)}function it(t,n){return t-n}function ae(t,n,e){const{value:i,range:r,...o}=K(t),[s,a]=[r.start,r.end].sort(it),c=i.slice(0,s),l=i.slice(a,i.length)||`
`,f=c.length+e;return{...o,value:c+n+l,range:{start:f,end:f,dir:r.dir}}}function ce(t){const{value:n,range:e,...i}=K(t),[r,o]=[e.start,e.end].sort(it),s=n.slice(0,r),a=n.slice(o,n.length);if(r!=o)return{...i,value:s+a,range:{start:r,end:r}};if(r!=0){const c=e.start-1;return{...i,value:s.slice(0,s.length-1)+a,range:{...e,start:c,end:c}}}}function le(t,n,e="	"){const{value:i,range:r,...o}=K(t),[s,a]=[r.start,r.end].sort(it);if(r.start!=r.end)if(n){const c=i.split(`
`);let l=0;const f=[];let h=!1,m=0,y=0;for(let C=0;C<c.length;C++){const d=c[C],u=l+d.length+1;l<=s&&s<u&&(h=!0,d.startsWith(e)&&l+e.length<=s&&(y=e.length)),h&&d.startsWith(e)?(m++,f.push(d.slice(e.length,d.length))):f.push(d),l<=a&&a<u&&(h=!1),l=u}return{...o,value:f.join(`
`),range:r.start>r.end?{start:r.start-m*e.length,end:r.end-y,dir:r.dir}:{start:r.start-y,end:r.end-m*e.length,dir:r.dir}}}else{const c=i.split(`
`);let l=0;const f=[];let h=!1,m=0;for(let y=0;y<c.length;y++){const C=c[y],d=l+C.length+1;l<=s&&s<d&&(h=!0),h?(m++,f.push(e+C)):f.push(C),l<=a&&a<d&&(h=!1),l=d}return{...o,value:f.join(`
`),range:r.start>r.end?{start:r.start+m*e.length,end:r.end+e.length,dir:r.dir}:{start:r.start+e.length,end:r.end+m*e.length,dir:r.dir}}}else{const c=i.slice(0,s),l=i.slice(a,i.length);if(n){if(c.endsWith(e)){const f=c.length-e.length;return{...o,value:c.slice(0,c.length-e.length)+l,range:{start:f,end:f}}}}else{const f=c.length+e.length;return{...o,value:c+e+l,range:{start:f,end:f}}}}}const ke=ie.type=="FF"?!0:"plaintext-only";function fe(t,n){const e=B.DOM.setSelectionRange(t,{...n.range});if(t.scrollTop=n.scrollTop,t.scrollLeft=n.scrollLeft,!e.rangeCount)return;const i=e.getRangeAt(0),r=i.endContainer==t?t.lastElementChild:i;if(r){const o=r.getBoundingClientRect();o.bottom>t.clientHeight?t.scrollTop+=o.bottom-t.clientHeight:o.top<0&&(t.scrollTop+=o.top),o.right>t.clientWidth?t.scrollLeft+=o.right-t.clientWidth:o.left<0&&(t.scrollLeft+=o.left)}}function ue(t){const n=t.currentIndex+1;return n<t.history.length?{...t,currentIndex:n}:t}function ge(t){return t.currentIndex?{...t,currentIndex:t.currentIndex-1}:t}function Y(t,n,e=100){const i=t.currentIndex,r=t.history.slice(0,i+1),o=r.length>2?r.at(-1):void 0;if(o&&o.range.start==o.range.end){const s=o.range.start;if(n.range.start==n.range.end){const a=n.range.start-s;if(0<=a&&n.value.startsWith(o.value)&&n.value.length-o.value.length==a)return r.pop(),r.push(n),{currentIndex:i,history:r}}}return r.push(n),r.length>e?(r.shift(),{currentIndex:i,history:r}):{currentIndex:i+1,history:r}}function de(t){return t.metaKey||t.ctrlKey}function We(t,n){return n.addEventListener("input",function(e){e.isComposing||t.set(Y(t.get(),K(n)))}),n.addEventListener("compositionend",function(){t.set(Y(t.get(),K(n)))}),n.addEventListener("keydown",function(e){if(B.DOM.keyCode.TAB(e)){e.preventDefault();const i=le(n,e.shiftKey);i&&t.set(Y(t.get(),i))}else if(B.DOM.keyCode.ENTER(e)){e.preventDefault();const i=se(n);t.set(Y(t.get(),i))}else if(B.DOM.keyCode.Z(e))de(e)&&(e.shiftKey?(e.preventDefault(),t.set(ue(t.get()))):(e.preventDefault(),t.set(ge(t.get()))));else if(B.DOM.keyCode.BACKSPACE(e)){e.preventDefault();const i=ce(n);i&&t.set(Y(t.get(),i))}}),n}const he={getLayout(t){return t._rect},getParentLayout(t){return t.parentNode?._rect},getChildren(t){return t._mve_children_?.target()||At}};function ze(t){const n=Et(he,{...t,axis:{x:{position:t.x,size:t.width,paddingStart:t.paddingLeft,paddingEnd:t.paddingRight},y:{position:t.y,size:t.height,paddingStart:t.paddingTop,paddingEnd:t.paddingBottom}}}),e=t.render(n);return n.target=e,e._rect=n,n}function Be(){const t=k(0),n=k(0),e=_t();let i=!1;return{width:t.get,height:n.get,plugin(r){if(i)throw new Error("can not init again");return i=!0,I(()=>{const o=a=>{t.set(r.offsetWidth),n.set(r.offsetHeight),a&&z()};o();const s=new ResizeObserver(o);s.observe(r),e(()=>{s.disconnect()})},-2),r}}}function Dt(t,n,e,i){const r=function(){e.set(r.value)};W(()=>{i();const o=t();n.shouldChange(o,e.get())&&(r.value=n.toComponentValue(o),I(r,-.5))})}function Lt(t,n,e,i,r){const[o,s]=vt(),a=b("onInputWithComposition");i.input.addEventListener("input",function(c){const l=a();if(l=="onInputWithComposition"){if(c.isComposing||c.inputType==="insertCompositionText")return;s(),e.fromComponent(i.get(),n),z()}else l=="onInput"&&(s(),e.fromComponent(i.get(),n),z())}),i.input.addEventListener("compositionend",c=>{a()=="onInputWithComposition"&&(s(),e.fromComponent(i.get(),n),z())}),i.input.addEventListener("blur",function(c){a()=="onBlur"&&(s(),e.fromComponent(i.get(),n),z())}),Dt(t,e,i,o)}function pe(t,n,e,i,r){return Lt(n,e,t||U,new Jt(i)),i}function Ge(t,n,e,i){return pe(U,t,n,e)}function xe(t,n,e,i,r){return Lt(n,e,t,new Qt(i)),i}function _e(t,n,e,i){return xe(U,t,n,e)}function me(t,n,e,i){const[r,o]=vt();return e.addEventListener("input",function(s){o(),i.fromComponent(e.checked,n),z()}),Dt(t,i,new te(e),r),e}function He(t,n,e){return me(t,n,e,U)}function Xe(t,n){const e=k(dt(t()));return W(t,function(i){I(()=>{Q(e.get()).value!=i&&e.set(dt(i))})}),{get:e.get,set(i){e.set(i);const r=Q(i);return n(r.value,r.range),i}}}function Ye(t){function n(){return Q(t())}return{current:n,renderContentEditable({noFocus:e,children:i}){const r=b(e);kt(()=>n().value,function(o){const s=i(o);W(()=>{r()||I(()=>{fe(s,n())})})})}}}function $e(t,n){Bt(t,(e,i)=>{let r;Gt(()=>{const o=e.step();return o=="exiting"||o=="will-exiting"},()=>{"node"in r?ht(r,e):(r.call?.(),r.list.forEach(o=>{ht(o,e)}))},()=>{r=n(e,i)})})}function ht(t,n){const e=t.node;wt(e);const i=t.applyAnimate;W(n.step,r=>{r=="exiting"&&i(e)})}function bt(t,n){return $t.get(n).getFromVelocity(t).distance}function Se(t,n,{animationConfig:e=jt,getDistanceFromVelocity:i=bt,realTimeValue:r=k(n.get()),count:o,baseIndex:s,disabled:a}=V){const c=b(t),l=$(0),f=b(o||0),h=b(s||0),m=o,y=m?u=>{const S=h();return qt(u-S,f())+S}:Zt;function C(u){const S=r.get()+u;r.set(y(S))}function d(){const u=Math.floor(l.get()/c());u&&(l.silentDiff(-u*c()),C(u))}return W(n.get,function(u){let S=u-r.get();m&&(S=Vt(S,f())),S&&I(()=>{const E=S*c();l.changeTo(E,e,d)})}),{realTimeValue:r.get,beginMove(u,S,{whenMove:E}=V){return l.stop(),nt.from(u,{getPage:S,scrollDelta(D,P,T,N){if(E?.(N,T),l.changeDiff(D),d(),T)return;const O=i(P)+l.get();let w=Math.round(O/c());if(a){const F=Math.sign(D),R=r.get();if(m)for(;a(y(w+R));)w=w+F;else for(;a(w+R);)w=w+F}l.animateTo(w*c(),e,d).then(()=>{d(),n.set(r.get())})}})},scroll:l.get,renderList(u,S){const E=b(u);Ut(function(D){const P=r.get(),T=Math.ceil(E()/c()),N=Math.floor(T/2);for(let O=P-N;O<=P+N;O++){const w=y(O);D(w,w)}},function(D,P){S(D,a?.(D))})}}}function Ke(t){const n=Se(t.cellHeight,t.value,t);return{onPointerDown(e){et(n.beginMove(e,tt))},children(){rt.div({s_transform(){return`translateY(${-n.scroll()}px)`},children(){n.renderList(t.height,t.renderCell)}})}}}function Te(t){return Xt({initialVelocity:t,config:{zta:.8}})}function ye({getPageSnap:t=Te,getSize:n}){const e=$(0);function i(o,s,{scrollEndToChange:a,getDistanceFromVelocity:c=bt,callback:l}){return nt.from(o,{getPage:s=="x"?St:tt,scrollDelta(f,h,m){const y=e.get()+f;if(e.set(y),m)return;const C=c(h)+e.get(),d=Math.abs(C);if(d<n()/2)e.changeTo(0,t(h));else{const u=C>0?1:-1,S=a?Math.min(d,n())*u:n()*u;e.animateTo(S,t(h)).then(E=>{E&&(l(u,h)?e.changeTo(0,t(0)):z())})}}})}function r(o,s){W(j((a,c)=>{const l=o();if(c){const f=Math.sign(s(l,a));f&&I(()=>{const h=f*n();e.get()-h?(e.animateTo(h,t(0)),e.silentDiff(-h)):e.set(0)})}return l}))}return{getSize:n,onAnimation:e.onAnimation,get:e.get,getMoveEvent:i,hookCompare:r}}function Ve({getPageSnap:t,getSize:n,getValue:e,compare:i,direction:r,...o}){let s;const a=ye({getSize:n||(()=>s.clientWidth),getPageSnap:t});return a.hookCompare(e,i),{...a,plugin(c,l=V){s=c,s.addEventListener("pointerdown",f=>{Tt(f,{onDragChange:l.onDragChange,onMove(h,m,y){if(m==r)return a.getMoveEvent(h,r,o)}})})}}}var Ce=class{constructor(t,n){this.container=t,this.content=n}getContainerSize(){return this.container.clientWidth}getContentSize(){return this.content.offsetWidth}},Ee=class{constructor(t,n){this.container=t,this.content=n}getContainerSize(){return this.container.clientHeight}getContentSize(){return this.content.offsetHeight}};function we(t){const n=k(0);let e=!1;return{get:n.get,hookInit(i,r){if(e){console.log("禁止重复初始化");return}e=!0;let o;t=="x"?o=new Ce(i,r):o=new Ee(i,r),I(()=>{n.set(ft(o.getContainerSize(),o.getContentSize()))});const s=new ResizeObserver(function(){n.set(ft(o.getContainerSize(),o.getContentSize()))});s.observe(i),s.observe(r),X(()=>{e=!1,s.disconnect()})}}}function ve(t){return t.deltaX}function Me(t){return t.deltaY}var je=class It{edgeSlow;scrollFactory;get;onAnimation;set(n){return this.drag(n-this.get(),0)}animateTo(n,e){return n=ct(this.getMinScroll(),n,this.getMaxScroll()),this.scroll.animateTo(this.toSnap(n),e)}scrollTo(n){return this.destinationWithMargin(this.scrollFactory.getFromDistance(n-this.get()))}getWheelDetail;measureMaxScroll(){return we(this.direction)}static hookGet(n,e,i){const r=new It(n,i);return e.addEventListener("pointerdown",r.pointerEventListner),e.addEventListener("wheel",r.wheelEventListener),r}minNextScroll;maxNextScroll;getMinScroll;getMaxScroll;scroll;getPage;constructor(n,e){this.direction=n,this.config=e,this.scrollFactory=e?.factory||Ft.get(),this.edgeSlow=this.config.edgeSlow||3,this.direction=="x"?(this.getWheelDetail=ve,this.getPage=St):(this.getWheelDetail=Me,this.getPage=tt),this.getMinScroll=b(e.minScroll||0),this.getMaxScroll=b(e.maxScroll),typeof e.minScroll=="function"&&lt(this.getMinScroll,a=>{a=Math.max(0,a),this.scroll.getTarget()<a&&this.scroll.silentChangeTo(a)}),typeof e.maxScroll=="function"&&lt(this.getMaxScroll,a=>{a=Math.max(a,0),this.scroll.getTarget()>a&&this.scroll.silentChangeTo(a)});const i=this.config.value;typeof i=="number"?this.scroll=$(ct(this.getMinScroll(),i,this.getMaxScroll())):typeof i>"u"?this.scroll=$(this.getMinScroll()):this.scroll=$(i),this.get=this.scroll.get,this.onAnimation=this.scroll.onAnimation;const r=this;let o=performance.now();const s=this.config.opposite?-1:1;this.wheelEventListener=function(a){const c=a.timeStamp-o,l=r.getWheelDetail(a)*s;r.drag(l,l/c),o=a.timeStamp},this.pointerEventListner=function(a){r.scroll.stop(),Tt(a,{onMove(c,l){l==r.direction?(r.config.onDragBegin?.(),et(nt.from(c,{getPage:r.getPage,scrollDelta:r.drag,opposite:r.config.opposite}))):r.scrollToIdeal()},onCancel(c){r.scrollToIdeal()}})}}scrollToIdeal(){const n=this.config.targetSnap;if(n){const e=this.get(),i=n(e);e!=i&&this.animateTo(i)}}toSnap(n){const e=this.config.targetSnap;return e?e(n):n}drag=(n,e,i)=>{const r=this.scroll.get(),o=r+n,s=this.getMinScroll(),a=this.getMaxScroll();if(o<s||o>a){if(o<s&&this.minNextScroll)return this.scroll.set(s),this.minNextScroll.drag(o,e,i);if(o>a&&this.maxNextScroll)return this.scroll.set(a),this.maxNextScroll.drag(o-a,e,i);o<s?this.scroll.set(r+n/this.edgeSlow):this.scroll.set(r+n/this.edgeSlow)}else this.scroll.set(o);i||this.destination(e)};scrollToEdge=(n,e)=>{if(e==this.getMinScroll()&&this.minNextScroll)return this.minNextScroll.destination(n),!0;if(e==this.getMaxScroll()&&this.maxNextScroll)return this.maxNextScroll.destination(n),!0};destinationWithMargin(n){return Pt({...this.config,maxScroll:this.getMaxScroll(),minScroll:this.getMinScroll(),scroll:this.scroll,frictional:n,scrollToEdge:this.scrollToEdge})}destination=n=>this.destinationWithMargin(this.scrollFactory.getFromVelocity(n));pointerEventListner;wheelEventListener};function Ue(t,{className:n,operateClone:e}){X(()=>{const i=t.getBoundingClientRect(),r=t;I(()=>{Ht(o=>{rt.div({className:J("fixed",n),s_left:`${i.left}px`,s_top:`${i.top}px`,s_width:`${i.width}px`,s_height:`${i.height}px`,children(){wt(r)}}),I(()=>{e(r).then(o)})})})})}const Ae={getLayout(t){return t._layout},getParentLayout(t){return t.parent?._layout},getChildren(t){return t._children?.target()||At}};function Ze(t){const n=Et(Ae,{...t,axis:{x:{position:t.x,size:t.width,paddingStart:t.paddingLeft,paddingEnd:t.paddingRight,alignSelf:t.alignSelfX??t.alignSelf},y:{position:t.y,size:t.height,paddingStart:t.paddingBottom,paddingEnd:t.paddingTop,alignSelf:t.alignSelfY??t.alignSelf},z:{position:t.z,size:t.depth,paddingStart:t.paddingBack,paddingEnd:t.paddingFront,alignSelf:t.alignSelfZ??t.alignSelf}}});return n.target=t.render(n),n.target._layout=n,n}function H(t,n,e){n.target.position[e]=t}function qe(t){_(t.axis.x.position,H,t,"x"),_(t.axis.y.position,H,t,"y"),_(t.axis.z.position,H,t,"z")}function Je(t){_(()=>t.axis.x.position()+t.axis.x.size()/2,H,t,"x"),_(()=>t.axis.y.position()+t.axis.y.size()/2,H,t,"y"),_(()=>t.axis.z.position()+t.axis.z.size()/2,H,t,"z")}function pt(t){return typeof t=="function"}function Qe(...t){return t.some(pt)?function(){return J.apply(null,t.map(n=>pt(n)?n():n))}:J.apply(null,t)}const De=[];window.addEventListener("popstate",function(){De.pop()?.()});let xt;(function(t){function n(r,o,...s){return o||(o={}),{type:r,props:o,children:s}}t.createElement=n;function e(r){if(Array.isArray(r)){r.forEach(e);return}if(r)if(typeof r=="object"){const{type:o,props:s,children:a}=r;if(typeof o=="string"){let c;delete s.children,ee(o)?c=ne[o](s):c=rt[o](s),re(c,function(){a?.forEach(e)})}else s.children=a,e(o(s))}else ut(r);else typeof r=="number"&&ut(r)}t.renderChild=e;function i({children:r}){e(r)}t.Fragment=i})(xt||(xt={}));function tn(t,{getPoint:n,shouldMeasure:e,direction:i,getSpeed:r,config:o}){let s;const a=b(i);W(e,function(c){if(c){const l=yt(window,"pointermove",function(f){s?s.changePoint(f):s=Ct(t,{point:f,config:o,getPoint:n,direction:a,getSpeed:r})});return function(){l(),s?.destroy(),s=void 0}}})}function Le(t,{getPoint:n,movePoint:e,direction:i,getSpeed:r,config:o}){let s;const a=b(i);X(()=>{s?.destroy(),s=void 0}),W(e,function(c){c?s?s.changePoint(c):s=Ct(t,{point:c,config:o,getPoint:n,direction:a,getSpeed:r}):(s?.destroy(),s=void 0)})}function be(t,n,e,i=Mt){const r=b(e);let o=-1;W(n,function(s){I(()=>{const a=r(),c=a=="x"?"offsetLeft":"offsetTop";if(o>=0){const l=o-t[c];if(!l)return;i(t,a,l)}o=t[c]})})}function mt(t,n){let e=0,i=t.length-1;for(;e<=i;){const r=Math.floor((e+i)/2),o=Math.sign(n(t[r]));if(o===0)return r;o<0?e=r+1:i=r-1}return e}const Nt=Symbol("accept");function Ie(t,n){return j(e=>{const i=t();if(!i)return;let r=n(i);for(;r;){const o=r[Nt];if(o)return e&&e.container==r&&e.data==i?e:{data:i,accept:o(i),container:r};r=r.parentElement}})}var q=class{constructor(t){this.dragData=t}};function Ne({setDragData:t,getDragData:n,getMeasurePositionDiff:e,getDragX:i,getDragY:r,setDragTo:o,getActiveContainer:s,setActiveContainer:a,getDropped:c,getPreviewRef:l,getDragId:f,pluginFinishElement:h,onDragFinish:m,changeIndexAnimate:y}){const C=Ie(n,s),d=k(void 0);function u(E,D,P){if(n()){console.log("正在拖拽中。。。");return}d.set(E);const T=D();t(T),a(T,P),document.body.style.userSelect="none",et({onMove(N){d.set(N),o(T,N);const O=e(T,"x"),w=e(T,"y");let F=O||w?document.elementFromPoint(i(T)+O,r(T)+w):N.target;const R=l(T);R&&R.contains(F)&&(F=R.parentElement),a(T,F)},onEnd(N){document.body.style.userSelect="",m(T,C()),d.set(void 0)}})}function S({getList:E,getId:D,accept:P,preview:T=Mt,createDragData:N,direction:O="y",changeIndexAnimate:w=y}){const F=b(O),R=new Map,ot=k(0),st=k(0);function Rt(){const p=n();if(!p||C()?.container!=G.container||c(p))return;const x=G.container.getBoundingClientRect();if(F()=="y"){const M=r(p)+e(p,"y"),v=ot.get();return M<x.top||M>x.bottom?void 0:{dragData:p,index:mt(E(),function(L){const A=R.get(D(L));if(!A)throw"";return A.offsetTop+x.top-v+A.clientHeight/2-M})}}else{const M=i(p)+e(p,"x"),v=st.get();return M<x.left||M>x.right?void 0:{dragData:p,index:mt(E(),function(L){const A=R.get(D(L));if(!A)throw"";return A.offsetLeft+x.left-v+A.clientWidth/2-M})}}}const at=j(()=>{const p=Rt();if(!p)return E();const x=Yt(E());return x.splice(p.index,0,new q(p.dragData)),x}),G={plugin(p){G.container=p,p[Nt]=P,p.addEventListener("scroll",x=>{ot.set(p.scrollTop),st.set(p.scrollLeft)}),Le(p,{getPoint(x,M){const v=n(),L=v?e(v,M):0;return M=="x"?x.pageX+L:x.pageY+L},movePoint(){if(at().length!=E().length)return d.get()},direction:F})},renderChildren(p){Kt(at,x=>x instanceof q?x:D(x),function(x,M,v){v instanceof q?T(M,v.dragData):p({container:G.container,key:v,getData:x,getIndex:M,plugin(L){be(L,M,F,w),R.set(v,L),X(()=>{R.delete(v)});const A=n();A&&c(A)&&f(A)==v&&I(()=>{h(A,L,v)})},onPointerDown(L,A){u(L,()=>N(L,v,A),G.container)}})})}};return G}return{onPointerDown:u,getAccept:C,createListContainer:S}}function en(t,n=t.currentTarget){const e=n.getBoundingClientRect();return{x:t.pageX-e.x,y:t.pageY-e.y,width:e.width,height:e.height}}function Re(){return 0}function nn(t){const n=t.measureAt||"center";return Ne({...t,getPreviewRef(e){return e.targetPlaceholder?.element},getActiveContainer(e){return e.activeContainer.get()},getMeasurePositionDiff:n=="center"?function(e,i){return i=="x"?e.width/2-e.x:e.height/2-e.y}:Re,getDragX(e){return e.dragX.get()},setDragTo(e,i){e.dragX.set(i.pageX),e.dragY.set(i.pageY)},getDragY(e){return e.dragY.get()},getDropped(e){return e.onDropEnd.get()},setActiveContainer(e,i){e.activeContainer.set(i)},getDragId(e){return e.id},pluginFinishElement(e,i,r){I(()=>{const o=i.getBoundingClientRect();Promise.all([e.dragX.animateTo(o.x+e.x,t.previewAnimateConfig),e.dragY.animateTo(o.y+e.y,t.previewAnimateConfig)]).then(()=>{t.setDragData(void 0)})})}})}function rn(t,n){const[e,i]=zt(t,n);return X(i),e}function Oe(t,n,{storage:e=localStorage,json:i=n&&typeof n!="string"}=V){const r=k(e.getItem(t));return X(yt(window,"storage",o=>{o.storageArea==e&&o.key==t&&r.set(o.newValue)})),{get:i?j(()=>{const o=r.get();if(o==null)return n;try{return JSON.parse(o)}catch{return console.warn("not a valid storage for "+t),n}}):()=>r.get()??n,set:i?o=>{const s=JSON.stringify(o);return e.setItem(t,s),r.set(s),o}:o=>(e.setItem(t,o),r.set(o),o)}}function on(t,n,e){return Wt(()=>Oe(t,n,e))}export{We as A,je as O,ze as a,xe as b,ke as c,pe as d,Ve as e,He as f,Qe as g,Be as h,rn as i,$e as j,xt as k,tn as l,ye as m,en as n,on as o,_e as p,Ze as q,Ge as r,nn as s,qe as t,Je as u,Oe as v,Ue as w,Ke as x,Xe as y,Ye as z};
