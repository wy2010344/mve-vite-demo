import{ag as fe,L,g as a,N as de,J as D,x as V,l as H,R as ue,o as Y,q as N,P as me,M as _,Y as b,T as E,A as he,W as ge,H as W,B as T,D as k,G as Z,b as M,I as F,ah as ye,e as xe,d as pe,ai as w,O as I,Q as O,F as j,V as ee,X as te,E as be,_ as ve,C as q,$ as Ne,a0 as we,K as $,U as De,aj as X,ak as R,al as ke,am as Te,c as z,z as G,a1 as Ce,an as S,a7 as B}from"./index-C09L67qZ.js";import{a as Se}from"./onlyMobile-Dkk4_pv8.js";import{f as Me,a as Ye}from"./themeDropdown-BHGctfIZ.js";import{S as ne,a as P,W as re,h as _e,b as We,d as Pe,f as je}from"./demoList-B3w_mpvn.js";import{G as He}from"./iconBase-CiSp5Y-1.js";import{a as K}from"./index-cHHGad51.js";import{f as Ee}from"./chunk-LSEVNFON-G8OzWBoO.js";const C=fe(void 0);function se(e){a.div({className:"flex bg-base-100 z-10 relative",children(){for(let m=0;m<7;m++)a.div({className:"flex-1 aspect-square flex items-center justify-center text-base-content",childrenType:"text",children(){return e(m)}})}})}function ae(e,m){e==0&&a.div({className:"absolute left-0 text-label-small",childrenType:"text",children(){return de(D(m),P.get())}})}function oe({day:e,lunarDay:m,hide:d,selected:c,onClick:n}){a.div({className(){return H(`flex-1 aspect-square cursor-pointer
                        flex flex-col items-center justify-center gap-1 `,d()&&"opacity-30")},onClick:n,children(){a.div({className:"flex items-center justify-center relative aspect-square p-1",children(){V(c,()=>{a.div({id:ie,className(){return H("absolute inset-0 ring-1 rounded-full ring-accent")}})}),a.span({className:"relative text-base-content/80  text-label-large",childrenType:"text",children:e})}}),a.div({className:"text-label-small  text-base-content/60",childrenType:"text",children:m.getName()})}})}function Fe(e,m,d){L.div({attrs(c){const n=m();n==1||(c.s_position="absolute",c.s_inset=0,c.s_transform=`translateX(${(n-1)*100}%)`)},children(){se(function(c){return re[e.weekDay(c)]}),a.div({className:"flex items-center justify-center relative",children(){for(let c=0;c<7;c++){const n=e.cells[c];ae(c,n);const i=ne.fromYmd(n.year,n.month,n.day).getLunarDay();oe({hide(){return!1},day:n.day,lunarDay:i,selected(){return ue(n,d.get())},onClick(){d.set(n)}})}}})}})}const ie="select-cell";function Oe(e,m,d,c,n){function t(){return n()/7}const{showCalendar:i}=C.consume();function u(){const r=c.get(),o=e;return r.year==o.year&&r.month==o.month}L.div({attrs(r){const o=m();o==1||(r.s_position="absolute",r.s_inset=0,r.s_transform=`translateX(${(o-1)*100}%)`)},children(){se(function(s){return re[e.weekDay(s)]});const r=Y(()=>{const s=t(),l=s*5,h=me(D(c.get()),P.get())-1;return _({0:0,[l]:s*h},E)}),o=Y(()=>{const s=t()*5;return _({0:t()*6,[s]:t()},E)});a.div({className:"overflow-hidden bg-base-200 relative",s_height(){const s=d.get();return o(s)+"px"},children(){V(i,function(){a.div({s_height(){return t()*7+"px"},s_transform(){const s=Math.max(d.get(),0);return`translateY(${-r(s)}px)`},children(){for(let s=0;s<6;s++)a.div({className:"flex items-center justify-center relative",children(){for(let l=0;l<7;l++){const h=e.fullDayOf(l,s);let g=e;h.type=="last"?g=e.lastMonth():h.type=="next"&&(g=e.nextMonth()),ae(l,{year:g.year,month:g.month,day:h.day});const f=ne.fromYmd(g.year,g.month,h.day).getLunarDay(),x=N(()=>h.type=="this"&&u()&&c.get().day==h.day);oe({day:h.day,onClick(){c.set(b.from(g.year,g.month,h.day))},lunarDay:f,selected:x,hide(){return i()?h.type!="this":!1}})}}})}})})}})}})}function $e(e,m){return He({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{fill:"none",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"m112 160-64 64 64 64"},child:[]},{tag:"path",attr:{fill:"none",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"M64 224h294c58.76 0 106 49.33 106 108v20"},child:[]}]},e,m)}j.get();function Le(e,m){const{calendarScrollY:d,calendarClose:c,showCalendar:n,calendarScroll:t,calendarFinish:i,today:u}=C.consume();_e(e.get,ie);const r=N(s=>{const l=e.get();return new he(l.year,l.month,P.get())}),o=N(()=>{const s=e.get();return ge.from(s.year,s.month,s.day,P.get())});a.div({className:"relative",onPointerDown:W(function(s,l){if(l=="y")return ee.from(s,{getPage:te,scrollDelta(h,g){t(h,g)},onFinish(h){i(h)}})}),children(){const s=T(0);k(N(y=>{const f=r();if(y&&n()){const x=Math.sign(f.toNumber()-y.toNumber());x&&l.changePage(x)}return f})),k(N(y=>{const f=o();if(y&&!n()){const x=Math.sign(f.cells[0].toNumber()-y.cells[0].toNumber());x&&l.changePage(x)}return f}));const l=Z(s,h);function h(){return g.clientWidth}const g=a.div({className:"overflow-hidden  bg-base-300 touch-none",onPointerDown:W(function(y,f){if(f=="x")return l.pointerDown(y,{callback(x,v){if(n()){const p=x<0?r().lastMonth():r().nextMonth();e.get().day>p.days?e.set(b.from(p.year,p.month,p.days)):e.set(b.from(p.year,p.month,e.get().day))}else{const p=D(e.get());p.setTime(p.getTime()+x*We),x&&e.set(b.fromDate(p))}}})}),children(){a.div({className:"relative",s_transform(){return`translateX(${-s.get()}px)`},children(){V(n,function(){M(F(()=>{const y=r();return[y.lastMonth(),y,y.nextMonth()]},O),function(y,f){Oe(y,f,d,e,m)})},function(){M(F(()=>{const y=o();return[y.beforeWeek(),y,y.nextWeek()]},O),function(y,f){Fe(y,f,e)})})}})}});a.div({className:"w-full h-11 flex justify-between items-center [padding-inline:18px] bg-base-100 z-10",children(){a.div({className:"flex items-center gap-1",children(){const y=ye(()=>{const f=u().toNumber(),x=e.get().toNumber();return f!=x?[1]:xe});M(y,function(f){const x=a.button({className:"daisy-btn daisy-btn-xs daisy-btn-circle",onClick(){e.set(u())},children(){$e()}});k((v=pe)=>{const p=f.step(),le=u().toNumber(),ce=e.get().toNumber(),A=Math.sign(ce-le);return p==v.step&&A==v.dir?v:{step:p,dir:A}},function({step:v,dir:p}){v=="enter"?K(x,{rotateY:p>0?[90,0]:[90,180]}).then(f.resolve):v=="exiting"&&K(x,{rotateY:p>0?[0,90]:[180,90]}).then(f.resolve)})}),a.h1({className(){const f=u(),x=e.get();return H("text-2xl text-base-content font-bold",f.equals(x)?"text-2xl":f.year==x.year?"text-xl":"text-lg",d.onAnimation()?I`cursor-not-allowed`:I`cursor-pointer`)},childrenType:"text",children(){const f=e.get();return u().year!=f.year?`${f.year}-${w(f.month,2)}-${w(f.day,2)}`:`${w(f.month,2)}-${w(f.day,2)}`},onClick(){d.onAnimation()||(n()?c():d.changeTo(0))}})}}),a.div({className:"text-base-content",children(){a.span({className:"mr-[0.125em] text-2xl",childrenType:"text",children:"¥"}),a.span({className:"text-2xl",childrenType:"text",children:"23"}),a.sup({className:"opacity-50 text-[0.75em] -top-[0.75em]",childrenType:"text",children:".00"})}})}})}})}const U=-50;j.get();function Ve(e,m){const{showCalendar:d,calendarFinish:c,calendarScroll:n}=C.consume(),t=T(0);k(m,function(r){!r&&e()!=1&&be(()=>{t.set(0)})});let i;const u=L.div({attrs(r){const o=e();r.className="absolute inset-0 select-none bg-base-100 overflow-hidden",o!=1&&(r.s_position="absolute",r.s_inset=0,r.s_transform=`translateX(${(o-1)*100}%)`)},onTouchMove(r){r.preventDefault()},onPointerDown:W(function(r,o){if(o=="y")return ee.from(r,{getPage:te,scrollDelta(s,l){if(d())n(s,l);else{const h=t.get();t.set(h+we(h,s,u.clientHeight,i.offsetHeight))}},onFinish(s){d()?c(s):(t.get()<=U&&console.log("新建"),ve({frictional:q.get().getFromVelocity(s),scroll:t,containerSize:u.clientHeight,contentSize:i.offsetHeight,edgeBackConfig:Ne,edgeConfig(l){return q.get(100).getFromVelocity(l).animationConfig()}}))}})}),children(){const r=Y(()=>_({0:0,[U]:J.length-1},E));a.div({childrenType:"text",className:"absolute w-full flex justify-center",s_transform(){return`translateY(calc(${-t.get()}px - 100%))`},children(){const o=Math.round(r(t.get()));return J[o]}}),i=a.div({s_transform(){return`translateY(${-t.get()}px)`},className:"flex flex-col",s_minHeight:"100%",children(){Pe(Ee.number.int({min:1,max:58}))}})}})}const J=["新...","新增...","新增一...","新增一条...","新增一条记...","新增一条记录"];j.get();function Ae(e){function m(){return n.clientWidth}const d=T(0),c=Z(d,m);k(N(t=>{const i=e.get();if(t){const u=D(t).valueOf(),o=D(i).valueOf()-u;let s=0;o>=$?s=1:o<=-864e5&&(s=-1),s&&c.changePage(s)}return i}));const n=a.div({className:"flex-1 overflow-hidden",onPointerDown:W(function(t,i){if(i=="x")return c.pointerDown(t,{getPage:De,callback(u,r){const o=D(e.get());o.setTime(o.getTime()+u*$),u&&e.set(b.fromDate(o))}})}),children(){a.div({className:"h-full",s_transform(){return`translateX(${-d.get()}px)`},children(){M(F(()=>{const t=e.get();return[t.beforeDay(),t,t.nextDay()]},O),function(t,i){Ve(i,()=>d.onAnimation())})}})}})}function Ie(e){const{yearMonthScrollY:m,scrollYearMonthOpenHeight:d}=C.consume(),c=Y(()=>_({0:d(),[d()]:0},function(n,t,i,u){return t?ke(n,i,u,Te):u[1]}));a.div({s_height(){return c(m.get())+"px"},children(){a.div({s_height(){return d()+"px"},s_transform(){return`translateY(${-m.get()}px)`},className:"relative w-full",children(){a.div({className:"absolute inset-0 flex items-stretch justify-center",children(){a.div({className:"flex-1 relative flex flex-col justify-center overflow-hidden",...X({height:d,cellHeight:44,value:{get(){return e.get().year},set(n){const t=e.get();if(t.year!=n){const i=Math.min(R(n,t.month),t.day);e.set(b.from(n,t.month,i))}}},renderCell(n){a.div({className:"h-11 text-center flex items-center justify-center",childrenType:"text",children:w(n,2)})}})}),a.div({className:"flex-1 relative flex flex-col justify-center overflow-hidden",...X({height:d,cellHeight:44,value:{get(){return e.get().month},set(n){const t=e.get();if(n!=t.month){const i=Math.min(R(t.year,n),t.day);e.set(b.from(t.year,n,i))}}},circle:{baseIndex:1,count:12},renderCell(n){a.div({className:"h-11 text-center flex items-center justify-center",childrenType:"text",children:w(n,2)})}})})}}),a.div({className:"absolute inset-0 flex flex-col items-stretch justify-center pointer-events-none ",children(){a.div({className:"flex-1 bg-linear-to-b from-base-100 to-100% to-base-100/90"}),a.div({className:"h-11 flex flex-col justify-center"}),a.div({className:"flex-1 bg-linear-to-t from-base-100 to-100% to-base-100/90"})}})}})}})}const Q=j.get();function qe(){Se(function({width:e},m){m&&Me(function(){je(),Ye()});const d=b.fromDate(new Date),c=z(d,G),n=setInterval(()=>{c.set(b.fromDate(new Date))},$/2);Ce(()=>{clearInterval(n)});const t=z(d,G);function i(){return 5*e()/7}function u(){return 44*3}const r=T(i()),o=T(u());function s(){return o.get()!=u()}C.provide({yearMonthScrollY:o,scrollYearMonthOpenHeight:u,calendarScrollY:r,calendarOpenHeight:i,today:c.get,showCalendar(){return r.get()!=i()},async calendarClose(){s()&&o.changeTo(u()),r.changeTo(i())},calendarScroll(l,h){if(s()){const g=o.get()+l;g>=u()?(o.set(u()),B()):g<=0?o.set(o.get()+l/3):o.set(g)}else{const g=r.get()+l;g>=i()?(r.set(i()),B()):g<=0?(r.set(0),o.changeDiff(g)):r.set(g)}},calendarFinish(l){s()?Q.getFromVelocity(l).distance+o.get()>u()/2?o.changeTo(u(),S(l)):o.changeTo(0,S(l)):Q.getFromVelocity(l).distance+r.get()>i()/2?r.changeTo(i(),S(l)):r.changeTo(0,S(l))}}),a.div({className:"absolute inset-0 flex flex-col select-none touch-none",children(){Ie(t),Le(t,e),Ae(t)}})})}function Je(){qe()}export{Je as default};
