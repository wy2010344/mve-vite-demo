import{h as z,f as ee,c as F,g as Y,d as te,B as se,j as q,an as T,a as A,ar as ne,y as oe,as as re,m as ae,e as W,D as ie,I as ce,at as de,au as fe,i as O,ao as I,v as ge,av as U,aw as le}from"./index-DSI5ljsY.js";import ue from"./graph-BB3NgaJ2.js";import{c as me,o as he}from"./transform-W4V8p7Sk.js";import{f as pe,a as ye,b as P,i as be,m as xe,t as ve,c as we,e as ke,d as Se}from"./forceLayout-DO7GEUys.js";import{a as H}from"./index-cHHGad51.js";import{g as Le,r as Te,T as ze,h as Ce}from"./hookThreeView-B3xgvkNo.js";import{C as De,A as Me,D as Z,S as Fe,R as Ae,V as Be,M as Ne,a as Ee,L as _e,b as J,B as Re,c as Xe,d as Ye,e as Oe}from"./three.core-IZwRyLr5.js";import"./three.module-EYrWAVy6.js";const Pe=me("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf");function $e(b,f){z(b,function(w){const m=document.getElementsByClassName(f)[0];ee(()=>{const d=document.getElementsByClassName(f)[0];if(m&&d&&m!=d){const y=m.offsetLeft,C=d.offsetLeft,S=y-C;H(d,{x:[S,0]});const i=d.firstChild;i&&H(i,{x:[-S,0]})}})})}const B=800,N=800,Ge=.001,Ve=["2D","3D"];function Qe(){const b=F("3D");Y.div({role:"tablist",className:"daisy-tabs daisy-tabs-box",children(){Ve.forEach(i=>{Y.button({className(){return se("daisy-tab",i==b.get()&&"daisy-tab-active fd1-tab-active")},role:"tab",onClick(){b.set(i)},children(){te.span().renderTextContent(i)}})}),$e(b.get,"fd1-tab-active")}});const f=F(ue),w=he(Pe),m=pe(),d=ye(),y=P("x"),C=P("y");function S(i,h){const p=re(be()),k=()=>p.alpha<Ge,x=ae(n=>xe({nodes:(n==null?void 0:n.nodes)||W,links:(n==null?void 0:n.links)||W,fromLinks:f.get().links,fromNodes:f.get().nodes,createForceNode(e,c,u){return we(e,i,c,Se,ke)},getNodeKey(e){return e.id},getSorceKey(e){return e.source},getTargetKey(e){return e.target},createFromKey(e){return{id:e,group:"not-found"}}}));function s(){const n=x();ve(i,p,n.nodes,e=>{m(n.links,i,e),d(n.nodes,i,e),h(n,e)})}let g=ie;return z(k,n=>{if(n){g();return}g=ce(()=>{s(),de()})}),{config:p,getNodesAndLinks:x,didTick:s}}q(b.get,function(i){if(i=="2D"){const{getNodesAndLinks:h,didTick:p,config:k}=S(2,(s,g)=>{y(s.nodes,g),C(s.nodes,g)}),x=T.svg({width:B,height:N,viewBox:`${-800/2} ${-800/2} ${B} ${N}`,s_maxWidth:"100%",s_height:"auto",children(){A(()=>h().links,s=>T.g({stroke:"#999",strokeOpacity:.6,children(){T.line({x1:s.source.x.dSignal.get,y1:s.source.y.dSignal.get,x2:s.target.x.dSignal.get,y2:s.target.y.dSignal.get,strokeWidth:Math.sqrt(s.value.value)})}})),A(()=>h().nodes,s=>T.g({stroke:"#fff",strokeWidth:1.5,children(){T.circle({r:5,cx:s.x.dSignal.get,cy:s.y.dSignal.get,fill:w(s.value.group),...ne(g=>{const n=x.getBoundingClientRect(),e=n.left+n.width/2,c=n.top+n.height/2;s.x.f=g.pageX-e,s.y.f=g.pageY-c,k.alphaTarget=.3,p();const u=fe(l=>{l?(s.x.f=l.pageX-e,s.y.f=l.pageY-c):(s.x.f=void 0,s.y.f=void 0,k.alphaTarget=0,u())})})})}}))}})}else if(i=="3D"){const h=F(void 0),p=F(void 0);q(h.get,function(e){if(!e)return;const c=e.userData;Y.div({className:"text-white px-3 py-4 rounded-[8px]",s_position:"fixed",s_border:" 1px solid rgba(255,255,255,0.1)",s_background:"linear-gradient(135deg, #2c3e50, #4ca1af)",s_left(){var u;return(((u=p.get())==null?void 0:u.clientX)||0)+15+"px"},s_top(){var u;return(((u=p.get())==null?void 0:u.clientY)||0)+15+"px"},children(){oe`${c.value.group}--${c.value.citing_patents_count||""}`}})});const k=P("z"),{getNodesAndLinks:x,didTick:s,config:g}=S(3,(e,c)=>{y(e.nodes,c),C(e.nodes,c),k(e.nodes,c)}),n=Le(B,N);n.position.z=500,Te({camera:n,width:B,height:N,render(e){const{renderer:c}=ze.consume();e.background=new De(16119802);const u=new Me(16777215,.4);e.add(u);const l=new Z(16777215,.8);l.position.set(5,10,7),l.castShadow=!0,l.shadow.mapSize.width=1024,l.shadow.mapSize.height=1024,l.shadow.camera.near=.5,l.shadow.camera.far=50,e.add(l);const $=new Z(16777215,.3);$.position.set(-5,5,5),e.add($);const G=Ce(),Q=new Fe(5,32,32);function E(o,a){o.x=a.x.d,o.y=a.y.d,o.z=a.z.d}const L=new Ae,D=new Be,_=[],M=c.domElement;function V(o,a,t){const r=a.clientX-t.left,v=a.clientY-t.top;o.x=r/t.width*2-1,o.y=-(v/t.height*2-1)}function K(o,a){V(D,o,a),L.setFromCamera(D,n);const t=L.intersectObjects(_);if(t.length>0)return t[0].object}O(I(M,"pointermove",o=>{const a=M.getBoundingClientRect(),t=K(o,a);t?(h.set(t),p.set(o)):h.set(void 0)})),O(I(M,"pointerdown",o=>{const a=M.getBoundingClientRect(),t=K(o,a);if(t){G.enabled=!1;const r=t.userData;r.z.f=r.z.d,g.alphaTarget=.3,s(),ge({onMove(v){V(D,v,a),L.setFromCamera(D,n);const R=L.ray.direction,X=L.ray.origin,j=(r.z.f-X.z)/R.z;r.x.f=X.x+R.x*j,r.y.f=X.y+R.y*j},onEnd(v){r.x.f=void 0,r.y.f=void 0,g.alphaTarget=0,G.enabled=!0}})}})),A(()=>x().nodes,o=>{const a=w(o.value.group),t=new Ne({color:a,specular:1118481,shininess:50,bumpMap:Ke(),bumpScale:.5,emissive:0,flatShading:!1}),r=new Ee(Q,t);U(r),r.userData=o,_.push(r),O(()=>{le(_,r)}),z(()=>{h.get()==r?t.emissive.setHex(3355443):t.emissive.set(a)}),z(()=>{E(r.position,o)})}),A(()=>x().links,o=>{const a=new _e({color:0,transparent:!0,opacity:.3}),t=[];t.push(new J),t.push(new J);const r=new Re().setFromPoints(t),v=new Xe(r,a);U(v),z(()=>{E(t[0],o.source),E(t[1],o.target),v.geometry=r.setFromPoints(t)})})}})}})}function Ke(){const f=new Uint8Array(16384);for(let m=0;m<64*64;m++){const d=m*4,y=Math.random()*255;f[d]=y,f[d+1]=y,f[d+2]=y,f[d+3]=255}const w=new Ye(f,64,64,Oe);return w.needsUpdate=!0,w}export{Qe as default};
