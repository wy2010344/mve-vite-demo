import{r as D,h as y}from"./canvasRender-CItRrCUu.js";import{V as N,c as u,b,N as m,O as F,X as d,L as T,P as h,Q as L,u as l,p as w}from"./index-B2-PbFlA.js";import{m as A,i as P,e as M,d as K,c as C,f as E,a as X,t as q}from"./forceLayout-B4nwBeeE.js";import{a as z}from"./onlyMobile-WNpDr5OR.js";function R(){z(function({width:a,height:i}){const f=N(()=>{const e=Array.from({length:400},(r,n)=>({index:n})),s=[];for(let r=0;r<20;++r)for(let n=0;n<20;++n)r>0&&s.push({source:(r-1)*20+n,target:r*20+n}),n>0&&s.push({source:r*20+(n-1),target:r*20+n});return{nodes:e,links:s}}),x=u(f.nodes),p=u(f.links),g=u(void 0),c=b(t=>A({nodes:(t==null?void 0:t.nodes)||m,links:(t==null?void 0:t.links)||m,fromLinks:p.get(),fromNodes:x.get(),createForceNode(e,s,r){return P(e,2,s,K,M)},getNodeKey(e){return e.index},getSorceKey(e){return e.source},getTargetKey(e){return e.target},createFromKey(e){return{index:e}}})),o=F(C()),k=E({getStrength:d(1),getDistance:d(20),iterations:10}),S=X({getStrenth:d(-30)});function v(){const t=c();q(o,t.nodes,e=>{k(t.links,o.nDim,e),S(t.nodes,o.nDim,e)})}T(h(()=>{v(),L()})),D({className:"touch-none",width:a,height:i},function({canvas:t}){l(()=>c().links,e=>{y({x(){return e.source.x.dSignal.get()+a()/2},y(){return e.source.y.dSignal.get()+i()/2},withPath:!0,draw(s,r){return r.moveTo(0,0),r.lineTo(e.target.x.d-e.source.x.d,e.target.y.d-e.source.y.d),{operates:[{type:"stroke",style:"#aaa",width:1}]}}})}),l(()=>c().nodes,e=>{y({x(){return e.x.dSignal.get()+a()/2},y(){return e.y.dSignal.get()+i()/2},onPointerDown(s){o.alphaTarget=.3,g.set(e),w({onMove(r){e.x.f=r.offsetX-a()/2,e.y.f=r.offsetY-i()/2},onEnd(r){o.alphaTarget=0,e.x.f=void 0,e.y.f=void 0,g.set(void 0)}},t)},withPath:!0,draw(s,r){return r.arc(0,0,6,0,2*Math.PI),{operates:[{type:"fill",style:"#000"},{type:"draw",callback(n){n.fillText(e.value.index+"",3,-3)}}]}}})})},{beforeDraw(t){}})})}export{R as default};
