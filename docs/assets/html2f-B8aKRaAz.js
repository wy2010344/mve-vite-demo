import{aw as rt,g as m,au as f,v as ot,c as st,ax as ct}from"./index-C09L67qZ.js";function it(e,t){const n=rt(t);return setTimeout(n,e),n}function I(e){return it(3e3,function(){m.div({className:"daisy-toast daisy-toast-top daisy-toast-center",children(){m.div({className:"daisy-alert daisy-alert-error",children(){m.span({childrenType:"text",children:e})}})}})})}var ut=Object.defineProperty,at=(e,t,n)=>t in e?ut(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,lt=(e,t,n)=>(at(e,t+"",n),n);class ht{constructor(t){lt(this,"allowLog"),this.i=t}step1(t){if(this.notEnd()&&t(this.current()))return this.copyTo(this.i+1)}}class L extends ht{constructor(t,n=0){super(n),this.content=t}current(){const t=this.content.charAt(this.i);if(t.length)return t}notEnd(){return this.content.length>this.i}currentCode(){return this.content.charCodeAt(this.i)}copyTo(t){return new L(this.content,t)}matchToEnd(t){if(this.notEnd()){for(const n of t)if(this.content.startsWith(n,this.i))return}return this}step1Code(t){return this.step1(n=>t(n.charCodeAt(0)))}}function d(...e){if(e.length==0)throw new Error("没有任何参数");for(let t=0;t<e.length;t++){const n=e[t];for(let r=0;r<t;r++){const o=e[r];n.startsWith(o)&&console.warn("后文包含前文,绝不会被匹配到",n,o)}}return function(t){for(const n of e)if(t.content.indexOf(n,t.i)==t.i)return t.copyTo(t.i+n.length)}}function ft(e){const t=[];for(let n=0;n<e.length;n++)t.push(e.charCodeAt(n));return t}function X(...e){const t=new Set(e);if(t.size==0)throw new Error("没有任何参数");t.size!=e.length&&console.warn("参数中有重复",e);function n(r){return t.has(r)}return r=>r.step1Code(n)}function R(...e){const t=new Set(e);t.size!=e.length&&console.warn("参数中有重复",e);function n(r){return!t.has(r)}return r=>r.step1Code(n)}function Q(...e){return function(t){return t.matchToEnd(e)}}function dt(e){return e.notEnd()?void 0:e}function $(...e){return function(t){for(const n of e){const r=n(t);if(r)return r}}}function pt(...e){return $(...e,f)}class C{constructor(t,n){if(this.a=t,this.b=n,t>=n)throw new Error(`结束${n}应该比开始${t}大`)}static of(t,n){return new C(t,n)}matchCharBetween(...t){const n=this.a,r=this.b,o=new Set(t);return o.size!=t.length&&console.warn("不包含里有重复项"),o.forEach(s=>{if(s<n||s>r)throw new Error(`排除项中${s}不在${n}与${r}之间`)}),s=>s.step1Code(c=>!(c<n||c>r||o.has(c)))}matchCharNotBetween(...t){const n=this.a,r=this.b,o=new Set(t);return o.size!=t.length&&console.warn("不包含里有重复项"),o.forEach(s=>{if(s>=n&&s<=r)throw new Error(`包含项中${s}不在${n}与${r}之间`)}),s=>s.step1Code(c=>(c<n||c>r)&&!o.has(c))}}function B(...e){return function(t){let n=t;for(const r of e){const o=r(n);if(o)n=o;else return}return n}}function v(e,t=0,n=f,r=f){function o(s,c){if(!(s<t))return c}return function(s){let c=s,i=0;for(;;){if(i){const h=n(c);if(h)c=h;else return o(i,c)}else{const h=r(c);if(h)c=h;else return o(i,c)}const u=e(c);if(u)i++,c=u;else return o(i,c)}}}class mt extends Error{constructor(t){super(t),this.message=t}}function T(e){return new mt(e)}const k=function(e,t){return e.content.slice(e.i,t.i)},H=ft(` \r
	`),wt=X(...H),P=v(wt);class J{constructor(t,n){this.value=t,this.end=n}}function y(e,t){return new J(e,t)}function w(e){return e instanceof J}function a(e,t,n=""){return function(r){const o=e(r);if(o)try{return y(t(r,o),o)}catch(s){return T(s)}return r.allowLog&&console.log("ruleGet失败",n),T(n)}}function z(e,t=""){return a(e,ot,t)}function g(e,t,n){return function(r){const o=[];for(const s of e){const c=s(r);if(w(c))r=c.end,o.push(c.value);else return r.allowLog&&console.log("解析失败",n),c}try{const s=t.apply(null,o);return y(s,r)}catch(s){return T(s)}}}function N(e,t){return function(n){let r=null;for(const o of e){const s=o(n);if(w(s))return s;r=s}return n.allowLog&&console.log("orRuleGet失败",t),r}}function gt(){const e=arguments[0];return a(f,function(t){return e==null?void 0:e(t)})}function _(e,t=0,n=f,r=f){function o(s,c){return s.length<t?T(`need at min ${t} but get ${s.length}`):y(s,c)}return function(s){const c=[];let i=s,u=0;for(;;){if(u){const l=n(i);if(l)i=l;else return o(c,i)}else{const l=r(i);if(l)i=l;else return o(c,i)}const h=e(i);if(w(h))u++,i=h.end,c.push(h.value);else return o(c,i)}}}function yt(e,t,n){return function(r){let o=r;const s=e(o);if(w(s)){o=s.end;let c=s.value;for(;;){const i=t(o);if(w(i)){const u=n(c,i.value);if(u)o=i.end,c=u;else return y(c,o)}else return y(c,o)}}return s}}function Y(e,t){return function(n){const r=e(n);if(w(r))try{const o=t(r.value);return y(o,r.end)}catch(o){return T(o)}return r}}const Ct=R();function G(e,t=e){const n=String.fromCharCode(t),r=Q(n);return g([a(X(e),f),_(N([a(d("\\\\"),function(o){return"\\"}),a(d(`\\${n}`),function(o){return n}),a(Ct,function(o){return o.content[o.i]})]),0,r,r),a($(dt,X(t)),f)],function(o,s,c){return s.join("")})}function p(e){return e.charCodeAt(0)}const F=C.of(p("a"),p("z")),M=C.of(p("A"),p("Z"));C.of(p("一"),p("龥"));const E=C.of(p("0"),p("9")),Et=$(B(E.matchCharBetween(p("0")),v(E.matchCharBetween())),E.matchCharBetween());B(Et,pt(B(d("."),v(E.matchCharBetween(),1))));const $t=B($(M.matchCharBetween(),F.matchCharBetween()),v($(M.matchCharBetween(),F.matchCharBetween(),E.matchCharBetween())));class W{constructor(t,n,r){this.key=t,this.map=n,this.close=r}}class j{constructor(t){this.key=t}}const O=Q("<"),K=Y(_(N([a(d("\\\\"),e=>"\\"),a(d("\\<"),e=>"<"),a(R(),e=>e.current())]),0,O,O),function(e){return e.join("")});function q(e,t,n){const r=g([t,N([g([a(d("="),f),n],function(i,u){return u}),gt(()=>!0)])],function(i,u){return{key:i,value:u}}),o=g([a(d("<"),f),e,a(P,f),_(r,0,P),a(P,f),a(d(">","/>"),k)],function(i,u,h,l,x,nt){const S={};for(let A of l){if(A.key in S)throw`duplicate key ${A.key}`;S[A.key]=A.value}return new W(u,S,nt=="/>")}),s=g([z(d("</")),e,z(d(">"))],function(i,u,h){return new j(u)});return yt(Y(K,i=>{const u=new b("",{},[]);return i&&u.children.push(i),[u]}),g([N([o,s]),K],function(i,u){return{brack:i,content:u}}),function(i,{brack:u,content:h}){let l=i.at(-1);if(l){if(u instanceof W)if(u.close)l.children.push(new b(u.key,u.map,[]));else{const x=new b(u.key,u.map,[]);l.children.push(x),i.push(x),l=x}else if(u instanceof j){if(l.type!=u.key)throw"not match the before quote";i.pop(),l=i.at(-1)}else throw"unknown node"+u;if(!l)throw"unexpected end!";return h&&l.children.push(h),i}})}class b{constructor(t,n,r){this.type=t,this.attrs=n,this.children=r}}const U=a($t,k),Tt=q(U,U,G(34));function Nt(e,t=Tt){const n=t(new L(e));if(w(n))if(n.end.i==n.end.content.length){const r=n.value;if(r.length==1)return r[0].children;throw new Error("not completely closed")}else throw new Error("Unable to fully parse");throw new Error(n.message)}const vt=H.concat("=/>".split("").map(e=>e.charCodeAt(0))),V=a(v(R(...vt),1),k),xt=N([G(34),G(123,125)]),At=q(V,V,xt);function bt(){const e=st("");m.button({className:"daisy-btn daisy-btn-primary",childrenType:"text",children:"读取剪切版",async onClick(){const t=await navigator.clipboard.readText();if(!t){I("没读取到文字");return}try{let n=Nt(t,At);n=tt(n),console.log("node",n);const r=et(n);console.log("nodes",r),e.set(r),navigator.clipboard.writeText(r)}catch(n){I(`解析xml失败:${n}`)}}}),m.div({className:"daisy-mockup-code w-full",children(){m.pre({children(){m.code({childrenType:"text",children:e.get})}})}})}function Bt(e){return typeof e=="string"?e:{...e,children:tt(e.children)}}function tt(e){return e.filter(t=>typeof t=="string"?t.trim():!0).map(Bt)}function et(e){return e.map(St).join(`
`)}const Z="aria-",D="data-";function St(e){if(typeof e=="string")return`renderText\`${e.trim()}\``;{const t=[];for(const n in e.attrs){const r=e.attrs[n];let o=n;if(n.startsWith(Z)&&(o=`aria_${n.slice(Z.length)}`),n.startsWith(D)&&(o=`data_${n.slice(D.length)}`),n=="class"&&(o="className"),typeof r=="string"){let s="'";r.includes("'")&&(s="`"),isNaN(Number(r))||(s=""),t.push(`${o}:${s}${r}${s},`)}else t.push(`${o}:${r},`)}if(e.children.length){let n=!0;if(e.children.length==1){const r=e.children[0];typeof r=="string"&&(t.push("childrenType:'text',",`children:\`${r}\`,`),n=!1)}n&&t.push(`children(){
           ${et(e.children)}
        }`)}return`${ct(e.type)?"fsvg":"fdom"}.${e.type}({
      ${t.join(`
`)}
    })`}}export{bt as default};
