import{x as Q,f as c,m as k,z as ae,w,b as v,j as ie,a as $,Y as b,B as ce,y as _,G as E,a1 as le,l as fe,W as de,t as S,n as M,o as D,u as F,v as Z,a2 as he,O as ue,e as me,a3 as N,A as V,F as Y,C as ee,S as L,H,q as te,J as O,K as ge,L as ye,D as W,a4 as R,c as A,a5 as xe,R as I,a6 as z,a7 as pe,a8 as be,k as X,M as ve}from"./index-DLvyNe9j.js";import{a as Ne}from"./onlyMobile-CFqX_MEt.js";import{f as we,a as De}from"./themeDropdown-B-iy4b8k.js";import{W as Me,a as P,S as Te,h as Se,m as ne,b as Ye,d as Ce,f as ke,g as C}from"./demoList-BeioHqSV.js";import{G as _e}from"./iconBase-pomhGcbn.js";import{a as B}from"./animate.es-CuPzepd-.js";import{f as Pe}from"./chunk-LSEVNFON-G8OzWBoO.js";const re="select-cell";function je(t,m,h,g,n){function s(){return n()/7}function l(){const i=g.get(),r=t;return i.year==r.year&&i.month==r.month}Q.div({attrs(i){const r=m();r==1||(i.s_position="absolute",i.s_inset=0,i.s_transform=`translateX(${(r-1)*100}%)`)},children(){c.div({className:"flex bg-base-100 z-10 relative",children(){for(let e=0;e<7;e++)c.div({className:"flex-1 aspect-square flex items-center justify-center text-base-content",childrenType:"text",children(){return Me[t.weekDay(e)]}})}});const i=k(()=>{const e=s(),o=e*5,a=ce(w(g.get()),P.get())-1;return _({0:0,[o]:e*a},E)}),r=k(()=>{const e=s()*5;return _({0:s()*5,[e]:s()},E)});c.div({className:"overflow-hidden bg-base-200 relative",s_height(){const e=h.get();return r(e)+"px"},children(){c.div({s_height(){return s()*6+"px"},s_transform(){const e=Math.max(h.get(),0);return`translateY(${-i(e)}px)`},children(){for(let e=0;e<6;e++)c.div({className:"flex items-center justify-center relative",children(){for(let o=0;o<7;o++){const a=t.fullDayOf(o,e);let f=t;a.type=="last"?f=t.lastMonth():a.type=="next"&&(f=t.nextMonth()),o==0&&c.div({className:"absolute left-0 text-label-small",childrenType:"text",children(){return ae(w({year:f.year,month:f.month,day:a.day}),P.get())}});const u=Te.fromYmd(f.year,f.month,a.day).getLunarDay(),d=v(()=>a.type=="this"&&l()&&g.get().day==a.day);c.div({className(){return $(`flex-1 aspect-square cursor-pointer
                        flex flex-col items-center justify-center gap-1 `,a.type!="this"&&"opacity-30")},onClick(){g.set(b.from(f.year,f.month,a.day))},children(){c.div({className:"flex items-center justify-center relative aspect-square p-1",children(){ie(d,()=>{c.div({id:re,className(){return $("absolute inset-0 ring-1 rounded-full ring-accent")}})}),c.span({className:"relative text-base-content/80  text-label-large",childrenType:"text",children:a.day})}}),c.div({className:"text-label-small  text-base-content/60",childrenType:"text",children:u.getName()})}})}}})}})}})}})}const j=le(void 0);function $e(t,m){return _e({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{fill:"none",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"m112 160-64 64 64 64"},child:[]},{tag:"path",attr:{fill:"none",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"M64 224h294c58.76 0 106 49.33 106 108v20"},child:[]}]},t,m)}const Ee=Y.get();function Fe(t,m){const{calendarScrollY:h,calendarClose:g,showCalendar:n,calendarScroll:s,calendarFinish:l,today:i}=j.consume();Se(t.get,re);const r=v(o=>{const a=t.get();return new fe(a.year,a.month,P.get())}),e=v(()=>{const o=t.get();return de.from(o.year,o.month,o.day,P.get())});c.div({className:"relative",onPointerDown:S(function(o,a){if(a=="y")return L.from(o,{getPage:H,scrollDelta(f,y){s(f,y)},onFinish(f){l(f)}})}),children(){const o=M(0);D(v(u=>{const d=r();if(u&&n()){const x=Math.sign(d.toNumber()-u.toNumber());x&&a.changePage(x)}return d})),D(v(u=>{const d=e();if(u&&!n()){const x=Math.sign(d.cells[0].toNumber()-u.cells[0].toNumber());x&&a.changePage(x)}return d}));const a=ne(o,f);function f(){return y.clientWidth}const y=c.div({className:"overflow-hidden  bg-base-300 touch-none",onPointerDown:S(function(u,d){if(d=="x")return a.pointerDown(u,Ee,x=>{if(n()){const p=x<0?r().lastMonth():r().nextMonth();t.get().day>p.days?t.set(b.from(p.year,p.month,p.days)):t.set(b.from(p.year,p.month,t.get().day))}else{const p=w(t.get());p.setTime(p.getTime()+x*Ye),x&&t.set(b.fromDate(p))}})}),children(){c.div({className:"relative",s_transform(){return`translateX(${-o.get()}px)`},children(){F(Z(()=>{const u=r();return[u.lastMonth(),u,u.nextMonth()]},ee),function(u,d){je(u,d,h,t,m)})}})}});c.div({className:"w-full h-11 flex justify-between items-center [padding-inline:18px] bg-base-100 z-10",children(){c.div({className:"flex items-center gap-1",children(){const u=he(()=>{const d=i().toNumber(),x=t.get().toNumber();return d!=x?[1]:ue});F(u,function(d){const x=c.button({className:"daisy-btn daisy-btn-xs daisy-btn-circle",onClick(){t.set(i())},children(){$e()}});D((p=me)=>{const T=d.step(),se=i().toNumber(),oe=t.get().toNumber(),q=Math.sign(oe-se);return T==p.step&&q==p.dir?p:{step:T,dir:q}},function({step:p,dir:T}){p=="enter"?B(x,{rotateY:T>0?[90,0]:[90,180]}).finished.then(d.resolve):p=="exiting"&&B(x,{rotateY:T>0?[0,90]:[180,90]}).finished.then(d.resolve)})}),c.h1({className(){const d=i(),x=t.get();return $("text-2xl text-base-content font-bold",d.equals(x)?"text-2xl":d.year==x.year?"text-xl":"text-lg",h.onAnimation()?V`cursor-not-allowed`:V`cursor-pointer`)},childrenType:"text",children(){const d=t.get();return i().year!=d.year?`${d.year}-${N(d.month,2)}-${N(d.day,2)}`:`${N(d.month,2)}-${N(d.day,2)}`},onClick(){h.onAnimation()||(n()?g():h.changeTo(0))}})}}),c.div({className:"text-base-content",children(){c.span({className:"mr-[0.125em] text-2xl",childrenType:"text",children:"¥"}),c.span({className:"text-2xl",childrenType:"text",children:"23"}),c.sup({className:"opacity-50 text-[0.75em] -top-[0.75em]",childrenType:"text",children:".00"})}})}})}})}const G=-50,Oe=Y.get();function We(t,m){const{showCalendar:h,calendarFinish:g,calendarScroll:n}=j.consume(),s=M(0);D(m,function(r){!r&&t()!=1&&te(()=>{s.set(0)})});let l;const i=Q.div({attrs(r){const e=t();r.className="absolute inset-0 select-none bg-base-100 overflow-hidden",e!=1&&(r.s_position="absolute",r.s_inset=0,r.s_transform=`translateX(${(e-1)*100}%)`)},onTouchMove(r){r.preventDefault()},onPointerDown:S(function(r,e){if(e=="y")return L.from(r,{getPage:H,scrollDelta(o,a){if(h())n(o,a);else{const f=s.get();s.set(f+ye(f,o,i.clientHeight,l.offsetHeight))}},onFinish(o){h()?g(o):(s.get()<=G&&console.log("新建"),Oe.destinationWithMarginIscroll({velocity:o,scroll:s,containerSize:i.clientHeight,contentSize:l.offsetHeight,edgeBackConfig:O,edgeConfig(a){return ge(a,{nextVelocity(f){return f*.9}})}}))}})}),children(){const r=k(()=>_({0:0,[G]:K.length-1},E));c.div({childrenType:"text",className:"absolute w-full flex justify-center",s_transform(){return`translateY(calc(${-s.get()}px - 100%))`},children(){const e=Math.round(r(s.get()));return K[e]}}),l=c.div({s_transform(){return`translateY(${-s.get()}px)`},className:"flex flex-col",s_minHeight:"100%",children(){Ce(Pe.number.int({min:1,max:58}))}})}})}const K=["新...","新增...","新增一...","新增一条...","新增一条记...","新增一条记录"],Ae=Y.get();function Ie(t){function m(){return n.clientWidth}const h=M(0),g=ne(h,m);D(v(s=>{const l=t.get();if(s){const i=w(s).valueOf(),e=w(l).valueOf()-i;let o=0;e>=W?o=1:e<=-864e5&&(o=-1),o&&g.changePage(o)}return l}));const n=c.div({className:"flex-1 overflow-hidden",onPointerDown:S(function(s,l){if(l=="x")return g.pointerDown(s,Ae,i=>{const r=w(t.get());r.setTime(r.getTime()+i*W),i&&t.set(b.fromDate(r))})}),children(){c.div({className:"h-full",s_transform(){return`translateX(${-h.get()}px)`},children(){F(Z(()=>{const s=t.get();return[s.beforeDay(),s,s.nextDay()]},ee),function(s,l){We(l,()=>h.onAnimation())})}})}})}const Le=Y.get(.007);function J({height:t,cellHeight:m,renderCell:h,value:g,realTimeValue:n=A(g.get()),format:s=R,getNearNestDiff:l=R}){const i=M(0);function r(o){n.set(s(n.get()+o))}function e(){const o=Math.floor(i.get()/m);o&&(i.silentDiff(-o*m),r(o),I())}return D(g.get,function(o){const a=l(o-n.get());a&&te(()=>{const f=a*m;i.changeTo(f,O,e)})}),{onPointerDown:S(function(o,a){if(a=="y")return L.from(o,{getPage:H,scrollDelta(f,y){i.changeDiff(f),e()},onFinish(f){const u=Le.getFromVelocity(f).distance+i.get();r(Math.round(u/m));const d=Math.round(u/m)*m;i.changeTo(d,O,e).then(()=>{e(),g.set(n.get())})}})}),children(){c.div({s_transform(){return`translateY(${-i.get()}px)`},children(){console.log("dd",t()),xe(function(o){const a=n.get(),f=Math.ceil(t()/m),y=Math.floor(f/2);for(let u=a-y;u<=a+y;u++)o(u,h)})}})}}}function He(t){const{yearMonthScrollY:m,scrollYearMonthOpenHeight:h}=j.consume(),g=k(()=>_({0:h(),[h()]:0},function(n,s,l,i){return s?pe(n,l,i,be):i[1]}));c.div({s_height(){return g(m.get())+"px"},children(){c.div({s_height(){return h()+"px"},s_transform(){return`translateY(${-m.get()}px)`},className:"relative w-full",children(){c.div({className:"absolute inset-0 flex items-stretch justify-center",children(){c.div({className:"flex-1 relative flex flex-col justify-center overflow-hidden",...J({height:h,cellHeight:44,value:{get(){return t.get().year},set(n){const s=t.get();if(s.year!=n){const l=Math.min(z(n,s.month),s.day);t.set(b.from(n,s.month,l))}}},renderCell(n){c.div({className:"h-11 text-center flex items-center justify-center",childrenType:"text",children:N(n,2)})}})}),c.div({className:"flex-1 relative flex flex-col justify-center overflow-hidden",...J({height:h,cellHeight:44,value:{get(){return t.get().month},set(n){const s=t.get();if(n!=s.month){const l=Math.min(z(s.year,n),s.day);t.set(b.from(s.year,n,l))}}},format(n){return n=n%12,n==0?12:n>0?n:12+n},getNearNestDiff(n){return n<-6?12+n:n>6?n-12:n},renderCell(n){c.div({className:"h-11 text-center flex items-center justify-center",childrenType:"text",children:N((n-1+12)%12+1,2)})}})})}}),c.div({className:"absolute inset-0 flex flex-col items-stretch justify-center pointer-events-none ",children(){c.div({className:"flex-1 bg-linear-to-b from-base-100 to-100% to-base-100/90"}),c.div({className:"h-11 flex flex-col justify-center"}),c.div({className:"flex-1 bg-linear-to-t from-base-100 to-100% to-base-100/90"})}})}})}})}const U=Y.get();function qe(){Ne(function({width:t},m){m&&we(function(){ke(),De()});const h=b.fromDate(new Date),g=A(h,X),n=setInterval(()=>{g.set(b.fromDate(new Date))},W/2);ve(()=>{clearInterval(n)});const s=A(h,X);function l(){return 5*t()/7}function i(){return 44*3}const r=M(l()),e=M(i());function o(){return e.get()!=i()}j.provide({yearMonthScrollY:e,scrollYearMonthOpenHeight:i,calendarScrollY:r,calendarOpenHeight:l,today:g.get,showCalendar(){return r.get()!=l()},async calendarClose(){o()&&e.changeTo(i()),r.changeTo(l())},calendarScroll(a,f){if(o()){const y=e.get()+a;y>=i()?(e.set(i()),I()):y<=0?e.set(e.get()+a/3):e.set(y)}else{const y=r.get()+a;y>=l()?(r.set(l()),I()):y<=0?(r.set(0),e.changeDiff(y)):r.set(y)}},calendarFinish(a){o()?U.getFromVelocity(a).distance+e.get()>i()/2?e.changeTo(i(),C(a)):e.changeTo(0,C(a)):U.getFromVelocity(a).distance+r.get()>l()/2?r.changeTo(l(),C(a)):r.changeTo(0,C(a))}}),c.div({className:"absolute inset-0 flex flex-col select-none touch-none",children(){He(s),Fe(s,t),Ie(s)}})})}function Je(){qe()}export{Je as default};
