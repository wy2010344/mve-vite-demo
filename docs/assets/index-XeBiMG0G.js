import{f as rt,j as L}from"./index-B26XVUiJ.js";import{S as tt,r as at,d as st,i as J,T as F,a as H}from"./transform-DDUXQDvM.js";import{p as K}from"./pointer-Drloq0xg.js";function S(n){return typeof n=="string"?new tt([[document.querySelector(n)]],[document.documentElement]):new tt([[n]],at)}const O={capture:!0,passive:!1};function $(n){n.preventDefault(),n.stopImmediatePropagation()}function ct(n){var c=n.document.documentElement,h=S(n).on("dragstart.drag",$,O);"onselectstart"in c?h.on("selectstart.drag",$,O):(c.__noselect=c.style.MozUserSelect,c.style.MozUserSelect="none")}function ht(n,c){var h=n.document.documentElement,g=S(n).on("dragstart.drag",null);c&&(g.on("click.drag",$,O),setTimeout(function(){g.on("click.drag",null)},0)),"onselectstart"in h?g.on("selectstart.drag",null):(h.style.MozUserSelect=h.__noselect,delete h.__noselect)}var lt=1e-12;function et(n){return((n=Math.exp(n))+1/n)/2}function ft(n){return((n=Math.exp(n))-1/n)/2}function mt(n){return((n=Math.exp(2*n))-1)/(n+1)}const gt=(function n(c,h,g){function y(p,l){var z=p[0],x=p[1],v=p[2],I=l[0],U=l[1],_=l[2],X=I-z,R=U-x,q=X*X+R*R,B,u;if(q<lt)u=Math.log(_/v)/c,B=function(Y){return[z+Y*X,x+Y*R,v*Math.exp(c*Y*u)]};else{var P=Math.sqrt(q),E=(_*_-v*v+g*q)/(2*v*h*P),G=(_*_-v*v-g*q)/(2*_*h*P),V=Math.log(Math.sqrt(E*E+1)-E),w=Math.log(Math.sqrt(G*G+1)-G);u=(w-V)/c,B=function(Y){var Q=Y*u,W=et(V),Z=v/(h*P)*(W*mt(c*Q+V)-ft(V));return[z+Z*X,x+Z*R,v*W/et(c*Q+V)]}}return B.duration=u*1e3*c/Math.SQRT2,B}return y.rho=function(p){var l=Math.max(.001,+p),z=l*l,x=z*z;return n(l,z,x)},y})(Math.SQRT2,2,4),A=n=>()=>n;function pt(n,{sourceEvent:c,target:h,transform:g,dispatch:y}){Object.defineProperties(this,{type:{value:n,enumerable:!0,configurable:!0},sourceEvent:{value:c,enumerable:!0,configurable:!0},target:{value:h,enumerable:!0,configurable:!0},transform:{value:g,enumerable:!0,configurable:!0},_:{value:y}})}function N(n){n.stopImmediatePropagation()}function j(n){n.preventDefault(),n.stopImmediatePropagation()}function dt(n){return(!n.ctrlKey||n.type==="wheel")&&!n.button}function yt(){var n=this;return n instanceof SVGElement?(n=n.ownerSVGElement||n,n.hasAttribute("viewBox")?(n=n.viewBox.baseVal,[[n.x,n.y],[n.x+n.width,n.y+n.height]]):[[0,0],[n.width.baseVal.value,n.height.baseVal.value]]):[[0,0],[n.clientWidth,n.clientHeight]]}function nt(){return this.__zoom||J}function vt(n){return-n.deltaY*(n.deltaMode===1?.05:n.deltaMode?1:.002)*(n.ctrlKey?10:1)}function zt(){return navigator.maxTouchPoints||"ontouchstart"in this}function _t(n,c,h){var g=n.invertX(c[0][0])-h[0][0],y=n.invertX(c[1][0])-h[1][0],p=n.invertY(c[0][1])-h[0][1],l=n.invertY(c[1][1])-h[1][1];return n.translate(y>g?(g+y)/2:Math.min(0,g)||Math.max(0,y),l>p?(p+l)/2:Math.min(0,p)||Math.max(0,l))}function wt(){var n=dt,c=yt,h=_t,g=vt,y=zt,p=[0,1/0],l=[[-1/0,-1/0],[1/0,1/0]],z=250,x=gt,v=st("start","zoom","end"),I,U,_,X=500,R=150,q=0,B=10;function u(t){t.property("__zoom",nt).on("wheel.zoom",Q,{passive:!1}).on("mousedown.zoom",W).on("dblclick.zoom",Z).filter(y).on("touchstart.zoom",ot).on("touchmove.zoom",it).on("touchend.zoom touchcancel.zoom",ut).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}u.transform=function(t,o,e,i){var r=t.selection?t.selection():t;r.property("__zoom",nt),t!==r?V(t,o,e,i):r.interrupt().each(function(){w(this,arguments).event(i).start().zoom(null,typeof o=="function"?o.apply(this,arguments):o).end()})},u.scaleBy=function(t,o,e,i){u.scaleTo(t,function(){var r=this.__zoom.k,a=typeof o=="function"?o.apply(this,arguments):o;return r*a},e,i)},u.scaleTo=function(t,o,e,i){u.transform(t,function(){var r=c.apply(this,arguments),a=this.__zoom,s=e==null?G(r):typeof e=="function"?e.apply(this,arguments):e,f=a.invert(s),m=typeof o=="function"?o.apply(this,arguments):o;return h(E(P(a,m),s,f),r,l)},e,i)},u.translateBy=function(t,o,e,i){u.transform(t,function(){return h(this.__zoom.translate(typeof o=="function"?o.apply(this,arguments):o,typeof e=="function"?e.apply(this,arguments):e),c.apply(this,arguments),l)},null,i)},u.translateTo=function(t,o,e,i,r){u.transform(t,function(){var a=c.apply(this,arguments),s=this.__zoom,f=i==null?G(a):typeof i=="function"?i.apply(this,arguments):i;return h(J.translate(f[0],f[1]).scale(s.k).translate(typeof o=="function"?-o.apply(this,arguments):-o,typeof e=="function"?-e.apply(this,arguments):-e),a,l)},i,r)};function P(t,o){return o=Math.max(p[0],Math.min(p[1],o)),o===t.k?t:new F(o,t.x,t.y)}function E(t,o,e){var i=o[0]-e[0]*t.k,r=o[1]-e[1]*t.k;return i===t.x&&r===t.y?t:new F(t.k,i,r)}function G(t){return[(+t[0][0]+ +t[1][0])/2,(+t[0][1]+ +t[1][1])/2]}function V(t,o,e,i){t.on("start.zoom",function(){w(this,arguments).event(i).start()}).on("interrupt.zoom end.zoom",function(){w(this,arguments).event(i).end()}).tween("zoom",function(){var r=this,a=arguments,s=w(r,a).event(i),f=c.apply(r,a),m=e==null?G(f):typeof e=="function"?e.apply(r,a):e,b=Math.max(f[1][0]-f[0][0],f[1][1]-f[0][1]),d=r.__zoom,M=typeof o=="function"?o.apply(r,a):o,k=x(d.invert(m).concat(b/d.k),M.invert(m).concat(b/M.k));return function(T){if(T===1)T=M;else{var D=k(T),C=b/D[2];T=new F(C,m[0]-D[0]*C,m[1]-D[1]*C)}s.zoom(null,T)}})}function w(t,o,e){return!e&&t.__zooming||new Y(t,o)}function Y(t,o){this.that=t,this.args=o,this.active=0,this.sourceEvent=null,this.extent=c.apply(t,o),this.taps=0}Y.prototype={event:function(t){return t&&(this.sourceEvent=t),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(t,o){return this.mouse&&t!=="mouse"&&(this.mouse[1]=o.invert(this.mouse[0])),this.touch0&&t!=="touch"&&(this.touch0[1]=o.invert(this.touch0[0])),this.touch1&&t!=="touch"&&(this.touch1[1]=o.invert(this.touch1[0])),this.that.__zoom=o,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(t){var o=S(this.that).datum();v.call(t,this.that,new pt(t,{sourceEvent:this.sourceEvent,target:u,transform:this.that.__zoom,dispatch:v}),o)}};function Q(t,...o){if(!n.apply(this,arguments))return;var e=w(this,o).event(t),i=this.__zoom,r=Math.max(p[0],Math.min(p[1],i.k*Math.pow(2,g.apply(this,arguments)))),a=K(t);if(e.wheel)(e.mouse[0][0]!==a[0]||e.mouse[0][1]!==a[1])&&(e.mouse[1]=i.invert(e.mouse[0]=a)),clearTimeout(e.wheel);else{if(i.k===r)return;e.mouse=[a,i.invert(a)],H(this),e.start()}j(t),e.wheel=setTimeout(s,R),e.zoom("mouse",h(E(P(i,r),e.mouse[0],e.mouse[1]),e.extent,l));function s(){e.wheel=null,e.end()}}function W(t,...o){if(_||!n.apply(this,arguments))return;var e=t.currentTarget,i=w(this,o,!0).event(t),r=S(t.view).on("mousemove.zoom",m,!0).on("mouseup.zoom",b,!0),a=K(t,e),s=t.clientX,f=t.clientY;ct(t.view),N(t),i.mouse=[a,this.__zoom.invert(a)],H(this),i.start();function m(d){if(j(d),!i.moved){var M=d.clientX-s,k=d.clientY-f;i.moved=M*M+k*k>q}i.event(d).zoom("mouse",h(E(i.that.__zoom,i.mouse[0]=K(d,e),i.mouse[1]),i.extent,l))}function b(d){r.on("mousemove.zoom mouseup.zoom",null),ht(d.view,i.moved),j(d),i.event(d).end()}}function Z(t,...o){if(n.apply(this,arguments)){var e=this.__zoom,i=K(t.changedTouches?t.changedTouches[0]:t,this),r=e.invert(i),a=e.k*(t.shiftKey?.5:2),s=h(E(P(e,a),i,r),c.apply(this,o),l);j(t),z>0?S(this).transition().duration(z).call(V,s,i,t):S(this).call(u.transform,s,i,t)}}function ot(t,...o){if(n.apply(this,arguments)){var e=t.touches,i=e.length,r=w(this,o,t.changedTouches.length===i).event(t),a,s,f,m;for(N(t),s=0;s<i;++s)f=e[s],m=K(f,this),m=[m,this.__zoom.invert(m),f.identifier],r.touch0?!r.touch1&&r.touch0[2]!==m[2]&&(r.touch1=m,r.taps=0):(r.touch0=m,a=!0,r.taps=1+!!I);I&&(I=clearTimeout(I)),a&&(r.taps<2&&(U=m[0],I=setTimeout(function(){I=null},X)),H(this),r.start())}}function it(t,...o){if(this.__zooming){var e=w(this,o).event(t),i=t.changedTouches,r=i.length,a,s,f,m;for(j(t),a=0;a<r;++a)s=i[a],f=K(s,this),e.touch0&&e.touch0[2]===s.identifier?e.touch0[0]=f:e.touch1&&e.touch1[2]===s.identifier&&(e.touch1[0]=f);if(s=e.that.__zoom,e.touch1){var b=e.touch0[0],d=e.touch0[1],M=e.touch1[0],k=e.touch1[1],T=(T=M[0]-b[0])*T+(T=M[1]-b[1])*T,D=(D=k[0]-d[0])*D+(D=k[1]-d[1])*D;s=P(s,Math.sqrt(T/D)),f=[(b[0]+M[0])/2,(b[1]+M[1])/2],m=[(d[0]+k[0])/2,(d[1]+k[1])/2]}else if(e.touch0)f=e.touch0[0],m=e.touch0[1];else return;e.zoom("touch",h(E(s,f,m),e.extent,l))}}function ut(t,...o){if(this.__zooming){var e=w(this,o).event(t),i=t.changedTouches,r=i.length,a,s;for(N(t),_&&clearTimeout(_),_=setTimeout(function(){_=null},X),a=0;a<r;++a)s=i[a],e.touch0&&e.touch0[2]===s.identifier?delete e.touch0:e.touch1&&e.touch1[2]===s.identifier&&delete e.touch1;if(e.touch1&&!e.touch0&&(e.touch0=e.touch1,delete e.touch1),e.touch0)e.touch0[1]=this.__zoom.invert(e.touch0[0]);else if(e.end(),e.taps===2&&(s=K(s,this),Math.hypot(U[0]-s[0],U[1]-s[1])<B)){var f=S(this).on("dblclick.zoom");f&&f.apply(this,arguments)}}}return u.wheelDelta=function(t){return arguments.length?(g=typeof t=="function"?t:A(+t),u):g},u.filter=function(t){return arguments.length?(n=typeof t=="function"?t:A(!!t),u):n},u.touchable=function(t){return arguments.length?(y=typeof t=="function"?t:A(!!t),u):y},u.extent=function(t){return arguments.length?(c=typeof t=="function"?t:A([[+t[0][0],+t[0][1]],[+t[1][0],+t[1][1]]]),u):c},u.scaleExtent=function(t){return arguments.length?(p[0]=+t[0],p[1]=+t[1],u):[p[0],p[1]]},u.translateExtent=function(t){return arguments.length?(l[0][0]=+t[0][0],l[1][0]=+t[1][0],l[0][1]=+t[0][1],l[1][1]=+t[1][1],u):[[l[0][0],l[0][1]],[l[1][0],l[1][1]]]},u.constrain=function(t){return arguments.length?(h=t,u):h},u.duration=function(t){return arguments.length?(z=+t,u):z},u.interpolate=function(t){return arguments.length?(x=t,u):x},u.on=function(){var t=v.on.apply(v,arguments);return t===v?u:t},u.clickDistance=function(t){return arguments.length?(q=(t=+t)*t,u):Math.sqrt(q)},u.tapDistance=function(t){return arguments.length?(B=+t,u):B},u}function xt(){rt.div({className:"w-full h-full relative overflow-hidden",children(n){const c=S(n);let h=J;const g=wt().scaleExtent([.1,3]).on("zoom",y=>{h=y.transform,c.attr("transform",h.toString())});L.svg({width:"100%",height:"100%",children(y){S(y).call(g),L.g({})}})}})}export{xt as default};
