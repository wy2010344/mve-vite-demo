import{c as te,y as ne,Y as h,m as d,z as re,W as ae,A as T,F as se,o as H,B as ie,D as p,E as I,G as O,H as v,I as oe,g as V,J as X,f as i,K as k,b as le,a as S,L as W,M as Y,N as L,O as q,P as E,Q as ce,R as fe,T as me,U as de,C as ue,V as ge,X as he,w as j,Z as y,_ as ye}from"./index-DzjyJcX9.js";import{S as A}from"./index--WBo1qrp.js";import{e as pe}from"./explain-55b8_AdP.js";import{a as xe}from"./onlyMobile-BWWyyzDX.js";import _e from"./hookTrackLayout-YGI7JWSY.js";import ve,{firstDayOfWeekIndex as D,WEEKTIMES as De,WEEKS as we}from"./firstDayOfWeek-DrUuMBPI.js";import{f as be}from"./fixRightTop-Db2_Vtd0.js";import{t as Ne}from"./themeDropdown-CvPGJFqw.js";import Me from"./demoList-DjBubDIy.js";import{f as Te}from"./chunk-LSEVNFON-G8OzWBoO.js";import"./iconBase-DKriBYi6.js";import"./index-DFRpaVUm.js";import"./index-cHHGad51.js";const K="select-cell";function Xe(){pe(()=>{}),xe(function({width:u},x){x&&be(function(){ve(),Ne()});const s=te(h.fromDate(new Date),ne),f=d(r=>{const e=s.get();return new re(e.year,e.month,D.get())}),_=d(()=>{const r=s.get();return ae.from(r.year,r.month,r.day,D.get())}),B=window;B.__date=s;const c=T(0);let w;se.get();function m(){return u()/7}const g=d(()=>c.get()>=5*m()),P=T(0),C=H(()=>{const r=m(),e=r*5,n=ie(p(s.get()),D.get())-1;return I({0:0,[e]:-r*n},O)}),b=T(0);let z=s.get();v(()=>b.onAnimation(),function(r){r||(z.equals(s.get())||oe(()=>{g()?c.changeTo(m()*5,V({config:{zta:.7,omega0:20}})):c.changeTo(0,V({config:{zta:.7,omega0:20}}))}),z=s.get())}),v(d(r=>{const e=f();if(r&&!g()){const n=Math.sign(e.toNumber()-r.toNumber());n&&N.changePage(n)}return e})),v(d(r=>{const e=_();if(r&&g()){const n=Math.sign(e.cells[0].toNumber()-r.cells[0].toNumber());n&&N.changePage(n)}return e}));function F(){return M.clientWidth}const N=X(P,F);_e(s.get,K);const J=H(()=>{const r=m()*5;return I({0:m()*7,[r]:m()*2},O)}),M=i.div({s_height:"100%",s_overflow:"hidden",s_userSelect:"none",onTouchMove(r){r.preventDefault()},onPointerDown:k(function(){return c.stop(),{onMove(r,e){if(e=="y")return ce.from(r,{getPage:fe,scrollDelta(n){ge(c,n,M.clientHeight,w.offsetHeight)},onFinish(n){const t=me([{beforeForce:.005,size:m()*5,afterForce:.005}]);de({scroll:c,frictional:ue.get().getFromVelocity(n),containerSize:M.clientHeight,contentSize:w.offsetHeight,targetSnap:t})}})}}}),children(){w=i.div({s_transform(){return`translateY(${-c.get()}px)`},className:"flex flex-col",s_minHeight(){return`calc(100% + ${u()}px * 5 / 7)`},children(){i.div({className:"bg-base-100 relative z-10",s_display:"flex",s_alignItems:"stretch",s_transform(){return`translateY(${Math.max(c.get(),0)}px)`},children(){i.h1({className:"text-display-large",childrenType:"text",children(){return s.get().month}}),i.div({className:"flex flex-col items-start justify-center",children(){i.div({className:"text-title-large",childrenType:"text",children(){return s.get().year}}),i.div({className:"text-title-medium",childrenType:"text",children(){return`月 ${s.get().day}日`}})}})}}),i.div({s_zIndex:1,s_position:"relative",s_height(){return m()*7+"px"},children(){i.div({className:"bg-base-300",s_overflow:"hidden",s_height(){const e=c.get();return J(e)+"px"},s_transform(){return`translateY(${Math.max(c.get(),0)}px)`},onPointerDown:k(function(){return{onMove(e,n){if(n=="x")return N.pointerDown(e,{getPage:L,callback(t,o){if(g()){const a=p(s.get());a.setTime(a.getTime()+t*De),t&&s.set(h.fromDate(a))}else{const a=t<0?f().lastMonth():f().nextMonth();s.get().day>a.days?s.set(h.from(a.year,a.month,a.days)):s.set(h.from(a.year,a.month,s.get().day))}}})}}}),children(){i.div({s_position:"relative",s_transform(){return`translateX(${-P.get()}px)`},children(){le(g,function(){S(W(()=>{const e=_();return[e.beforeWeek(),e,e.nextWeek()]},Y),function(e,n){U(e,n)})},function(){S(W(()=>{const e=f();return[e.lastMonth(),e,e.nextMonth()]},Y),function(e,n){Q(e,n)})})}})}})}}),v(d(e=>{const n=s.get();if(e){const t=p(e).valueOf(),a=p(n).valueOf()-t;let l=0;a>=q?l=1:a<=-864e5&&(l=-1),l&&r.changePage(l)}return n}));const r=X(b,F);i.div({className:" flex-1",onPointerDown:k(function(){return{onMove(e,n){if(n=="x")return r.pointerDown(e,{getPage:L,callback(t,o){const a=p(s.get());a.setTime(a.getTime()+t*q),t&&s.set(h.fromDate(a))}})}}}),children(){i.div({className:"relative",s_transform(){return`translateX(${-b.get()}px)`},children(){S(W(()=>{const e=s.get();return[e.beforeDay(),e,e.nextDay()]},Y),function(e,n){E.div({attrs(t){const o=n();o!=1&&(t.s_position="absolute",t.s_inset=0,t.s_transform=`translateX(${(o-1)*100}%)`)},children(){Me(Te.number.int({max:17,min:15}))}})})}})}})}})}});function Q(r,e){function n(){const t=s.get(),o=r;return t.year==o.year&&t.month==o.month}return E.div({attrs(t){const o=e();if(o==1){const a=c.get();t.s_transform=` translateY(${C(a)}px)`}else t.s_position="absolute",t.s_inset=0,t.s_transform=`translateX(${(o-1)*100}%)`},children(){$(()=>{const t=c.get();return`translateY(${-C(t)}px)`}),i.div({children(){for(let t=0;t<6;t++)i.div({className:"flex items-center justify-center relative",children(){for(let o=0;o<7;o++){const a=r.fullDayOf(o,t);let l=r;a.type=="last"?l=r.lastMonth():a.type=="next"&&(l=r.nextMonth()),R(o,{year:l.year,month:l.month,day:a.day});const Z=A.fromYmd(l.year,l.month,a.day).getLunarDay(),ee=d(()=>a.type=="this"&&n()&&s.get().day==a.day);G({day:a.day,onClick(){s.set(h.from(l.year,l.month,a.day))},lunarDay:Z,selected:ee,hide(){return g()?!1:a.type!="this"}})}}})}})}})}function $(r){i.div({className:"bg-base-300 relative z-10",s_display:"flex",s_alignItems:"center",s_justifyContent:"space-between",s_transform:r,children(){for(let e=0;e<7;e++)i.div({className:"flex-1 aspect-square flex items-center justify-center",childrenType:"text",children(){return we[f().weekDay(e)]}})}})}function U(r,e){E.div({attrs(n){n.className="self-start",e()!=1&&(n.s_position="absolute",n.s_inset=0,n.s_transform=`translateX(${(e()-1)*100}%)`)},children(){$(),i.div({className:"flex items-center justify-center relative",children(){for(let n=0;n<7;n++){const t=r.cells[n];R(n,t);const a=A.fromYmd(t.year,t.month,t.day).getLunarDay();G({hide(){return!1},day:t.day,lunarDay:a,selected(){return ye(t,s.get())},onClick(){s.set(t)}})}}})}})}})}function R(u,x){u==0&&i.div({className:"absolute left-0 text-label-small",childrenType:"text",children(){return he(p(x),D.get())}})}function G({day:u,lunarDay:x,hide:s,selected:f,onClick:_}){i.div({s_flex:1,s_aspectRatio:1,s_display:"flex",s_flexDirection:"column",s_alignItems:"center",s_justifyContent:"center",className(){return s()?y` opacity-30`:""},onClick:_,children(){i.div({s_aspectRatio:1,s_display:"grid",s_placeItems:"center",s_position:"relative",children(){i.div({id(){return f()?K:""},className(){return j(y`absolute inset-0  rounded-full z-0`,f()&&y`bg-primary`)}}),i.span({s_position:"relative",className(){return j(f()?y`text-primary-content`:y`text-base-content`,y`transition-all`)},childrenType:"text",children:u})}}),i.div({s_fontSize:"10px",childrenType:"text",className:"text-neutral-500",children:x.getName()})}})}export{Xe as default};
