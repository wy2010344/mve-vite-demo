import{aT as S,c as v,A as H,aU as h,R as y,f as B,aV as I,aS as O,x as R,d as E,o as P,i as k,aW as X,aP as p,O as A,aX as D}from"./index-CnmbM-dR.js";import F from"./column-BV09m5G2.js";import{taskContext as M}from"./context-CUE_gZbz.js";import N from"./cardBase-Bs25AdqV.js";import"./columnBase-CfXaW5d5.js";import"./type-DRAuYFMP.js";import"./chunk-LSEVNFON-G8OzWBoO.js";import"./xmlRender-BUbo4KVT.js";import"./index-DxtaNgaR.js";import"./iconBase-BXAUkN_4.js";import"./mve-icon-Tt48vH7k.js";import"./index-DbV9IpBF.js";import"./index-DjZGZQsH.js";import"./index-BHzW6WMu.js";function te({tasks:C,columns:T}){const d=S(C),a=v(void 0),l=H(()=>{const r=a.get();if(r)return d.get().find(e=>e.id==r.id)}),{dragX:c,dragY:m,backHolder:g,targetHolder:f,activeColumn:b}=M.provide({tasks:d,dragData:a,dragTask:l,dragX:y(0),dragY:y(0),columns:new Map,targetHolder:h(void 0),backHolder:h(void 0),activeColumn:v(void 0)});B.div({plugin:I({shouldMeasure:a.get,direction:"x"}),className:"flex gap-6 overflow-x-auto overflow-y-hidden pb-6 flex-1 relative",children(){T.map(e=>{O(()=>{p.renderChild(F(e))})});function r(){a.set(void 0),f.set(void 0),g.set(void 0),b.set(void 0)}R(a.get,e=>{e&&(E(e.type.get,function(n){n=="cancel"?k(()=>{const o=g.get();if(o){const s=o.getBoundingClientRect();Promise.all([c.animateTo(s.x+e.x),m.animateTo(s.y+e.y)]).then(()=>{r()})}}):n=="move"&&k(()=>{const o=f.get();if(o){const s=o.element.getBoundingClientRect();Promise.all([c.animateTo(s.x+e.x),m.animateTo(s.y+e.y)]).then(()=>{const w=l(),u=o.getBeforeId(),_=d.set(function(t){t=[...t];const x={...w,type:o.type};if(X(t,i=>i.id==e.id),u){for(let i=0;i<t.length;i++)if(t[i].id==u){t.splice(i,0,x);break}}else t.push(x);return t});r(),setTimeout(()=>{_.commit()},10*1e3)})}})}),P(l,function(){p.renderChild(p.createElement(N,{selected:D,onDelete:A,getTask:l,className:"pointer-events-none opacity-90 fixed",s_zIndex:1e3,s_width:e.width+"px",s_height:e.height+"px",s_top:()=>m.get()-e.y+"px",s_left:()=>c.get()-e.x+"px",s_transformOrigin:`${e.x}px ${e.y}px`,s_rotate:()=>{var n;return(n=a.get())!=null&&n.type.get()?"0deg":"-15deg"}}))}))})}})}export{te as default};
