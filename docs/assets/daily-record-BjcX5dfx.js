import{a3 as ue,y as q,f as c,A as he,x as D,j as V,a as E,G as me,m as W,b as v,C as ge,z as F,Y as b,H as I,l as ye,W as xe,u as T,o as k,q as w,v as _,w as P,a4 as pe,Q as be,e as ve,a5 as N,B,F as C,E as $,I as X,J as z,t as ne,L as O,M as Ne,N as De,D as A,c as L,a6 as we,U as H,a7 as G,a8 as ke,a9 as Me,k as K,O as Te}from"./index-DnGCQBT-.js";import{a as Ce}from"./onlyMobile-BqottMH7.js";import{f as Se,a as Ye}from"./themeDropdown-T3x6LpCY.js";import{S as se,a as j,W as re,h as _e,b as We,d as Fe,f as je}from"./demoList-PVtUdY_x.js";import{m as oe,c as Ee,a as U,g as Y}from"./movePage-DpqS8Mge.js";import{G as Ie}from"./iconBase-B4az98kw.js";import{a as J}from"./animate.es-CuPzepd-.js";import{f as Pe}from"./chunk-LSEVNFON-G8OzWBoO.js";const S=ue(void 0);function ae(e){c.div({className:"flex bg-base-100 z-10 relative",children(){for(let f=0;f<7;f++)c.div({className:"flex-1 aspect-square flex items-center justify-center text-base-content",childrenType:"text",children(){return e(f)}})}})}function ie(e,f){e==0&&c.div({className:"absolute left-0 text-label-small",childrenType:"text",children(){return he(D(f),j.get())}})}function ce({day:e,lunarDay:f,hide:h,selected:l,onClick:r}){c.div({className(){return E(`flex-1 aspect-square cursor-pointer
                        flex flex-col items-center justify-center gap-1 `,h()&&"opacity-30")},onClick:r,children(){c.div({className:"flex items-center justify-center relative aspect-square p-1",children(){V(l,()=>{c.div({id:le,className(){return E("absolute inset-0 ring-1 rounded-full ring-accent")}})}),c.span({className:"relative text-base-content/80  text-label-large",childrenType:"text",children:e})}}),c.div({className:"text-label-small  text-base-content/60",childrenType:"text",children:f.getName()})}})}function $e(e,f,h){q.div({attrs(l){const r=f();r==1||(l.s_position="absolute",l.s_inset=0,l.s_transform=`translateX(${(r-1)*100}%)`)},children(){ae(function(l){return re[e.weekDay(l)]}),c.div({className:"flex items-center justify-center relative",children(){for(let l=0;l<7;l++){const r=e.cells[l];ie(l,r);const a=se.fromYmd(r.year,r.month,r.day).getLunarDay();ce({hide(){return!1},day:r.day,lunarDay:a,selected(){return me(r,h.get())},onClick(){h.set(r)}})}}})}})}const le="select-cell";function Oe(e,f,h,l,r){function t(){return r()/7}const{showCalendar:a}=S.consume();function m(){const s=l.get(),o=e;return s.year==o.year&&s.month==o.month}q.div({attrs(s){const o=f();o==1||(s.s_position="absolute",s.s_inset=0,s.s_transform=`translateX(${(o-1)*100}%)`)},children(){ae(function(n){return re[e.weekDay(n)]});const s=W(()=>{const n=t(),i=n*5,g=ge(D(l.get()),j.get())-1;return F({0:0,[i]:n*g},I)}),o=W(()=>{const n=t()*5;return F({0:t()*6,[n]:t()},I)});c.div({className:"overflow-hidden bg-base-200 relative",s_height(){const n=h.get();return o(n)+"px"},children(){V(a,function(){c.div({s_height(){return t()*7+"px"},s_transform(){const n=Math.max(h.get(),0);return`translateY(${-s(n)}px)`},children(){for(let n=0;n<6;n++)c.div({className:"flex items-center justify-center relative",children(){for(let i=0;i<7;i++){const g=e.fullDayOf(i,n);let u=e;g.type=="last"?u=e.lastMonth():g.type=="next"&&(u=e.nextMonth()),ie(i,{year:u.year,month:u.month,day:g.day});const d=se.fromYmd(u.year,u.month,g.day).getLunarDay(),x=v(()=>g.type=="this"&&m()&&l.get().day==g.day);ce({day:g.day,onClick(){l.set(b.from(u.year,u.month,g.day))},lunarDay:d,selected:x,hide(){return a()?g.type!="this":!1}})}}})}})})}})}})}function Ae(e,f){return Ie({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{fill:"none",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"m112 160-64 64 64 64"},child:[]},{tag:"path",attr:{fill:"none",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"M64 224h294c58.76 0 106 49.33 106 108v20"},child:[]}]},e,f)}const Le=C.get();function He(e,f){const{calendarScrollY:h,calendarClose:l,showCalendar:r,calendarScroll:t,calendarFinish:a,today:m}=S.consume();_e(e.get,le);const s=v(n=>{const i=e.get();return new ye(i.year,i.month,j.get())}),o=v(()=>{const n=e.get();return xe.from(n.year,n.month,n.day,j.get())});c.div({className:"relative",onPointerDown:T(function(n,i){if(i=="y")return X.from(n,{getPage:z,scrollDelta(g,u){t(g,u)},onFinish(g){a(g)}})}),children(){const n=k(0);w(v(y=>{const d=s();if(y&&r()){const x=Math.sign(d.toNumber()-y.toNumber());x&&i.changePage(x)}return d})),w(v(y=>{const d=o();if(y&&!r()){const x=Math.sign(d.cells[0].toNumber()-y.cells[0].toNumber());x&&i.changePage(x)}return d}));const i=oe(n,g);function g(){return u.clientWidth}const u=c.div({className:"overflow-hidden  bg-base-300 touch-none",onPointerDown:T(function(y,d){if(d=="x")return i.pointerDown(y,Le,x=>{if(r()){const p=x<0?s().lastMonth():s().nextMonth();e.get().day>p.days?e.set(b.from(p.year,p.month,p.days)):e.set(b.from(p.year,p.month,e.get().day))}else{const p=D(e.get());p.setTime(p.getTime()+x*We),x&&e.set(b.fromDate(p))}})}),children(){c.div({className:"relative",s_transform(){return`translateX(${-n.get()}px)`},children(){V(r,function(){_(P(()=>{const y=s();return[y.lastMonth(),y,y.nextMonth()]},$),function(y,d){Oe(y,d,h,e,f)})},function(){_(P(()=>{const y=o();return[y.beforeWeek(),y,y.nextWeek()]},$),function(y,d){$e(y,d,e)})})}})}});c.div({className:"w-full h-11 flex justify-between items-center [padding-inline:18px] bg-base-100 z-10",children(){c.div({className:"flex items-center gap-1",children(){const y=pe(()=>{const d=m().toNumber(),x=e.get().toNumber();return d!=x?[1]:be});_(y,function(d){const x=c.button({className:"daisy-btn daisy-btn-xs daisy-btn-circle",onClick(){e.set(m())},children(){Ae()}});w((p=ve)=>{const M=d.step(),fe=m().toNumber(),de=e.get().toNumber(),R=Math.sign(de-fe);return M==p.step&&R==p.dir?p:{step:M,dir:R}},function({step:p,dir:M}){p=="enter"?J(x,{rotateY:M>0?[90,0]:[90,180]}).finished.then(d.resolve):p=="exiting"&&J(x,{rotateY:M>0?[0,90]:[180,90]}).finished.then(d.resolve)})}),c.h1({className(){const d=m(),x=e.get();return E("text-2xl text-base-content font-bold",d.equals(x)?"text-2xl":d.year==x.year?"text-xl":"text-lg",h.onAnimation()?B`cursor-not-allowed`:B`cursor-pointer`)},childrenType:"text",children(){const d=e.get();return m().year!=d.year?`${d.year}-${N(d.month,2)}-${N(d.day,2)}`:`${N(d.month,2)}-${N(d.day,2)}`},onClick(){h.onAnimation()||(r()?l():h.changeTo(0))}})}}),c.div({className:"text-base-content",children(){c.span({className:"mr-[0.125em] text-2xl",childrenType:"text",children:"¥"}),c.span({className:"text-2xl",childrenType:"text",children:"23"}),c.sup({className:"opacity-50 text-[0.75em] -top-[0.75em]",childrenType:"text",children:".00"})}})}})}})}const Q=-50,qe=C.get();function Ve(e,f){const{showCalendar:h,calendarFinish:l,calendarScroll:r}=S.consume(),t=k(0);w(f,function(s){!s&&e()!=1&&ne(()=>{t.set(0)})});let a;const m=q.div({attrs(s){const o=e();s.className="absolute inset-0 select-none bg-base-100 overflow-hidden",o!=1&&(s.s_position="absolute",s.s_inset=0,s.s_transform=`translateX(${(o-1)*100}%)`)},onTouchMove(s){s.preventDefault()},onPointerDown:T(function(s,o){if(o=="y")return X.from(s,{getPage:z,scrollDelta(n,i){if(h())r(n,i);else{const g=t.get();t.set(g+De(g,n,m.clientHeight,a.offsetHeight))}},onFinish(n){h()?l(n):(t.get()<=Q&&console.log("新建"),qe.destinationWithMarginIscroll({velocity:n,scroll:t,containerSize:m.clientHeight,contentSize:a.offsetHeight,edgeBackConfig:O,edgeConfig(i){return Ne(i,{nextVelocity(g){return g*.9}})}}))}})}),children(){const s=W(()=>F({0:0,[Q]:Z.length-1},I));c.div({childrenType:"text",className:"absolute w-full flex justify-center",s_transform(){return`translateY(calc(${-t.get()}px - 100%))`},children(){const o=Math.round(s(t.get()));return Z[o]}}),a=c.div({s_transform(){return`translateY(${-t.get()}px)`},className:"flex flex-col",s_minHeight:"100%",children(){Fe(Pe.number.int({min:1,max:58}))}})}})}const Z=["新...","新增...","新增一...","新增一条...","新增一条记...","新增一条记录"],Xe=C.get();function ze(e){function f(){return r.clientWidth}const h=k(0),l=oe(h,f);w(v(t=>{const a=e.get();if(t){const m=D(t).valueOf(),o=D(a).valueOf()-m;let n=0;o>=A?n=1:o<=-864e5&&(n=-1),n&&l.changePage(n)}return a}));const r=c.div({className:"flex-1 overflow-hidden",onPointerDown:T(function(t,a){if(a=="x")return l.pointerDown(t,Xe,m=>{const s=D(e.get());s.setTime(s.getTime()+m*A),m&&e.set(b.fromDate(s))})}),children(){c.div({className:"h-full",s_transform(){return`translateX(${-h.get()}px)`},children(){_(P(()=>{const t=e.get();return[t.beforeDay(),t,t.nextDay()]},$),function(t,a){Ve(a,()=>h.onAnimation())})}})}})}const Re=C.get(.007);function ee({height:e,cellHeight:f,renderCell:h,value:l,realTimeValue:r=L(l.get()),circle:t}){const a=k(0);function m(o){const n=r.get()+o;if(t){const i=t.baseIndex||0;r.set(U(n-i,t.count)+i)}else r.set(n)}function s(){const o=Math.floor(a.get()/f);o&&(a.silentDiff(-o*f),m(o),H())}return w(l.get,function(o){let n=o-r.get();t&&(n=Ee(n,t.count)),n&&ne(()=>{const i=n*f;a.changeTo(i,O,s)})}),{onPointerDown:T(function(o,n){if(n=="y")return X.from(o,{getPage:z,scrollDelta(i,g){a.changeDiff(i),s()},onFinish(i){const u=Re.getFromVelocity(i).distance+a.get();m(Math.round(u/f));const y=Math.round(u/f)*f;a.animateTo(y,O,s).then(()=>{s(),l.set(r.get())})}})}),children(){c.div({s_transform(){return`translateY(${-a.get()}px)`},children(){we(function(o){const n=r.get(),i=Math.ceil(e()/f),g=Math.floor(i/2);for(let u=n-g;u<=n+g;u++){let y=u;if(t){const d=t.baseIndex||0;y=U(u-d,t.count)+d}o(y,y,h)}})}})}}}function Be(e){const{yearMonthScrollY:f,scrollYearMonthOpenHeight:h}=S.consume(),l=W(()=>F({0:h(),[h()]:0},function(r,t,a,m){return t?ke(r,a,m,Me):m[1]}));c.div({s_height(){return l(f.get())+"px"},children(){c.div({s_height(){return h()+"px"},s_transform(){return`translateY(${-f.get()}px)`},className:"relative w-full",children(){c.div({className:"absolute inset-0 flex items-stretch justify-center",children(){c.div({className:"flex-1 relative flex flex-col justify-center overflow-hidden",...ee({height:h,cellHeight:44,value:{get(){return e.get().year},set(r){const t=e.get();if(t.year!=r){const a=Math.min(G(r,t.month),t.day);e.set(b.from(r,t.month,a))}}},renderCell(r){c.div({className:"h-11 text-center flex items-center justify-center",childrenType:"text",children:N(r,2)})}})}),c.div({className:"flex-1 relative flex flex-col justify-center overflow-hidden",...ee({height:h,cellHeight:44,value:{get(){return e.get().month},set(r){const t=e.get();if(r!=t.month){const a=Math.min(G(t.year,r),t.day);e.set(b.from(t.year,r,a))}}},circle:{baseIndex:1,count:12},renderCell(r){c.div({className:"h-11 text-center flex items-center justify-center",childrenType:"text",children:N(r,2)})}})})}}),c.div({className:"absolute inset-0 flex flex-col items-stretch justify-center pointer-events-none ",children(){c.div({className:"flex-1 bg-linear-to-b from-base-100 to-100% to-base-100/90"}),c.div({className:"h-11 flex flex-col justify-center"}),c.div({className:"flex-1 bg-linear-to-t from-base-100 to-100% to-base-100/90"})}})}})}})}const te=C.get();function Ge(){Ce(function({width:e},f){f&&Se(function(){je(),Ye()});const h=b.fromDate(new Date),l=L(h,K),r=setInterval(()=>{l.set(b.fromDate(new Date))},A/2);Te(()=>{clearInterval(r)});const t=L(h,K);function a(){return 5*e()/7}function m(){return 44*3}const s=k(a()),o=k(m());function n(){return o.get()!=m()}S.provide({yearMonthScrollY:o,scrollYearMonthOpenHeight:m,calendarScrollY:s,calendarOpenHeight:a,today:l.get,showCalendar(){return s.get()!=a()},async calendarClose(){n()&&o.changeTo(m()),s.changeTo(a())},calendarScroll(i,g){if(n()){const u=o.get()+i;u>=m()?(o.set(m()),H()):u<=0?o.set(o.get()+i/3):o.set(u)}else{const u=s.get()+i;u>=a()?(s.set(a()),H()):u<=0?(s.set(0),o.changeDiff(u)):s.set(u)}},calendarFinish(i){n()?te.getFromVelocity(i).distance+o.get()>m()/2?o.changeTo(m(),Y(i)):o.changeTo(0,Y(i)):te.getFromVelocity(i).distance+s.get()>a()/2?s.changeTo(a(),Y(i)):s.changeTo(0,Y(i))}}),c.div({className:"absolute inset-0 flex flex-col select-none touch-none",children(){Be(t),He(t,e),ze(t)}})})}function st(){Ge()}export{st as default};
