import{N as C}from"./index-B26XVUiJ.js";import{stop as D,start as z}from"./Animate-C8Xfpeld.js";function H(){return{scrollingX:!0,scrollingY:!0,animating:!0,animationDuration:250,bouncing:!0,locking:!0,paging:!1,snapping:!1,zooming:!1,minZoom:.5,maxZoom:3,speedMultiplier:1,scrollingComplete:C,decelerationRate:.95,penetrationDeceleration:.03,penetrationAcceleration:.08}}class W{constructor(l,e){this.__callback=l,this.options=Object.assign(H(),e)}options;__zoomComplete=null;__interruptedAnimation=!1;__initialTouchLeft=0;__initialTouchTop=0;__lastScale=0;__enableScrollX=!1;__enableScrollY=!1;__isSingleTouch=!1;__isTracking=!1;__didDecelerationComplete=!1;__isGesturing=!1;__isDragging=!1;__isDecelerating=!1;__isAnimating=!1;__clientLeft=0;__clientTop=0;__clientWidth=0;__clientHeight=0;__contentWidth=0;__contentHeight=0;__snapWidth=100;__snapHeight=100;__refreshHeight=null;__refreshActive=!1;__refreshActivate=null;__refreshDeactivate=null;__refreshStart=null;__zoomLevel=1;__scrollLeft=0;__scrollTop=0;__maxScrollLeft=0;__maxScrollTop=0;__scheduledLeft=0;__scheduledTop=0;__scheduledZoom=0;__lastTouchLeft=0;__lastTouchTop=0;__lastTouchMove=0;__positions=[];setDimensions(l,e,i,_){const o=this;l===+l&&(o.__clientWidth=l),e===+e&&(o.__clientHeight=e),i===+i&&(o.__contentWidth=i),_===+_&&(o.__contentHeight=_),o.__computeScrollMax(),o.scrollTo(o.__scrollLeft,o.__scrollTop,!0)}setPosition(l,e){const i=this;i.__clientLeft=l||0,i.__clientTop=e||0}setSnapSize(l,e){const i=this;i.__snapWidth=l,i.__snapHeight=e}activatePullToRefresh(l,e,i,_){const o=this;o.__refreshHeight=l,o.__refreshActivate=e,o.__refreshDeactivate=i,o.__refreshStart=_}triggerPullToRefresh(){this.__refreshHeight!==null&&this.__publish(this.__scrollLeft,-this.__refreshHeight,this.__zoomLevel,!0),this.__refreshStart?.()}finishPullToRefresh(){const l=this;l.__refreshActive=!1,l.__refreshDeactivate?.(),l.scrollTo(l.__scrollLeft,l.__scrollTop,!0)}getValues(){const l=this;return{left:l.__scrollLeft,top:l.__scrollTop,zoom:l.__zoomLevel}}getScrollMax(){const l=this;return{left:l.__maxScrollLeft,top:l.__maxScrollTop}}zoomTo(l,e,i,_,o){const t=this;if(!t.options.zooming)throw new Error("Zooming is not enabled!");o&&(t.__zoomComplete=o),t.__isDecelerating&&(D(t.__isDecelerating),t.__isDecelerating=!1);const p=t.__zoomLevel;i==null&&(i=t.__clientWidth/2),_==null&&(_=t.__clientHeight/2),l=Math.max(Math.min(l,t.options.maxZoom),t.options.minZoom),t.__computeScrollMax(l);let f=(i+t.__scrollLeft)*l/p-i,r=(_+t.__scrollTop)*l/p-_;f>t.__maxScrollLeft?f=t.__maxScrollLeft:f<0&&(f=0),r>t.__maxScrollTop?r=t.__maxScrollTop:r<0&&(r=0),t.__publish(f,r,l,e)}zoomBy(l,e,i=0,_=0,o){const t=this;t.zoomTo(t.__zoomLevel*l,e,i,_,o)}scrollTo(l,e,i,_){const o=this;if(o.__isDecelerating&&(D(o.__isDecelerating),o.__isDecelerating=!1),_!=null&&_!==o.__zoomLevel){if(!o.options.zooming)throw new Error("Zooming is not enabled!");l*=_,e*=_,o.__computeScrollMax(_)}else _=o.__zoomLevel;o.options.scrollingX?o.options.paging?o.__clientWidth&&(l=Math.round(l/o.__clientWidth)*o.__clientWidth):o.options.snapping&&o.__snapWidth&&(l=Math.round(l/o.__snapWidth)*o.__snapWidth):l=o.__scrollLeft,o.options.scrollingY?o.options.paging?e=Math.round(e/o.__clientHeight)*o.__clientHeight:o.options.snapping&&(e=Math.round(e/o.__snapHeight)*o.__snapHeight):e=o.__scrollTop,l=Math.max(Math.min(o.__maxScrollLeft,l),0),e=Math.max(Math.min(o.__maxScrollTop,e),0),l===o.__scrollLeft&&e===o.__scrollTop&&(i=!1),o.__publish(l,e,_,i)}scrollBy(l,e,i){const _=this,o=_.__isAnimating?_.__scheduledLeft:_.__scrollLeft,t=_.__isAnimating?_.__scheduledTop:_.__scrollTop;_.scrollTo(o+(l||0),t+(e||0),i)}doMouseZoom(l,e,i){const _=this,o=l>0?.97:1.03;return _.zoomTo(_.__zoomLevel*o,!1,e-_.__clientLeft,i-_.__clientTop)}doTouchStart(l,e){if(l.length==null)throw new Error(`Invalid touch list: ${l}`);if(e instanceof Date&&(e=e.valueOf()),typeof e!="number")throw new Error(`Invalid timestamp value: ${e}`);const i=this;i.__interruptedAnimation=!0,i.__isDecelerating&&(D(i.__isDecelerating),i.__isDecelerating=!1,i.__interruptedAnimation=!0),i.__isAnimating&&(D(i.__isAnimating),i.__isAnimating=!1,i.__interruptedAnimation=!0);let _,o;const t=l.length===1;t?(_=l[0].pageX,o=l[0].pageY):(_=Math.abs(l[0].pageX+l[1].pageX)/2,o=Math.abs(l[0].pageY+l[1].pageY)/2),i.__initialTouchLeft=_,i.__initialTouchTop=o,i.__lastTouchLeft=_,i.__lastTouchTop=o,i.__lastTouchMove=e,i.__lastScale=1,i.__enableScrollX=!t&&i.options.scrollingX,i.__enableScrollY=!t&&i.options.scrollingY,i.__isTracking=!0,i.__didDecelerationComplete=!1,i.__isDragging=!t,i.__isSingleTouch=t,i.__positions=[]}doTouchMove(l,e,i){if(l.length==null)throw new Error(`Invalid touch list: ${l}`);if(e instanceof Date&&(e=e.valueOf()),typeof e!="number")throw new Error(`Invalid timestamp value: ${e}`);const _=this;if(!_.__isTracking)return;let o,t;l.length===2?(o=Math.abs(l[0].pageX+l[1].pageX)/2,t=Math.abs(l[0].pageY+l[1].pageY)/2):(o=l[0].pageX,t=l[0].pageY);const p=_.__positions;if(_.__isDragging){const f=o-_.__lastTouchLeft,r=t-_.__lastTouchTop;let s=_.__scrollLeft,c=_.__scrollTop,a=_.__zoomLevel;if(i!=null&&_.options.zooming){const n=a;if(a=a/_.__lastScale*i,a=Math.max(Math.min(a,_.options.maxZoom),_.options.minZoom),n!==a){const m=o-_.__clientLeft,g=t-_.__clientTop;s=(m+s)*a/n-m,c=(g+c)*a/n-g,_.__computeScrollMax(a)}}if(_.__enableScrollX){s-=f*this.options.speedMultiplier;const n=_.__maxScrollLeft;(s>n||s<0)&&(_.options.bouncing?s+=f/2*this.options.speedMultiplier:s>n?s=n:s=0)}if(_.__enableScrollY){c-=r*this.options.speedMultiplier;const n=_.__maxScrollTop;(c>n||c<0)&&(_.options.bouncing?(c+=r/2*this.options.speedMultiplier,!_.__enableScrollX&&_.__refreshHeight!=null&&(!_.__refreshActive&&c<=-_.__refreshHeight?(_.__refreshActive=!0,_.__refreshActivate?.()):_.__refreshActive&&c>-_.__refreshHeight&&(_.__refreshActive=!1,_.__refreshDeactivate?.()))):c>n?c=n:c=0)}p.length>60&&p.splice(0,30),p.push(s,c,e),_.__publish(s,c,a)}else{const f=_.options.locking?3:0,r=5,s=Math.abs(o-_.__initialTouchLeft),c=Math.abs(t-_.__initialTouchTop);_.__enableScrollX=_.options.scrollingX&&s>=f,_.__enableScrollY=_.options.scrollingY&&c>=f,p.push(_.__scrollLeft,_.__scrollTop,e),_.__isDragging=(_.__enableScrollX||_.__enableScrollY)&&(s>=r||c>=r),_.__isDragging&&(_.__interruptedAnimation=!1)}_.__lastTouchLeft=o,_.__lastTouchTop=t,_.__lastTouchMove=e,_.__lastScale=i||1}doTouchEnd(l){if(l instanceof Date&&(l=l.valueOf()),typeof l!="number")throw new Error(`Invalid timestamp value: ${l}`);const e=this;if(e.__isTracking){if(e.__isTracking=!1,e.__isDragging)if(e.__isDragging=!1,e.__isSingleTouch&&e.options.animating&&l-e.__lastTouchMove<=100){const i=e.__positions,_=i.length-1;let o=_;for(let t=_;t>0&&i[t]>e.__lastTouchMove-100;t-=3)o=t;if(o===_&&i.length>5&&(o=2),o!==_){const t=i[_]-i[o],p=e.__scrollLeft-i[o-2],f=e.__scrollTop-i[o-1];let r=p/t*(1e3/60),s=f/t*(1e3/60);const c=e.options.paging||e.options.snapping?4:1;if((Math.abs(r)>c||Math.abs(s)>c)&&!e.__refreshActive){let a=0,n=0,m=0,g=0;if(e.options.paging){const M=Math.max(Math.min(e.__scrollLeft,e.__maxScrollLeft),0),x=Math.max(Math.min(e.__scrollTop,e.__maxScrollTop),0),v=e.__clientWidth,h=e.__clientHeight;a=Math.floor(M/v)*v,n=Math.floor(x/h)*h,m=Math.ceil(M/v)*v,g=Math.ceil(x/h)*h}else a=0,n=0,m=e.__maxScrollLeft,g=e.__maxScrollTop;const S=e.options.snapping?4:.1;e.__isDecelerating=z(function(M,x,v){let h=e.__scrollLeft+r,T=e.__scrollTop+s;if(!e.options.bouncing){const u=Math.max(Math.min(m,h),a);u!==h&&(h=u,r=0);const d=Math.max(Math.min(g,T),n);d!==T&&(T=d,s=0)}if(v?e.__publish(h,T,e.__zoomLevel):(e.__scrollLeft=h,e.__scrollTop=T),!e.options.paging){const u=e.options.decelerationRate;r*=u,s*=u}if(e.options.bouncing){let u=0,d=0;const b=e.options.penetrationDeceleration,A=e.options.penetrationAcceleration;h<a?u=a-h:h>m&&(u=m-h),T<n?d=n-T:T>g&&(d=g-T),u!==0&&(u*r<=0?r+=u*b:r=u*A),d!==0&&(d*s<=0?s+=d*b:s=d*A)}},function(){const M=Math.abs(r)>=S||Math.abs(s)>=S;return M||(e.__didDecelerationComplete=!0),M},function(){e.__isDecelerating=!1,e.__didDecelerationComplete&&e.options.scrollingComplete(),e.scrollTo(e.__scrollLeft,e.__scrollTop,e.options.snapping)})}}else e.options.scrollingComplete()}else l-e.__lastTouchMove>100&&e.options.scrollingComplete();e.__isDecelerating||(e.__refreshActive&&e.__refreshStart?(e.__refreshHeight!==null&&e.__publish(e.__scrollLeft,-e.__refreshHeight,e.__zoomLevel,!0),e.__refreshStart()):((e.__interruptedAnimation||e.__isDragging)&&e.options.scrollingComplete(),e.scrollTo(e.__scrollLeft,e.__scrollTop,!0,e.__zoomLevel),e.__refreshActive&&(e.__refreshActive=!1,e.__refreshDeactivate?.()))),e.__positions.length=0}}__publish(l,e,i,_){const o=this,t=o.__isAnimating;if(t&&(D(t),o.__isAnimating=!1),_&&o.options.animating){o.__scheduledLeft=l,o.__scheduledTop=e,o.__scheduledZoom=i;const p=o.__scrollLeft,f=o.__scrollTop,r=o.__zoomLevel,s=l-p,c=e-f,a=i-r;o.__isAnimating=z(function(n,m,g){g&&(o.__scrollLeft=p+s*n,o.__scrollTop=f+c*n,o.__zoomLevel=r+a*n,o.__callback?.(o.__scrollLeft,o.__scrollTop,o.__zoomLevel))},function(n){return o.__isAnimating===n},function(n,m,g){m===o.__isAnimating&&(o.__isAnimating=!1),(o.__didDecelerationComplete||g)&&o.options.scrollingComplete(),o.options.zooming&&(o.__computeScrollMax(),o.__zoomComplete&&(o.__zoomComplete(),o.__zoomComplete=null))},o.options.animationDuration,t?X:w)}else o.__scheduledLeft=o.__scrollLeft=l,o.__scheduledTop=o.__scrollTop=e,o.__scheduledZoom=o.__zoomLevel=i,o.__callback?.(l,e,i),o.options.zooming&&(o.__computeScrollMax(),o.__zoomComplete&&(o.__zoomComplete(),o.__zoomComplete=null))}__computeScrollMax(l){const e=this;l==null&&(l=e.__zoomLevel),e.__maxScrollLeft=Math.max(e.__contentWidth*l-e.__clientWidth,0),e.__maxScrollTop=Math.max(e.__contentHeight*l-e.__clientHeight,0)}}function X(L){return Math.pow(L-1,3)+1}function w(L){return(L/=.5)<1?.5*Math.pow(L,3):.5*(Math.pow(L-2,3)+2)}export{W as Scroller,w as easeInOutCubic,X as easeOutCubic};
