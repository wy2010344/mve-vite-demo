import{c as R,M as A,Y as h,n as v,N as K,W as Q,O as U,P as Z,x as W,Q as B,h as G,i as J,R as ee,f as a,l as te,T as w,w as ne,U as p,V as D,X as Y,Z as E,_ as re,D as $,$ as y,a0 as se,a1 as ae,a2 as C}from"./index-DQyCy5E-.js";import{c as oe,f as b,h as ie,W as le,S as O,a as ce}from"./index-DkPl-7LE.js";import{e as me}from"./explain-bWo98o89.js";import{a as de}from"./onlyMobile-CStGrFla.js";import{f as fe}from"./fixRightTop-B94B5TPG.js";import{t as ue}from"./themeDropdown-D_KwgWnn.js";import he from"./demoList-DIkLqOxd.js";import{f as ye}from"./chunk-LSEVNFON-G8OzWBoO.js";import"./index-BBRnVKPH.js";import"./iconBase-CeRrWgC7.js";import"./index-BHzW6WMu.js";import"./index-BpkS3HI9.js";const L="select-cell";function We(){me(()=>{}),de(function({width:f},g){g&&fe(function(){oe(),ue()});const s=R(h.fromDate(new Date),A),c=v(r=>{const o=s.get();return new K(o.year,o.month,b.get())}),x=v(()=>{const r=s.get();return Q.from(r.year,r.month,r.day,b.get())}),z=window;z.__date=s;const l=new U("y",{maxScroll(){return k.get()},targetSnap:Z([{beforeForce:1,size:m()*5,afterForce:1}])}),k=l.measureMaxScroll();function m(){return f()/7}const u=v(()=>l.get()>=5*m()),T=W(()=>{const r=m(),o=r*5,e=se(p(s.get()),b.get())-1;return E({0:0,[o]:-r*e},C)}),N=B({direction:"x",getValue:s.get,compare(r,o){const e=p(o).valueOf(),i=p(r).valueOf()-e;let n=0;return i>=Y?n=1:i<=-864e5&&(n=-1),n},callback(r){const o=p(s.get());o.setTime(o.getTime()+r*Y),s.set(h.fromDate(o))}});let S=s.get();G(()=>N.onAnimation(),function(r){r||(S.equals(s.get())||J(()=>{u()?l.animateTo(m()*5):l.animateTo(0)}),S=s.get())});const _=ee({getSize(){return j.clientWidth}});ie(s.get,L);const X=W(()=>{const r=m()*5;return E({0:m()*7,[r]:m()*2},C)}),j=a.div({s_height:"100%",s_overflow:"hidden",s_userSelect:"none",onTouchMove(r){r.preventDefault()},onWheel:l.wheelEventListener,onPointerDown:l.pointerEventListner,children(r){_.hookCompare(x,function(e,t){return u()?e.cells[0].toNumber()-t.cells[0].toNumber():0}),_.hookCompare(c,function(e,t){return u()?0:e.toNumber()-t.toNumber()});const o=a.div({s_transform(){return`translateY(${-l.get()}px)`},className:"flex flex-col",s_minHeight(){return`calc(100% + ${f()}px * 5 / 7)`},children(){a.div({className:"bg-base-100 relative z-10",s_display:"flex",s_alignItems:"stretch",s_transform(){return`translateY(${Math.max(l.get(),0)}px)`},children(){a.h1({className:"text-display-large",childrenType:"text",children(){return s.get().month}}),a.div({className:"flex flex-col items-start justify-center",children(){a.div({className:"text-title-large",childrenType:"text",children(){return s.get().year}}),a.div({className:"text-title-medium",childrenType:"text",children(){return`月 ${s.get().day}日`}})}})}}),a.div({s_zIndex:1,s_position:"relative",s_height(){return m()*7+"px"},children(){a.div({className:"bg-base-300",s_overflow:"hidden",s_height(){const e=l.get();return X(e)+"px"},s_transform(){return`translateY(${Math.max(l.get(),0)}px)`},onPointerDown(e){ne(_.getMoveEvent(e,"x",{callback(t,i){if(u()){const n=p(s.get());n.setTime(n.getTime()+t*le),t&&s.set(h.fromDate(n))}else{const n=t<0?c().lastMonth():c().nextMonth();s.get().day>n.days?s.set(h.from(n.year,n.month,n.days)):s.set(h.from(n.year,n.month,s.get().day))}}}))},children(){a.div({s_position:"relative",s_transform(){return`translateX(${-_.get()}px)`},children(){te(u,function(){w(()=>{const e=x();return[e.beforeWeek(),e,e.nextWeek()]},e=>e.cells[0].toNumber(),function(e,t){q(e(),t)})},function(){w(()=>{const e=c();return[e.lastMonth(),e,e.nextMonth()]},e=>e.toNumber(),function(e,t){H(e(),t)})})}})}})}}),a.div({className:" flex-1",data_a:"99",plugin:N.plugin,children(){a.div({className:"relative",s_transform(){return`translateX(${-N.get()}px)`},children(){w(()=>{const e=s.get();return[e.beforeDay(),e,e.nextDay()]},e=>e.toNumber(),function(e,t){D.div({attrs(i){const n=t();n!=1&&(i.s_position="absolute",i.s_inset=0,i.s_transform=`translateX(${(n-1)*100}%)`)},children(){he(ye.number.int({max:17,min:15}))}})})}})}})}});k.hookInit(r,o)}});function H(r,o){function e(){const t=s.get(),i=r;return t.year==i.year&&t.month==i.month}return D.div({attrs(t){const i=o();if(i==1){const n=l.get();t.s_transform=` translateY(${T(n)}px)`}else t.s_position="absolute",t.s_inset=0,t.s_transform=`translateX(${(i-1)*100}%)`},children(){M(()=>{const t=l.get();return`translateY(${-T(t)}px)`}),a.div({children(){for(let t=0;t<6;t++)a.div({className:"flex items-center justify-center relative",children(){for(let i=0;i<7;i++){const n=r.fullDayOf(i,t);let d=r;n.type=="last"?d=r.lastMonth():n.type=="next"&&(d=r.nextMonth()),I(i,{year:d.year,month:d.month,day:n.day});const F=O.fromYmd(d.year,d.month,n.day).getLunarDay(),P=v(()=>n.type=="this"&&e()&&s.get().day==n.day);V({day:n.day,onClick(){s.set(h.from(d.year,d.month,n.day))},lunarDay:F,selected:P,hide(){return u()?!1:n.type!="this"}})}}})}})}})}function M(r){a.div({className:"bg-base-300 relative z-10",s_display:"flex",s_alignItems:"center",s_justifyContent:"space-between",s_transform:r,children(){for(let o=0;o<7;o++)a.div({className:"flex-1 aspect-square flex items-center justify-center",childrenType:"text",children(){return ce[c().weekDay(o)]}})}})}function q(r,o){D.div({attrs(e){e.className="self-start",o()!=1&&(e.s_position="absolute",e.s_inset=0,e.s_transform=`translateX(${(o()-1)*100}%)`)},children(){M(),a.div({className:"flex items-center justify-center relative",children(){for(let e=0;e<7;e++){const t=r.cells[e];I(e,t);const n=O.fromYmd(t.year,t.month,t.day).getLunarDay();V({hide(){return!1},day:t.day,lunarDay:n,selected(){return ae(t,s.get())},onClick(){s.set(t)}})}}})}})}})}function I(f,g){f==0&&a.div({className:"absolute left-0 text-label-small",childrenType:"text",children(){return re(p(g),b.get())}})}function V({day:f,lunarDay:g,hide:s,selected:c,onClick:x}){a.div({s_flex:1,s_aspectRatio:1,s_display:"flex",s_flexDirection:"column",s_alignItems:"center",s_justifyContent:"center",className(){return s()?y` opacity-30`:""},onClick:x,children(){a.div({s_aspectRatio:1,s_display:"grid",s_placeItems:"center",s_position:"relative",children(){a.div({id(){return c()?L:""},className(){return $(y`absolute inset-0  rounded-full z-0`,c()&&y`bg-primary`)}}),a.span({s_position:"relative",className(){return $(c()?y`text-primary-content`:y`text-base-content`,y`transition-all`)},childrenType:"text",children:f})}}),a.div({s_fontSize:"10px",childrenType:"text",className:"text-neutral-500",children:g.getName()})}})}export{We as default};
