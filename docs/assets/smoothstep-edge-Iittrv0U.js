import{getEdgeCenter as A}from"./general-WKygje1r.js";import{Position as f}from"./types-BBEhAH_j.js";const B={[f.Left]:{x:-1,y:0},[f.Right]:{x:1,y:0},[f.Top]:{x:0,y:-1},[f.Bottom]:{x:0,y:1}},Q=({source:t,sourcePosition:s=f.Bottom,target:e})=>s===f.Left||s===f.Right?t.x<e.x?{x:1,y:0}:{x:-1,y:0}:t.y<e.y?{x:0,y:1}:{x:0,y:-1},R=(t,s)=>Math.sqrt(Math.pow(s.x-t.x,2)+Math.pow(s.y-t.y,2));function q({source:t,sourcePosition:s=f.Bottom,target:e,targetPosition:m=f.Top,center:a,offset:o,stepPosition:r}){const c=B[s],l=B[m],y={x:t.x+c.x*o,y:t.y+c.y*o},n={x:e.x+l.x*o,y:e.y+l.y*o},d=Q({source:y,sourcePosition:s,target:n}),x=d.x!==0?"x":"y",S=d[x];let i=[],p,u;const g={x:0,y:0},h={x:0,y:0},[,,M,G]=A({sourceX:t.x,sourceY:t.y,targetX:e.x,targetY:e.y});if(c[x]*l[x]===-1){x==="x"?(p=a.x??y.x+(n.x-y.x)*r,u=a.y??(y.y+n.y)/2):(p=a.x??(y.x+n.x)/2,u=a.y??y.y+(n.y-y.y)*r);const L=[{x:p,y:y.y},{x:p,y:n.y}],O=[{x:y.x,y:u},{x:n.x,y:u}];c[x]===S?i=x==="x"?L:O:i=x==="x"?O:L}else{const L=[{x:y.x,y:n.y}],O=[{x:n.x,y:y.y}];if(x==="x"?i=c.x===S?O:L:i=c.y===S?L:O,s===m){const $=Math.abs(t[x]-e[x]);if($<=o){const D=Math.min(o-1,o-$);c[x]===S?g[x]=(y[x]>t[x]?-1:1)*D:h[x]=(n[x]>e[x]?-1:1)*D}}if(s!==m){const $=x==="x"?"y":"x",D=c[x]===l[$],Y=y[$]>n[$],b=y[$]<n[$];(c[x]===1&&(!D&&Y||D&&b)||c[x]!==1&&(!D&&b||D&&Y))&&(i=x==="x"?L:O)}const T={x:y.x+g.x,y:y.y+g.y},X={x:n.x+h.x,y:n.y+h.y},w=Math.max(Math.abs(T.x-i[0].x),Math.abs(X.x-i[0].x)),z=Math.max(Math.abs(T.y-i[0].y),Math.abs(X.y-i[0].y));w>=z?(p=(T.x+X.x)/2,u=i[0].y):(p=i[0].x,u=(T.y+X.y)/2)}return[[t,{x:y.x+g.x,y:y.y+g.y},...i,{x:n.x+h.x,y:n.y+h.y},e],p,u,M,G]}function v(t,s,e,m){const a=Math.min(R(t,s)/2,R(s,e)/2,m),{x:o,y:r}=s;if(t.x===o&&o===e.x||t.y===r&&r===e.y)return`L${o} ${r}`;if(t.y===r){const y=t.x<e.x?-1:1,n=t.y<e.y?1:-1;return`L ${o+a*y},${r}Q ${o},${r} ${o},${r+a*n}`}const c=t.x<e.x?1:-1,l=t.y<e.y?-1:1;return`L ${o},${r+a*l}Q ${o},${r} ${o+a*c},${r}`}function F({sourceX:t,sourceY:s,sourcePosition:e=f.Left,targetX:m,targetY:a,targetPosition:o=f.Right,borderRadius:r=5,centerX:c,centerY:l,offset:y=20,stepPosition:n=.5}){const[d,x,S,i,p]=q({source:{x:t,y:s},sourcePosition:e,target:{x:m,y:a},targetPosition:o,center:{x:c,y:l},offset:y,stepPosition:n});return[d.reduce((g,h,M)=>{let G="";return M>0&&M<d.length-1?G=v(d[M-1],h,d[M+1],r):G=`${M===0?"M":"L"}${h.x} ${h.y}`,g+=G,g},""),x,S,i,p]}export{F as getSmoothStepPath};
