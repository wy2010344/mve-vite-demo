import{f as v,_ as D,c,b as T,Q as m,R as b,O as F,T as N,$ as d,w as h,p as A,X as L}from"./index-DvMfoO23.js";import{r as M,h as l}from"./canvasRender-BoWEpDho.js";import{m as P,f as K,a as C,i as E,e as R,d as X,c as _,t as q}from"./forceLayout-9pl5FpRN.js";function O(){const g=v.canvas({width:800,height:800}),o=800,f=D(()=>{const t=Array.from({length:400},(n,s)=>({index:s})),r=[];for(let n=0;n<20;++n)for(let s=0;s<20;++s)n>0&&r.push({source:(n-1)*20+s,target:n*20+s}),s>0&&r.push({source:n*20+(s-1),target:n*20+s});return{nodes:t,links:r}}),y=o,x=c(f.nodes),k=c(f.links),u=c(void 0),i=T(e=>P({nodes:(e==null?void 0:e.nodes)||m,links:(e==null?void 0:e.links)||m,fromLinks:k.get(),fromNodes:x.get(),createForceNode(t,r,n){return E(t,2,r,X,R)},getNodeKey(t){return t.index},getSorceKey(t){return t.source},getTargetKey(t){return t.target},createFromKey(t){return{index:t}}})),a=b(_()),p=K({getStrength:d(1),getDistance:d(20),iterations:10}),w=C({getStrenth:d(-30)});function S(){const e=i();q(a,e.nodes,t=>{p(e.links,a.nDim,t),w(e.nodes,a.nDim,t)})}F(N(()=>{S(),L()})),M(g,function(){h(()=>i().links,e=>{l({x:e.source.x.dSignal.get,y:e.source.y.dSignal.get,withPath:!0,draw(t,r){return r.moveTo(0,0),r.lineTo(e.target.x.d-e.source.x.d,e.target.y.d-e.source.y.d),{operates:[{type:"stroke",style:"#aaa",width:1}]}}})}),h(()=>i().nodes,e=>{l({x:e.x.dSignal.get,y:e.y.dSignal.get,onPointerDown(t){a.alphaTarget=.3,u.set(e),A({onMove(r){e.x.f=r.offsetX-o/2,e.y.f=r.offsetY-y/2},onEnd(r){a.alphaTarget=0,e.x.f=void 0,e.y.f=void 0,u.set(void 0)}},g)},withPath:!0,draw(t,r){return r.arc(0,0,3,0,2*Math.PI),{operates:[{type:"fill",style:"#000"},{type:"draw",callback(n){n.fillText(e.value.index+"",0,0)}}]}}})})},{beforeDraw(e){e.translate(o/2,y/2)}})}export{O as default};
