var B=Object.defineProperty;var X=(p,o,_)=>o in p?B(p,o,{enumerable:!0,configurable:!0,writable:!0,value:_}):p[o]=_;var r=(p,o,_)=>X(p,typeof o!="symbol"?o+"":o,_);import{D as j}from"./index-BdTCZeBf.js";import{stop as w,start as I}from"./Animate-DqEvDsbS.js";function G(){return{scrollingX:!0,scrollingY:!0,animating:!0,animationDuration:250,bouncing:!0,locking:!0,paging:!1,snapping:!1,zooming:!1,minZoom:.5,maxZoom:3,speedMultiplier:1,scrollingComplete:j,decelerationRate:.95,penetrationDeceleration:.03,penetrationAcceleration:.08}}class ${constructor(o,_){r(this,"options");r(this,"__zoomComplete",null);r(this,"__interruptedAnimation",!1);r(this,"__initialTouchLeft",0);r(this,"__initialTouchTop",0);r(this,"__lastScale",0);r(this,"__enableScrollX",!1);r(this,"__enableScrollY",!1);r(this,"__isSingleTouch",!1);r(this,"__isTracking",!1);r(this,"__didDecelerationComplete",!1);r(this,"__isGesturing",!1);r(this,"__isDragging",!1);r(this,"__isDecelerating",!1);r(this,"__isAnimating",!1);r(this,"__clientLeft",0);r(this,"__clientTop",0);r(this,"__clientWidth",0);r(this,"__clientHeight",0);r(this,"__contentWidth",0);r(this,"__contentHeight",0);r(this,"__snapWidth",100);r(this,"__snapHeight",100);r(this,"__refreshHeight",null);r(this,"__refreshActive",!1);r(this,"__refreshActivate",null);r(this,"__refreshDeactivate",null);r(this,"__refreshStart",null);r(this,"__zoomLevel",1);r(this,"__scrollLeft",0);r(this,"__scrollTop",0);r(this,"__maxScrollLeft",0);r(this,"__maxScrollTop",0);r(this,"__scheduledLeft",0);r(this,"__scheduledTop",0);r(this,"__scheduledZoom",0);r(this,"__lastTouchLeft",0);r(this,"__lastTouchTop",0);r(this,"__lastTouchMove",0);r(this,"__positions",[]);this.__callback=o,this.options=Object.assign(G(),_)}setDimensions(o,_,a,i){var e=this;o===+o&&(e.__clientWidth=o),_===+_&&(e.__clientHeight=_),a===+a&&(e.__contentWidth=a),i===+i&&(e.__contentHeight=i),e.__computeScrollMax(),e.scrollTo(e.__scrollLeft,e.__scrollTop,!0)}setPosition(o,_){var a=this;a.__clientLeft=o||0,a.__clientTop=_||0}setSnapSize(o,_){var a=this;a.__snapWidth=o,a.__snapHeight=_}activatePullToRefresh(o,_,a,i){var e=this;e.__refreshHeight=o,e.__refreshActivate=_,e.__refreshDeactivate=a,e.__refreshStart=i}triggerPullToRefresh(){var o;this.__refreshHeight!==null&&this.__publish(this.__scrollLeft,-this.__refreshHeight,this.__zoomLevel,!0),(o=this.__refreshStart)==null||o.call(this)}finishPullToRefresh(){var _;var o=this;o.__refreshActive=!1,(_=o.__refreshDeactivate)==null||_.call(o),o.scrollTo(o.__scrollLeft,o.__scrollTop,!0)}getValues(){var o=this;return{left:o.__scrollLeft,top:o.__scrollTop,zoom:o.__zoomLevel}}getScrollMax(){var o=this;return{left:o.__maxScrollLeft,top:o.__maxScrollTop}}zoomTo(o,_,a,i,e){var l=this;if(!l.options.zooming)throw new Error("Zooming is not enabled!");e&&(l.__zoomComplete=e),l.__isDecelerating&&(w(l.__isDecelerating),l.__isDecelerating=!1);var f=l.__zoomLevel;a==null&&(a=l.__clientWidth/2),i==null&&(i=l.__clientHeight/2),o=Math.max(Math.min(o,l.options.maxZoom),l.options.minZoom),l.__computeScrollMax(o);var h=(a+l.__scrollLeft)*o/f-a,c=(i+l.__scrollTop)*o/f-i;h>l.__maxScrollLeft?h=l.__maxScrollLeft:h<0&&(h=0),c>l.__maxScrollTop?c=l.__maxScrollTop:c<0&&(c=0),l.__publish(h,c,o,_)}zoomBy(o,_,a=0,i=0,e){var l=this;l.zoomTo(l.__zoomLevel*o,_,a,i,e)}scrollTo(o,_,a,i){var e=this;if(e.__isDecelerating&&(w(e.__isDecelerating),e.__isDecelerating=!1),i!=null&&i!==e.__zoomLevel){if(!e.options.zooming)throw new Error("Zooming is not enabled!");o*=i,_*=i,e.__computeScrollMax(i)}else i=e.__zoomLevel;e.options.scrollingX?e.options.paging?e.__clientWidth&&(o=Math.round(o/e.__clientWidth)*e.__clientWidth):e.options.snapping&&e.__snapWidth&&(o=Math.round(o/e.__snapWidth)*e.__snapWidth):o=e.__scrollLeft,e.options.scrollingY?e.options.paging?_=Math.round(_/e.__clientHeight)*e.__clientHeight:e.options.snapping&&(_=Math.round(_/e.__snapHeight)*e.__snapHeight):_=e.__scrollTop,o=Math.max(Math.min(e.__maxScrollLeft,o),0),_=Math.max(Math.min(e.__maxScrollTop,_),0),o===e.__scrollLeft&&_===e.__scrollTop&&(a=!1),e.__publish(o,_,i,a)}scrollBy(o,_,a){var i=this,e=i.__isAnimating?i.__scheduledLeft:i.__scrollLeft,l=i.__isAnimating?i.__scheduledTop:i.__scrollTop;i.scrollTo(e+(o||0),l+(_||0),a)}doMouseZoom(o,_,a){var i=this,e=o>0?.97:1.03;return i.zoomTo(i.__zoomLevel*e,!1,_-i.__clientLeft,a-i.__clientTop)}doTouchStart(o,_){if(o.length==null)throw new Error("Invalid touch list: "+o);if(_ instanceof Date&&(_=_.valueOf()),typeof _!="number")throw new Error("Invalid timestamp value: "+_);var a=this;a.__interruptedAnimation=!0,a.__isDecelerating&&(w(a.__isDecelerating),a.__isDecelerating=!1,a.__interruptedAnimation=!0),a.__isAnimating&&(w(a.__isAnimating),a.__isAnimating=!1,a.__interruptedAnimation=!0);var i,e,l=o.length===1;l?(i=o[0].pageX,e=o[0].pageY):(i=Math.abs(o[0].pageX+o[1].pageX)/2,e=Math.abs(o[0].pageY+o[1].pageY)/2),a.__initialTouchLeft=i,a.__initialTouchTop=e,a.__lastTouchLeft=i,a.__lastTouchTop=e,a.__lastTouchMove=_,a.__lastScale=1,a.__enableScrollX=!l&&a.options.scrollingX,a.__enableScrollY=!l&&a.options.scrollingY,a.__isTracking=!0,a.__didDecelerationComplete=!1,a.__isDragging=!l,a.__isSingleTouch=l,a.__positions=[]}doTouchMove(o,_,a){var d,S;if(o.length==null)throw new Error("Invalid touch list: "+o);if(_ instanceof Date&&(_=_.valueOf()),typeof _!="number")throw new Error("Invalid timestamp value: "+_);var i=this;if(i.__isTracking){var e,l;o.length===2?(e=Math.abs(o[0].pageX+o[1].pageX)/2,l=Math.abs(o[0].pageY+o[1].pageY)/2):(e=o[0].pageX,l=o[0].pageY);var f=i.__positions;if(i.__isDragging){var h=e-i.__lastTouchLeft,c=l-i.__lastTouchTop,n=i.__scrollLeft,t=i.__scrollTop,s=i.__zoomLevel;if(a!=null&&i.options.zooming){var m=s;if(s=s/i.__lastScale*a,s=Math.max(Math.min(s,i.options.maxZoom),i.options.minZoom),m!==s){var g=e-i.__clientLeft,v=l-i.__clientTop;n=(g+n)*s/m-g,t=(v+t)*s/m-v,i.__computeScrollMax(s)}}if(i.__enableScrollX){n-=h*this.options.speedMultiplier;var u=i.__maxScrollLeft;(n>u||n<0)&&(i.options.bouncing?n+=h/2*this.options.speedMultiplier:n>u?n=u:n=0)}if(i.__enableScrollY){t-=c*this.options.speedMultiplier;var T=i.__maxScrollTop;(t>T||t<0)&&(i.options.bouncing?(t+=c/2*this.options.speedMultiplier,!i.__enableScrollX&&i.__refreshHeight!=null&&(!i.__refreshActive&&t<=-i.__refreshHeight?(i.__refreshActive=!0,(d=i.__refreshActivate)==null||d.call(i)):i.__refreshActive&&t>-i.__refreshHeight&&(i.__refreshActive=!1,(S=i.__refreshDeactivate)==null||S.call(i)))):t>T?t=T:t=0)}f.length>60&&f.splice(0,30),f.push(n,t,_),i.__publish(n,t,s)}else{var C=i.options.locking?3:0,b=5,D=Math.abs(e-i.__initialTouchLeft),x=Math.abs(l-i.__initialTouchTop);i.__enableScrollX=i.options.scrollingX&&D>=C,i.__enableScrollY=i.options.scrollingY&&x>=C,f.push(i.__scrollLeft,i.__scrollTop,_),i.__isDragging=(i.__enableScrollX||i.__enableScrollY)&&(D>=b||x>=b),i.__isDragging&&(i.__interruptedAnimation=!1)}i.__lastTouchLeft=e,i.__lastTouchTop=l,i.__lastTouchMove=_,i.__lastScale=a||1}}doTouchEnd(o){var C;if(o instanceof Date&&(o=o.valueOf()),typeof o!="number")throw new Error("Invalid timestamp value: "+o);var _=this;if(_.__isTracking){if(_.__isTracking=!1,_.__isDragging)if(_.__isDragging=!1,_.__isSingleTouch&&_.options.animating&&o-_.__lastTouchMove<=100){for(var a=_.__positions,i=a.length-1,e=i,l=i;l>0&&a[l]>_.__lastTouchMove-100;l-=3)e=l;if(e===i&&a.length>5&&(e=2),e!==i){var f=a[i]-a[e],h=_.__scrollLeft-a[e-2],c=_.__scrollTop-a[e-1],n=h/f*(1e3/60),t=c/f*(1e3/60),s=_.options.paging||_.options.snapping?4:1;if((Math.abs(n)>s||Math.abs(t)>s)&&!_.__refreshActive){let b=0,D=0,x=0,d=0;if(_.options.paging){var m=Math.max(Math.min(_.__scrollLeft,_.__maxScrollLeft),0),g=Math.max(Math.min(_.__scrollTop,_.__maxScrollTop),0),v=_.__clientWidth,u=_.__clientHeight;b=Math.floor(m/v)*v,D=Math.floor(g/u)*u,x=Math.ceil(m/v)*v,d=Math.ceil(g/u)*u}else b=0,D=0,x=_.__maxScrollLeft,d=_.__maxScrollTop;var T=_.options.snapping?4:.1;_.__isDecelerating=I(function(S,J,R){var M=_.__scrollLeft+n,L=_.__scrollTop+t;if(!_.options.bouncing){var H=Math.max(Math.min(x,M),b);H!==M&&(M=H,n=0);var Z=Math.max(Math.min(d,L),D);Z!==L&&(L=Z,t=0)}if(R?_.__publish(M,L,_.__zoomLevel):(_.__scrollLeft=M,_.__scrollTop=L),!_.options.paging){var W=_.options.decelerationRate;n*=W,t*=W}if(_.options.bouncing){var A=0,z=0,E=_.options.penetrationDeceleration,k=_.options.penetrationAcceleration;M<b?A=b-M:M>x&&(A=x-M),L<D?z=D-L:L>d&&(z=d-L),A!==0&&(A*n<=0?n+=A*E:n=A*k),z!==0&&(z*t<=0?t+=z*E:t=z*k)}},function(){var S=Math.abs(n)>=T||Math.abs(t)>=T;return S||(_.__didDecelerationComplete=!0),S},function(){_.__isDecelerating=!1,_.__didDecelerationComplete&&_.options.scrollingComplete(),_.scrollTo(_.__scrollLeft,_.__scrollTop,_.options.snapping)})}}else _.options.scrollingComplete()}else o-_.__lastTouchMove>100&&_.options.scrollingComplete();_.__isDecelerating||(_.__refreshActive&&_.__refreshStart?(_.__refreshHeight!==null&&_.__publish(_.__scrollLeft,-_.__refreshHeight,_.__zoomLevel,!0),_.__refreshStart()):((_.__interruptedAnimation||_.__isDragging)&&_.options.scrollingComplete(),_.scrollTo(_.__scrollLeft,_.__scrollTop,!0,_.__zoomLevel),_.__refreshActive&&(_.__refreshActive=!1,(C=_.__refreshDeactivate)==null||C.call(_)))),_.__positions.length=0}}__publish(o,_,a,i){var m;var e=this,l=e.__isAnimating;if(l&&(w(l),e.__isAnimating=!1),i&&e.options.animating){e.__scheduledLeft=o,e.__scheduledTop=_,e.__scheduledZoom=a;var f=e.__scrollLeft,h=e.__scrollTop,c=e.__zoomLevel,n=o-f,t=_-h,s=a-c;e.__isAnimating=I(function(g,v,u){var T;u&&(e.__scrollLeft=f+n*g,e.__scrollTop=h+t*g,e.__zoomLevel=c+s*g,(T=e.__callback)==null||T.call(e,e.__scrollLeft,e.__scrollTop,e.__zoomLevel))},function(g){return e.__isAnimating===g},function(g,v,u){v===e.__isAnimating&&(e.__isAnimating=!1),(e.__didDecelerationComplete||u)&&e.options.scrollingComplete(),e.options.zooming&&(e.__computeScrollMax(),e.__zoomComplete&&(e.__zoomComplete(),e.__zoomComplete=null))},e.options.animationDuration,l?Y:q)}else e.__scheduledLeft=e.__scrollLeft=o,e.__scheduledTop=e.__scrollTop=_,e.__scheduledZoom=e.__zoomLevel=a,(m=e.__callback)==null||m.call(e,o,_,a),e.options.zooming&&(e.__computeScrollMax(),e.__zoomComplete&&(e.__zoomComplete(),e.__zoomComplete=null))}__computeScrollMax(o){var _=this;o==null&&(o=_.__zoomLevel),_.__maxScrollLeft=Math.max(_.__contentWidth*o-_.__clientWidth,0),_.__maxScrollTop=Math.max(_.__contentHeight*o-_.__clientHeight,0)}}function Y(p){return Math.pow(p-1,3)+1}function q(p){return(p/=.5)<1?.5*Math.pow(p,3):.5*(Math.pow(p-2,3)+2)}export{$ as Scroller,q as easeInOutCubic,Y as easeOutCubic};
