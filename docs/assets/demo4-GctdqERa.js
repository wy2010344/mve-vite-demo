import{f as b,X as D,c as d,m as T,I as m,O as F,M as l,Q as N,_ as A,Z as g,o as h,U as L}from"./index-BS7P0FCu.js";import{r as M,h as x}from"./canvasRender-DBtyO6_b.js";import{m as P,f as K,a as C,i as I,e as X,d as _,c as q,t as z}from"./forceLayout-I2AzdGr7.js";function Q(){const f=b.canvas({width:800,height:800}),a=800,u=D(()=>{const t=Array.from({length:400},(r,s)=>({index:s})),n=[];for(let r=0;r<20;++r)for(let s=0;s<20;++s)r>0&&n.push({source:(r-1)*20+s,target:r*20+s}),s>0&&n.push({source:r*20+(s-1),target:r*20+s});return{nodes:t,links:n}}),y=a,k=d(u.nodes),p=d(u.links),i=d(void 0),c=T(e=>P({nodes:(e==null?void 0:e.nodes)||m,links:(e==null?void 0:e.links)||m,fromLinks:p.get(),fromNodes:k.get(),createForceNode(t,n,r){return I(t,2,n,_,X)},getNodeKey(t){return t.index},getSorceKey(t){return t.source},getTargetKey(t){return t.target},createFromKey(t){return{index:t}}})),o=F(q()),S=K({getStrength:g(1),getDistance:g(20),iterations:10}),w=C({getStrenth:g(-30)});function v(){const e=c();z(o,e.nodes,t=>{S(e.links,o.nDim,t),w(e.nodes,o.nDim,t)})}l(N(()=>{v(),L()})),l(A(function(e,t){const n=i.get();n&&(t?(o.alphaTarget=0,n.x.f=void 0,n.y.f=void 0,i.set(void 0)):(n.x.f=e.offsetX-a/2,n.y.f=e.offsetY-y/2))},"pointer",{element:f})),M(f,function(){h(()=>c().links,e=>{x({x:e.source.x.dSignal.get,y:e.source.y.dSignal.get,withPath:!0,draw(t,n){return n.moveTo(0,0),n.lineTo(e.target.x.d-e.source.x.d,e.target.y.d-e.source.y.d),{operates:[{type:"stroke",style:"#aaa",width:1}]}}})}),h(()=>c().nodes,e=>{x({x:e.x.dSignal.get,y:e.y.dSignal.get,onPointerDown(t){o.alphaTarget=.3,i.set(e)},withPath:!0,draw(t,n){return n.arc(0,0,3,0,2*Math.PI),{operates:[{type:"fill",style:"#000"},{type:"draw",callback(r){r.fillText(e.value.index+"",0,0)}}]}}})})},{beforeDraw(e){e.translate(a/2,y/2)}})}export{Q as default};
