import{c as P,W as K,Y as h,A as v,X as R,Z as G,_ as Z,$ as B,I as W,a0 as J,d as Q,i as U,a1 as ee,f as s,o as te,n as w,G as ne,a2 as p,a3 as D,a4 as Y,a5 as E,a6 as re,N as $,a7 as y,a8 as ae,a9 as se,aa as C}from"./index-CnmbM-dR.js";import{c as oe,f as b,h as ie,W as le,S as I,a as ce}from"./index-DbV9IpBF.js";import{e as me}from"./explain-CTdESBeJ.js";import{a as de}from"./onlyMobile-C_GUAbBU.js";import{f as fe}from"./fixRightTop-DFFgMxfW.js";import{t as ue}from"./themeDropdown-BoeznTO2.js";import he from"./demoList-reCZcPuJ.js";import{f as ye}from"./chunk-LSEVNFON-G8OzWBoO.js";import"./index-DjZGZQsH.js";import"./iconBase-BXAUkN_4.js";import"./index-BHzW6WMu.js";import"./index-Rs9A57Tm.js";const V="select-cell";function We(){me(()=>{}),de(function({width:f},g){g&&fe(function(){oe(),ue()});const a=P(h.fromDate(new Date),K),c=v(r=>{const o=a.get();return new R(o.year,o.month,b.get())}),x=v(()=>{const r=a.get();return G.from(r.year,r.month,r.day,b.get())}),z=window;z.__date=a;const l=new Z("y",{maxScroll(){return k.get()},targetSnap:B([{beforeForce:1,size:m()*5,afterForce:1}])}),k=l.measureMaxScroll();function m(){return f()/7}const u=v(()=>l.get()>=5*m()),S=W(()=>{const r=m(),o=r*5,e=ae(p(a.get()),b.get())-1;return E({0:0,[o]:-r*e},C)}),N=J({direction:"x",getValue:a.get,compare(r,o){const e=p(o).valueOf(),i=p(r).valueOf()-e;let n=0;return i>=Y?n=1:i<=-864e5&&(n=-1),n},callback(r){const o=p(a.get());o.setTime(o.getTime()+r*Y),a.set(h.fromDate(o))}});let T=a.get();Q(()=>N.onAnimation(),function(r){r||(T.equals(a.get())||U(()=>{u()?l.animateTo(m()*5):l.animateTo(0)}),T=a.get())});const _=ee({getSize(){return j.clientWidth}});ie(a.get,V);const X=W(()=>{const r=m()*5;return E({0:m()*7,[r]:m()*2},C)}),j=s.div({s_height:"100%",s_overflow:"hidden",s_userSelect:"none",onTouchMove(r){r.preventDefault()},onWheel:l.wheelEventListener,onPointerDown:l.pointerEventListner,children(r){_.hookCompare(x,function(e,t){return u()?e.cells[0].toNumber()-t.cells[0].toNumber():0}),_.hookCompare(c,function(e,t){return u()?0:e.toNumber()-t.toNumber()});const o=s.div({s_transform(){return`translateY(${-l.get()}px)`},className:"flex flex-col",s_minHeight(){return`calc(100% + ${f()}px * 5 / 7)`},children(){s.div({className:"bg-base-100 relative z-10",s_display:"flex",s_alignItems:"stretch",s_transform(){return`translateY(${Math.max(l.get(),0)}px)`},children(){s.h1({className:"text-display-large",childrenType:"text",children(){return a.get().month}}),s.div({className:"flex flex-col items-start justify-center",children(){s.div({className:"text-title-large",childrenType:"text",children(){return a.get().year}}),s.div({className:"text-title-medium",childrenType:"text",children(){return`月 ${a.get().day}日`}})}})}}),s.div({s_zIndex:1,s_position:"relative",s_height(){return m()*7+"px"},children(){s.div({className:"bg-base-300",s_overflow:"hidden",s_height(){const e=l.get();return X(e)+"px"},s_transform(){return`translateY(${Math.max(l.get(),0)}px)`},onPointerDown(e){ne(_.getMoveEvent(e,"x",{callback(t,i){if(u()){const n=p(a.get());n.setTime(n.getTime()+t*le),t&&a.set(h.fromDate(n))}else{const n=t<0?c().lastMonth():c().nextMonth();a.get().day>n.days?a.set(h.from(n.year,n.month,n.days)):a.set(h.from(n.year,n.month,a.get().day))}}}))},children(){s.div({s_position:"relative",s_transform(){return`translateX(${-_.get()}px)`},children(){te(u,function(){w(()=>{const e=x();return[e.beforeWeek(),e,e.nextWeek()]},e=>e.cells[0].toNumber(),function(e,t){q(e(),t)})},function(){w(()=>{const e=c();return[e.lastMonth(),e,e.nextMonth()]},e=>e.toNumber(),function(e,t){H(e(),t)})})}})}})}}),s.div({className:" flex-1",data_a:"99",plugin:N.plugin,children(){s.div({className:"relative",s_transform(){return`translateX(${-N.get()}px)`},children(){w(()=>{const e=a.get();return[e.beforeDay(),e,e.nextDay()]},e=>e.toNumber(),function(e,t){D.div({attrs(i){const n=t();n!=1&&(i.s_position="absolute",i.s_inset=0,i.s_transform=`translateX(${(n-1)*100}%)`)},children(){he(ye.number.int({max:17,min:15}))}})})}})}})}});k.hookInit(r,o)}});function H(r,o){function e(){const t=a.get(),i=r;return t.year==i.year&&t.month==i.month}return D.div({attrs(t){const i=o();if(i==1){const n=l.get();t.s_transform=` translateY(${S(n)}px)`}else t.s_position="absolute",t.s_inset=0,t.s_transform=`translateX(${(i-1)*100}%)`},children(){M(()=>{const t=l.get();return`translateY(${-S(t)}px)`}),s.div({children(){for(let t=0;t<6;t++)s.div({className:"flex items-center justify-center relative",children(){for(let i=0;i<7;i++){const n=r.fullDayOf(i,t);let d=r;n.type=="last"?d=r.lastMonth():n.type=="next"&&(d=r.nextMonth()),O(i,{year:d.year,month:d.month,day:n.day});const F=I.fromYmd(d.year,d.month,n.day).getLunarDay(),A=v(()=>n.type=="this"&&e()&&a.get().day==n.day);L({day:n.day,onClick(){a.set(h.from(d.year,d.month,n.day))},lunarDay:F,selected:A,hide(){return u()?!1:n.type!="this"}})}}})}})}})}function M(r){s.div({className:"bg-base-300 relative z-10",s_display:"flex",s_alignItems:"center",s_justifyContent:"space-between",s_transform:r,children(){for(let o=0;o<7;o++)s.div({className:"flex-1 aspect-square flex items-center justify-center",childrenType:"text",children(){return ce[c().weekDay(o)]}})}})}function q(r,o){D.div({attrs(e){e.className="self-start",o()!=1&&(e.s_position="absolute",e.s_inset=0,e.s_transform=`translateX(${(o()-1)*100}%)`)},children(){M(),s.div({className:"flex items-center justify-center relative",children(){for(let e=0;e<7;e++){const t=r.cells[e];O(e,t);const n=I.fromYmd(t.year,t.month,t.day).getLunarDay();L({hide(){return!1},day:t.day,lunarDay:n,selected(){return se(t,a.get())},onClick(){a.set(t)}})}}})}})}})}function O(f,g){f==0&&s.div({className:"absolute left-0 text-label-small",childrenType:"text",children(){return re(p(g),b.get())}})}function L({day:f,lunarDay:g,hide:a,selected:c,onClick:x}){s.div({s_flex:1,s_aspectRatio:1,s_display:"flex",s_flexDirection:"column",s_alignItems:"center",s_justifyContent:"center",className(){return a()?y` opacity-30`:""},onClick:x,children(){s.div({s_aspectRatio:1,s_display:"grid",s_placeItems:"center",s_position:"relative",children(){s.div({id(){return c()?V:""},className(){return $(y`absolute inset-0  rounded-full z-0`,c()&&y`bg-primary`)}}),s.span({s_position:"relative",className(){return $(c()?y`text-primary-content`:y`text-base-content`,y`transition-all`)},childrenType:"text",children:f})}}),s.div({s_fontSize:"10px",childrenType:"text",className:"text-neutral-500",children:g.getName()})}})}export{We as default};
