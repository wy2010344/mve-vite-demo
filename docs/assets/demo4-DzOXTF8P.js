import{r as D,h as y}from"./canvasRender-DvO4PmED.js";import{X as b,c as u,b as F,O as m,P as N,Z as d,M as T,Q as h,R as w,u as l,p as A}from"./index-DLvyNe9j.js";import{m as L,i as M,e as P,d as K,c as C,f as E,a as R,t as X}from"./forceLayout-fJXyqvqW.js";import{r as q}from"./onlyMobile-CFqX_MEt.js";function Q(){q(function({width:a,height:i}){const f=b(()=>{const e=Array.from({length:400},(r,n)=>({index:n})),s=[];for(let r=0;r<20;++r)for(let n=0;n<20;++n)r>0&&s.push({source:(r-1)*20+n,target:r*20+n}),n>0&&s.push({source:r*20+(n-1),target:r*20+n});return{nodes:e,links:s}}),x=u(f.nodes),p=u(f.links),g=u(void 0),c=F(t=>L({nodes:(t==null?void 0:t.nodes)||m,links:(t==null?void 0:t.links)||m,fromLinks:p.get(),fromNodes:x.get(),createForceNode(e,s,r){return M(e,2,s,K,P)},getNodeKey(e){return e.index},getSorceKey(e){return e.source},getTargetKey(e){return e.target},createFromKey(e){return{index:e}}})),o=N(C()),k=E({getStrength:d(1),getDistance:d(20),iterations:10}),S=R({getStrenth:d(-30)});function v(){const t=c();X(o,t.nodes,e=>{k(t.links,o.nDim,e),S(t.nodes,o.nDim,e)})}T(h(()=>{v(),w()})),D({className:"touch-none",width:a,height:i},function({canvas:t}){l(()=>c().links,e=>{y({x(){return e.source.x.dSignal.get()+a()/2},y(){return e.source.y.dSignal.get()+i()/2},withPath:!0,draw(s,r){return r.moveTo(0,0),r.lineTo(e.target.x.d-e.source.x.d,e.target.y.d-e.source.y.d),{operates:[{type:"stroke",style:"#aaa",width:1}]}}})}),l(()=>c().nodes,e=>{y({x(){return e.x.dSignal.get()+a()/2},y(){return e.y.dSignal.get()+i()/2},onPointerDown(s){o.alphaTarget=.3,g.set(e),A({onMove(r){e.x.f=r.offsetX-a()/2,e.y.f=r.offsetY-i()/2},onEnd(r){o.alphaTarget=0,e.x.f=void 0,e.y.f=void 0,g.set(void 0)}},t)},withPath:!0,draw(s,r){return r.arc(0,0,6,0,2*Math.PI),{operates:[{type:"fill",style:"#000"},{type:"draw",callback(n){n.fillText(e.value.index+"",3,-3)}}]}}})})},{beforeDraw(t){}})})}export{Q as default};
