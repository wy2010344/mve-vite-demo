import{m as I,c as x,ba as t}from"./index-DSI5ljsY.js";import{TaskContext as N,ColumnContext as k,priorityTypes as T}from"./type-Br6O3an9.js";import{L as h,t as D}from"./task-DFvIcSD4.js";import{HookRender as A,ArrayRender as C,If as S}from"./xmlRender-BgpaoUYS.js";import{r as w}from"./mve-icon-D9JGJcPo.js";import F from"./indicator-C_43G5if.js";import{f}from"./chunk-LSEVNFON-G8OzWBoO.js";import"./iconBase-C0LW6USm.js";function B({title:y,type:i}){const{dragId:b,tasks:n}=N.consume(),g=I(function(){return n.get().filter(e=>e.type==i)}),d=x(void 0);k.provide({type:i,getActive:d.get});function p(e){var s;const o=Array.from(document.querySelectorAll(`[data-column="${i}"]`)),r=100,a=(s=o.reduce((l,v)=>{const E=v.getBoundingClientRect(),u=e-(E.top+r/2);return u<0&&u>l.offset?{offset:u,element:v}:l},{offset:Number.NEGATIVE_INFINITY,element:o.at(-1)}).element)==null?void 0:s.dataset.before;return d.get()!=a&&d.set(a),a}return t.createElement("div",{className:"daisy-card bg-base-200 w-80 h-fit"},t.createElement("div",{className:"daisy-card-body p-4"},t.createElement("div",{className:"flex items-center justify-between mb-4"},t.createElement("div",{className:"flex items-center gap-2"},t.createElement("h3",{className:"daisy-card-title text-sm font-medium"},y),t.createElement("div",{className:"daisy-badge daisy-badge-neutral daisy-badge-sm"},()=>g().length)),t.createElement("button",{className:"daisy-btn daisy-btn-ghost daisy-btn-sm daisy-btn-circle",onClick:()=>{n.set(n.get().concat({type:i,id:Date.now()+"",title:f.book.title(),description:f.book.series(),priority:T[f.number.int({min:0,max:2})],assignee:f.book.author(),dueDate:"2024-01-15"}))}},t.createElement(A,{render:()=>{h(w,"24px")}}))),t.createElement("div",{className:"space-y-3 min-h-[200px]",onDragOver:e=>{e.preventDefault(),e.dataTransfer.dropEffect="move",p(e.clientY)},onDragLeave:e=>{d.set(void 0)},onDrop:e=>{const o=p(e.clientY),r=b.get();if(o!=r){const c=n.get().find(s=>s.id==r),a=c.type==i?c:{...c,type:i},m=n.get().filter(s=>s.id!=r);if(o=="")m.push(a);else{const s=m.findIndex(l=>l.id==o);m.splice(s,0,a)}n.set(m)}d.set(void 0)}},t.createElement(C,{getArray:g,getKey:e=>e.id,render:function(e,o,r){D({getTask:e,onDelete(c){n.set(n.get().filter(a=>a.id!=r))},onDragStart(c){b.set(r)}})}}),t.createElement(F,null),t.createElement(S,{condition:()=>g().length,whenTrue:()=>{t.renderChild(t.createElement("div",{className:"text-center text-base-content/50 text-sm py-8"},"拖拽任务到这里或点击 + 添加新任务"))}}))))}export{B as default};
