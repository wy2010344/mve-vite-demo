import{x as Q,f as a,m as k,z as oe,w,b as v,t as ae,a as F,Y as b,B as ie,y as _,G as $,a0 as ce,k as le,W as fe,q as C,l as T,n as D,u as E,v as U,a1 as de,N as he,e as me,a2 as N,A as V,F as M,C as Z,S as I,H,o as ee,J as O,K as ue,D as W,c as A,a3 as ge,a4 as ye,Q as L,a5 as z,a6 as xe,a7 as pe,j as R,L as be}from"./index-B2-PbFlA.js";import{r as ve}from"./onlyMobile-WNpDr5OR.js";import{f as Ne,a as we}from"./themeDropdown-4OoHWP5q.js";import{W as De,a as P,S as Te,h as Me,m as te,b as Se,d as Ce,f as Ye,g as Y}from"./demoList-0ckavyUu.js";import{G as ke}from"./iconBase-DadiGZ5T.js";import{a as X}from"./animate.es-CuPzepd-.js";import{f as _e}from"./chunk-LSEVNFON-G8OzWBoO.js";const ne="select-cell";function Pe(n,m,d,g,i){function s(){return i()/7}function c(){const l=g.get(),t=n;return l.year==t.year&&l.month==t.month}Q.div({attrs(l){const t=m();t==1||(l.s_position="absolute",l.s_inset=0,l.s_transform=`translateX(${(t-1)*100}%)`)},children(){a.div({className:"flex bg-base-100 z-10 relative",children(){for(let e=0;e<7;e++)a.div({className:"flex-1 aspect-square flex items-center justify-center text-base-content",childrenType:"text",children(){return De[n.weekDay(e)]}})}});const l=k(()=>{const e=s(),o=e*5,r=ie(w(g.get()),P.get())-1;return _({0:0,[o]:e*r},$)}),t=k(()=>{const e=s()*5;return _({0:s()*5,[e]:s()},$)});a.div({className:"overflow-hidden bg-base-200 relative",s_height(){const e=d.get();return t(e)+"px"},children(){a.div({s_height(){return s()*6+"px"},s_transform(){const e=Math.max(d.get(),0);return`translateY(${-l(e)}px)`},children(){for(let e=0;e<6;e++)a.div({className:"flex items-center justify-center relative",children(){for(let o=0;o<7;o++){const r=n.fullDayOf(o,e);let h=n;r.type=="last"?h=n.lastMonth():r.type=="next"&&(h=n.nextMonth()),o==0&&a.div({className:"absolute left-0 text-label-small",childrenType:"text",children(){return oe(w({year:h.year,month:h.month,day:r.day}),P.get())}});const y=Te.fromYmd(h.year,h.month,r.day).getLunarDay(),f=v(()=>r.type=="this"&&c()&&g.get().day==r.day);a.div({className(){return F(`flex-1 aspect-square cursor-pointer
                        flex flex-col items-center justify-center gap-1 `,r.type!="this"&&"opacity-30")},onClick(){g.set(b.from(h.year,h.month,r.day))},children(){a.div({className:"flex items-center justify-center relative aspect-square p-1",children(){ae(f,()=>{a.div({id:ne,className(){return F("absolute inset-0 ring-1 rounded-full ring-accent")}})}),a.span({className:"relative text-base-content/80  text-label-large",childrenType:"text",children:r.day})}}),a.div({className:"text-label-small  text-base-content/60",childrenType:"text",children:y.getName()})}})}}})}})}})}})}const j=ce(void 0);function je(n,m){return ke({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{fill:"none",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"m112 160-64 64 64 64"},child:[]},{tag:"path",attr:{fill:"none",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"M64 224h294c58.76 0 106 49.33 106 108v20"},child:[]}]},n,m)}const Fe=M.get();function $e(n,m){const{calendarScrollY:d,calendarClose:g,showCalendar:i,calendarScroll:s,calendarFinish:c,today:l}=j.consume();Me(n.get,ne);const t=v(o=>{const r=n.get();return new le(r.year,r.month,P.get())}),e=v(()=>{const o=n.get();return fe.from(o.year,o.month,o.day,P.get())});a.div({className:"relative",onPointerDown:C(function(o,r){if(r=="y")return I.from(o,{getPage:H,scrollDelta(h,u){s(h,u)},onFinish(h){c(h)}})}),children(){const o=T(0);D(v(y=>{const f=t();if(y&&i()){const x=Math.sign(f.toNumber()-y.toNumber());x&&r.changePage(x)}return f})),D(v(y=>{const f=e();if(y&&!i()){const x=Math.sign(f.cells[0].toNumber()-y.cells[0].toNumber());x&&r.changePage(x)}return f}));const r=te(o,h);function h(){return u.clientWidth}const u=a.div({className:"overflow-hidden  bg-base-300 touch-none",onPointerDown:C(function(y,f){if(f=="x")return r.pointerDown(y,Fe,x=>{if(i()){const p=x<0?t().lastMonth():t().nextMonth();n.get().day>p.days?n.set(b.from(p.year,p.month,p.days)):n.set(b.from(p.year,p.month,n.get().day))}else{const p=w(n.get());p.setTime(p.getTime()+x*Se),x&&n.set(b.fromDate(p))}})}),children(){a.div({className:"relative",s_transform(){return`translateX(${-o.get()}px)`},children(){E(U(()=>{const y=t();return[y.lastMonth(),y,y.nextMonth()]},Z),function(y,f){Pe(y,f,d,n,m)})}})}});a.div({className:"w-full h-11 flex justify-between items-center [padding-inline:18px] bg-base-100 z-10",children(){a.div({className:"flex items-center gap-1",children(){const y=de(()=>{const f=l().toNumber(),x=n.get().toNumber();return f!=x?[1]:he});E(y,function(f){const x=a.button({className:"daisy-btn daisy-btn-xs daisy-btn-circle",onClick(){n.set(l())},children(){je()}});D((p=me)=>{const S=f.step(),se=l().toNumber(),re=n.get().toNumber(),q=Math.sign(re-se);return S==p.step&&q==p.dir?p:{step:S,dir:q}},function({step:p,dir:S}){p=="enter"?X(x,{rotateY:S>0?[90,0]:[90,180]}).finished.then(f.resolve):p=="exiting"&&X(x,{rotateY:S>0?[0,90]:[180,90]}).finished.then(f.resolve)})}),a.h1({className(){const f=l(),x=n.get();return F("text-2xl text-base-content font-bold",f.equals(x)?"text-2xl":f.year==x.year?"text-xl":"text-lg",d.onAnimation()?V`cursor-not-allowed`:V`cursor-pointer`)},childrenType:"text",children(){const f=n.get();return l().year!=f.year?`${f.year}-${N(f.month,2)}-${N(f.day,2)}`:`${N(f.month,2)}-${N(f.day,2)}`},onClick(){d.onAnimation()||(i()?g():d.changeTo(0))}})}}),a.div({className:"text-base-content",children(){a.span({className:"mr-[0.125em] text-2xl",childrenType:"text",children:"¥"}),a.span({className:"text-2xl",childrenType:"text",children:"23"}),a.sup({className:"opacity-50 text-[0.75em] -top-[0.75em]",childrenType:"text",children:".00"})}})}})}})}const B=-50,Ee=M.get(),Oe=M.get(.005);function We(n,m){const{showCalendar:d,calendarFinish:g,calendarScroll:i}=j.consume(),s=T(0);D(m,function(t){!t&&n()!=1&&ee(()=>{s.set(0)})});let c;const l=Q.div({attrs(t){const e=n();t.className="absolute inset-0 select-none bg-base-100 overflow-hidden",e!=1&&(t.s_position="absolute",t.s_inset=0,t.s_transform=`translateX(${(e-1)*100}%)`)},onTouchMove(t){t.preventDefault()},onPointerDown:C(function(t,e){if(e=="y")return I.from(t,{getPage:H,scrollDelta(o,r){if(d())i(o,r);else{const h=s.get();s.set(h+ue(h,o,l.clientHeight,c.offsetHeight))}},onFinish(o){d()?g(o):(s.get()<=B&&console.log("新建"),Ee.destinationWithMarginIscroll({velocity:o,scroll:s,containerSize:l.clientHeight,contentSize:c.offsetHeight,edgeBackConfig:O,edgeConfig(r){return Oe.getFromVelocity(r).animationConfig("in")}}))}})}),children(){const t=k(()=>_({0:0,[B]:G.length-1},$));a.div({childrenType:"text",className:"absolute w-full flex justify-center",s_transform(){return`translateY(calc(${-s.get()}px - 100%))`},children(){const e=Math.round(t(s.get()));return G[e]}}),c=a.div({s_transform(){return`translateY(${-s.get()}px)`},className:"flex flex-col",s_minHeight:"100%",children(){Ce(_e.number.int({min:1,max:18}))}})}})}const G=["新...","新增...","新增一...","新增一条...","新增一条记...","新增一条记录"],Ae=M.get();function Le(n){function m(){return i.clientWidth}const d=T(0),g=te(d,m);D(v(s=>{const c=n.get();if(s){const l=w(s).valueOf(),e=w(c).valueOf()-l;let o=0;e>=W?o=1:e<=-864e5&&(o=-1),o&&g.changePage(o)}return c}));const i=a.div({className:"flex-1 overflow-hidden",onPointerDown:C(function(s,c){if(c=="x")return g.pointerDown(s,Ae,l=>{const t=w(n.get());t.setTime(t.getTime()+l*W),l&&n.set(b.fromDate(t))})}),children(){a.div({className:"h-full",s_transform(){return`translateX(${-d.get()}px)`},children(){E(U(()=>{const s=n.get();return[s.beforeDay(),s,s.nextDay()]},Z),function(s,c){We(c,()=>d.onAnimation())})}})}})}const Ie=M.get(.007);function K({height:n,cellHeight:m,renderCell:d,value:g,realTimeValue:i=A(g.get()),format:s=ye}){const c=T(0);function l(e){i.set(s(i.get()+e))}function t(){const e=Math.floor(c.get()/m);e&&(c.silentDiff(-e*m),l(e),L())}return D(g.get,function(e){const o=e-i.get();o&&ee(()=>{const r=o*m;c.changeTo(r,O,t)})}),{onPointerDown:C(function(e,o){if(o=="y")return I.from(e,{getPage:H,scrollDelta(r,h){c.changeDiff(r),t()},onFinish(r){const u=Ie.getFromVelocity(r).distance+c.get();l(Math.round(u/m));const y=Math.round(u/m)*m;c.changeTo(y,O,t).then(()=>{t(),g.set(i.get())})}})}),children(){a.div({s_transform(){return`translateY(${-c.get()}px)`},children(){console.log("dd",n()),ge(function(e){const o=i.get(),r=Math.ceil(n()/m),h=Math.floor(r/2);for(let u=o-h;u<=o+h;u++)e(u,d)})}})}}}function He(n){const{yearMonthScrollY:m,scrollYearMonthOpenHeight:d}=j.consume(),g=k(()=>_({0:d(),[d()]:0},function(i,s,c,l){return s?xe(i,c,l,pe):l[1]}));a.div({s_height(){return g(m.get())+"px"},children(){a.div({s_height(){return d()+"px"},s_transform(){return`translateY(${-m.get()}px)`},className:"relative w-full",children(){a.div({className:"absolute inset-0 flex items-stretch justify-center",children(){a.div({className:"flex-1 relative flex flex-col justify-center overflow-hidden",...K({height:d,cellHeight:44,value:{get(){return n.get().year},set(i){const s=n.get();if(s.year!=i){const c=Math.min(z(i,s.month),s.day);n.set(b.from(i,s.month,c))}}},renderCell(i){a.div({className:"h-11 text-center flex items-center justify-center",childrenType:"text",children:N(i,2)})}})}),a.div({className:"flex-1 relative flex flex-col justify-center overflow-hidden",...K({height:d,cellHeight:44,value:{get(){return n.get().month},set(i){const s=n.get();if(i!=s.month){const c=Math.min(z(s.year,i),s.day);n.set(b.from(s.year,i,c))}}},format(i){return i=i-1,i=i%12,(i+12)%12+1},renderCell(i){a.div({className:"h-11 text-center flex items-center justify-center",childrenType:"text",children:N(i,2)})}})})}}),a.div({className:"absolute inset-0 flex flex-col items-stretch justify-center pointer-events-none ",children(){a.div({className:"flex-1 bg-linear-to-b from-base-100 to-100% to-base-100/90"}),a.div({className:"h-11 flex flex-col justify-center"}),a.div({className:"flex-1 bg-linear-to-t from-base-100 to-100% to-base-100/90"})}})}})}})}const J=M.get();function qe(){ve(function({width:n},m){m&&Ne(function(){Ye(),we()});const d=b.fromDate(new Date),g=A(d,R),i=setInterval(()=>{g.set(b.fromDate(new Date))},W/2);be(()=>{clearInterval(i)});const s=A(d,R);function c(){return 5*n()/7}function l(){return 44*3}const t=T(c()),e=T(l());function o(){return e.get()!=l()}j.provide({yearMonthScrollY:e,scrollYearMonthOpenHeight:l,calendarScrollY:t,calendarOpenHeight:c,today:g.get,showCalendar(){return t.get()!=c()},async calendarClose(){o()&&e.changeTo(l()),t.changeTo(c())},calendarScroll(r,h){if(o()){const u=e.get()+r;u>=l()?(e.set(l()),L()):u<=0?e.set(e.get()+r/3):e.set(u)}else{const u=t.get()+r;u>=c()?(t.set(c()),L()):u<=0?(t.set(0),e.changeDiff(u)):t.set(u)}},calendarFinish(r){o()?J.getFromVelocity(r).distance+e.get()>l()/2?e.changeTo(l(),Y(r)):e.changeTo(0,Y(r)):J.getFromDistance(r).distance+t.get()>c()/2?t.changeTo(c(),Y(r)):t.changeTo(0,Y(r))}}),a.div({className:"absolute inset-0 flex flex-col select-none touch-none",children(){He(s),$e(s,n),Le(s)}})})}function Je(){qe()}export{Je as default};
