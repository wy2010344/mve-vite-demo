import{n as A,c as E,aM as l}from"./index-DQyCy5E-.js";import{ArrayRender as k}from"./xmlRender-Cs2GLL5u.js";import x from"./task-DIqtgWhi.js";import C from"./indicator-5AO1a8WM.js";import D from"./columnBase-OYmphuGq.js";import{TaskContext as N,ColumnContext as S}from"./context-CdpMRMpB.js";import"./cardBase-BzdcLvj0.js";import"./mve-icon-CmU6nyKL.js";import"./index-KxogOz8g.js";import"./iconBase-CeRrWgC7.js";import"./type-DRAuYFMP.js";import"./chunk-LSEVNFON-G8OzWBoO.js";function K({title:v,type:a}){const{dragId:g,tasks:n}=N.consume(),u=A(function(){return n.get().filter(e=>e.type==a)}),d=E(void 0);S.provide({type:a,getActive:d.get});function p(e){var r;const i=Array.from(document.querySelectorAll(`[data-column="${a}"]`)),t=100,o=(r=i.reduce((m,I)=>{const T=I.getBoundingClientRect(),f=e-(T.top+t/2);return f<0&&f>m.offset?{offset:f,element:I}:m},{offset:Number.NEGATIVE_INFINITY,element:i.at(-1)}).element)==null?void 0:r.dataset.before;return d.get()!=o&&d.set(o),o}return l.createElement(D,{type:a,title:v,tasks:n,getTasks:u,onDragOver:e=>{e.preventDefault(),e.dataTransfer.dropEffect="move",p(e.clientY)},onDragLeave:e=>{d.set(void 0)},onDrop:e=>{const i=p(e.clientY),t=g.get();if(i!=t){const s=n.get().find(r=>r.id==t),o=s.type==a?s:{...s,type:a},c=n.get().filter(r=>r.id!=t);if(i=="")c.push(o);else{const r=c.findIndex(m=>m.id==i);c.splice(r,0,o)}n.set(c)}d.set(void 0)}},l.createElement(k,{getArray:u,getKey:e=>e.id,render:function(e,i,t){x({getTask:e,onDelete(s){n.set(n.get().filter(o=>o.id!=t))},onDragStart(s){g.set(t)}})}}),l.createElement(C,null))}export{K as default};
