import{x,bg as y,c as b,aP as w,f as n,aJ as T,j as m,i as v,k as N,bh as _,w as f,m as a,l as I}from"./index-Dxu4lnfn.js";import{c as M,d as S}from"./index-DGGGthP9.js";import{r as g}from"./mve-icon-Bb-GIgrm.js";import"./iconBase-BD6ICo6R.js";async function C(i,o=x){const l=new URL(i);for(const s in o){const c=o[s];typeof c<"u"&&l.searchParams.append(s,c)}const h=y();return(await fetch(l.toString(),{method:"GET",headers:{accept:"application/json",Authorization:"Bearer eyJhbGciOiJIUzI1NiJ9.eyJhdWQiOiIwMGEzMjc2YWE2ZGQxZmE1ZmE2YzFhZDQyOGI0Zjg2OSIsIm5iZiI6MTY0NzY5NDQ4Ni43NTAwMDAyLCJzdWIiOiI2MjM1ZDI5NjQ2YWVkNDAwN2IxOTUzOGUiLCJzY29wZXMiOlsiYXBpX3JlYWQiXSwidmVyc2lvbiI6MX0.jkFQTrtAZYCOYkFNpbx47C_r3AxDPcILDVcX_7V6d6I"},signal:h})).json()}function O(i){return C("https://api.themoviedb.org/3/discover/movie",i)}const A={images:{secure_base_url:"https://image.tmdb.org/t/p/"}};function Y(i,o="w92"){return i?A.images.secure_base_url+o+i:""}function Z(){const i=b(void 0),{loading:o,loadMore:l,get:h}=w(()=>{const e=i.get();return{async getAfter(r){const t=await O({page:r,sort_by:e?`${e.key}.${e.dir}`:void 0});return{list:t.results,nextKey:r+1,hasMore:t.total_pages!=r,total:t.total_results}},first:1}});function d(e,r){n.button({className:"daisy-btn daisy-btn-ghost daisy-btn-md",onClick(){const t=i.get();t?.key==e?i.set({key:e,dir:t.dir=="asc"?"desc":"asc"}):i.set({key:e,dir:"desc"})},children(){a.span().renderTextContent(r),I(i.get,function(t){t?.key==e&&(t.dir=="asc"?M(g,"20px"):t.dir=="desc"&&S(g,"20px"))})}})}const s=[{head(){a.th().renderText`序号`},cell(e,r){a.th().renderTextContent(()=>r()+1)}},{head(){a.td({className:"min-w-38"}).renderText`封面`},cell(e){n.td({children(){n.img({className:"inline",src(){return Y(e().poster_path)}})}})}},{head(){a.td({className:"max-w-50 min-w-50"}).renderText`标题`},cell(e){a.td().renderTextContent(()=>{const r=e().title,t=e().originalTitle;return t&&r!=t?`${r}(${t})`:r})}},{head(){n.td({className:"min-w-38",children(){d("popularity","人气")}})},cell(e){a.td().renderTextContent(()=>e().popularity)}},{head(){n.td({className:"min-w-38 flex flex-col items-center",children(){d("vote_average","平均得分"),f`/`,d("vote_count","投票人数")}})},cell(e){a.td().renderTextContent(()=>{const r=e();return`${r.vote_average} / ${r.vote_count}`})}},{head(){n.td({className:"min-w-40",children(){d("primary_release_date","发布日期")}})},cell(e){a.td().renderTextContent(()=>e().release_date)}},{head(){a.td({className:"min-w-40"}).renderText`原始语言`},cell(e){a.td().renderTextContent(()=>e().original_language)}},{head(){a.td({className:"min-w-10"}).renderText`分级`},cell(e){a.td().renderTextContent(()=>e().adult?"成人":"")}},{head(){a.th().renderText`操作`},cell(e,r){n.th({children(){}})}}];function c(){return n.tr({children(){n.td({colSpan:s.length,s_textAlign:"center",children(){n.div({className:"daisy-loading"})}})}})}n.div({className:"overflow-x-auto w-full",children(){n.table({className:"daisy-table daisy-table-xs daisy-table-pin-rows daisy-table-pin-cols text-center",children(){T(h,e=>e?.type,function(e){if(e=="success"){const r=()=>{const t=h();if(t?.type=="success")return t.value;throw"not support"};n.thead({children(){n.tr({children(){s.forEach(t=>{t.head()})}})}}),n.tbody({children(){m(o,c),v(()=>r().list,t=>t.id,function(t,u){n.tr({children(){s.forEach(p=>{p.cell(t,u)})}})}),m(()=>r().hasMore,function(){const t=c();N(_(u=>{u[0].intersectionRatio>0&&l()},t))})}}),n.tfoot({children(){n.tr({children(){n.td({colSpan:s.length,children(){n.div({children(){f`第${()=>r().nextKey-1}条,每页20条,总记录${()=>r().total}条,共${()=>Math.ceil(r().total/20)}页`}})}})}})}})}})}})}})}export{Z as default};
