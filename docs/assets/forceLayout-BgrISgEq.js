import{K as P,bX as at,ax as W,bc as tt,bY as ot,c as E}from"./index-BeB-7kZt.js";function lt(t){const i=+this._x.call(null,t),n=+this._y.call(null,t);return it(this.cover(i,n),i,n,t)}function it(t,i,n,e){if(isNaN(i)||isNaN(n))return t;var s,r=t._root,h={data:e},a=t._x0,l=t._y0,o=t._x1,f=t._y1,u,c,_,x,w,v,p,y;if(!r)return t._root=h,t;for(;r.length;)if((w=i>=(u=(a+o)/2))?a=u:o=u,(v=n>=(c=(l+f)/2))?l=c:f=c,s=r,!(r=r[p=v<<1|w]))return s[p]=h,t;if(_=+t._x.call(null,r.data),x=+t._y.call(null,r.data),i===_&&n===x)return h.next=r,s?s[p]=h:t._root=h,t;do s=s?s[p]=new Array(4):t._root=new Array(4),(w=i>=(u=(a+o)/2))?a=u:o=u,(v=n>=(c=(l+f)/2))?l=c:f=c;while((p=v<<1|w)===(y=(x>=c)<<1|_>=u));return s[y]=r,s[p]=h,t}function ft(t){var i,n,e=t.length,s,r,h=new Array(e),a=new Array(e),l=1/0,o=1/0,f=-1/0,u=-1/0;for(n=0;n<e;++n)isNaN(s=+this._x.call(null,i=t[n]))||isNaN(r=+this._y.call(null,i))||(h[n]=s,a[n]=r,s<l&&(l=s),s>f&&(f=s),r<o&&(o=r),r>u&&(u=r));if(l>f||o>u)return this;for(this.cover(l,o).cover(f,u),n=0;n<e;++n)it(this,h[n],a[n],t[n]);return this}function ut(t,i){if(isNaN(t=+t)||isNaN(i=+i))return this;var n=this._x0,e=this._y0,s=this._x1,r=this._y1;if(isNaN(n))s=(n=Math.floor(t))+1,r=(e=Math.floor(i))+1;else{for(var h=s-n||1,a=this._root,l,o;n>t||t>=s||e>i||i>=r;)switch(o=(i<e)<<1|t<n,l=new Array(4),l[o]=a,a=l,h*=2,o){case 0:s=n+h,r=e+h;break;case 1:n=s-h,r=e+h;break;case 2:s=n+h,e=r-h;break;case 3:n=s-h,e=r-h;break}this._root&&this._root.length&&(this._root=a)}return this._x0=n,this._y0=e,this._x1=s,this._y1=r,this}function ct(){var t=[];return this.visit(function(i){if(!i.length)do t.push(i.data);while(i=i.next)}),t}function _t(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function q(t,i,n,e,s){this.node=t,this.x0=i,this.y0=n,this.x1=e,this.y1=s}function xt(t,i,n){var e,s=this._x0,r=this._y0,h,a,l,o,f=this._x1,u=this._y1,c=[],_=this._root,x,w;for(_&&c.push(new q(_,s,r,f,u)),n==null?n=1/0:(s=t-n,r=i-n,f=t+n,u=i+n,n*=n);x=c.pop();)if(!(!(_=x.node)||(h=x.x0)>f||(a=x.y0)>u||(l=x.x1)<s||(o=x.y1)<r))if(_.length){var v=(h+l)/2,p=(a+o)/2;c.push(new q(_[3],v,p,l,o),new q(_[2],h,p,v,o),new q(_[1],v,a,l,p),new q(_[0],h,a,v,p)),(w=(i>=p)<<1|t>=v)&&(x=c[c.length-1],c[c.length-1]=c[c.length-1-w],c[c.length-1-w]=x)}else{var y=t-+this._x.call(null,_.data),A=i-+this._y.call(null,_.data),N=y*y+A*A;if(N<n){var z=Math.sqrt(n=N);s=t-z,r=i-z,f=t+z,u=i+z,e=_.data}}return e}function vt(t){if(isNaN(f=+this._x.call(null,t))||isNaN(u=+this._y.call(null,t)))return this;var i,n=this._root,e,s,r,h=this._x0,a=this._y0,l=this._x1,o=this._y1,f,u,c,_,x,w,v,p;if(!n)return this;if(n.length)for(;;){if((x=f>=(c=(h+l)/2))?h=c:l=c,(w=u>=(_=(a+o)/2))?a=_:o=_,i=n,!(n=n[v=w<<1|x]))return this;if(!n.length)break;(i[v+1&3]||i[v+2&3]||i[v+3&3])&&(e=i,p=v)}for(;n.data!==t;)if(s=n,!(n=n.next))return this;return(r=n.next)&&delete n.next,s?(r?s.next=r:delete s.next,this):i?(r?i[v]=r:delete i[v],(n=i[0]||i[1]||i[2]||i[3])&&n===(i[3]||i[2]||i[1]||i[0])&&!n.length&&(e?e[p]=n:this._root=n),this):(this._root=r,this)}function gt(t){for(var i=0,n=t.length;i<n;++i)this.remove(t[i]);return this}function yt(){return this._root}function pt(){var t=0;return this.visit(function(i){if(!i.length)do++t;while(i=i.next)}),t}function wt(t){var i=[],n,e=this._root,s,r,h,a,l;for(e&&i.push(new q(e,this._x0,this._y0,this._x1,this._y1));n=i.pop();)if(!t(e=n.node,r=n.x0,h=n.y0,a=n.x1,l=n.y1)&&e.length){var o=(r+a)/2,f=(h+l)/2;(s=e[3])&&i.push(new q(s,o,f,a,l)),(s=e[2])&&i.push(new q(s,r,f,o,l)),(s=e[1])&&i.push(new q(s,o,h,a,f)),(s=e[0])&&i.push(new q(s,r,h,o,f))}return this}function dt(t){var i=[],n=[],e;for(this._root&&i.push(new q(this._root,this._x0,this._y0,this._x1,this._y1));e=i.pop();){var s=e.node;if(s.length){var r,h=e.x0,a=e.y0,l=e.x1,o=e.y1,f=(h+l)/2,u=(a+o)/2;(r=s[0])&&i.push(new q(r,h,a,f,u)),(r=s[1])&&i.push(new q(r,f,a,l,u)),(r=s[2])&&i.push(new q(r,h,u,f,o)),(r=s[3])&&i.push(new q(r,f,u,l,o))}n.push(e)}for(;e=n.pop();)t(e.node,e.x0,e.y0,e.x1,e.y1);return this}function zt(t){return t[0]}function At(t){return arguments.length?(this._x=t,this):this._x}function Nt(t){return t[1]}function Mt(t){return arguments.length?(this._y=t,this):this._y}function X(t,i,n){var e=new Y(i??zt,n??Nt,NaN,NaN,NaN,NaN);return t==null?e:e.addAll(t)}function Y(t,i,n,e,s,r){this._x=t,this._y=i,this._x0=n,this._y0=e,this._x1=s,this._y1=r,this._root=void 0}function B(t){for(var i={data:t.data},n=i;t=t.next;)n=n.next={data:t.data};return i}var S=X.prototype=Y.prototype;S.copy=function(){var t=new Y(this._x,this._y,this._x0,this._y0,this._x1,this._y1),i=this._root,n,e;if(!i)return t;if(!i.length)return t._root=B(i),t;for(n=[{source:i,target:t._root=new Array(4)}];i=n.pop();)for(var s=0;s<4;++s)(e=i.source[s])&&(e.length?n.push({source:e,target:i.target[s]=new Array(4)}):i.target[s]=B(e));return t};S.add=lt;S.addAll=ft;S.cover=ut;S.data=ct;S.extent=_t;S.find=xt;S.remove=vt;S.removeAll=gt;S.root=yt;S.size=pt;S.visit=wt;S.visitAfter=dt;S.x=At;S.y=Mt;function $t(t){const i=+this._x.call(null,t);return nt(this.cover(i),i,t)}function nt(t,i,n){if(isNaN(i))return t;var e,s=t._root,r={data:n},h=t._x0,a=t._x1,l,o,f,u,c;if(!s)return t._root=r,t;for(;s.length;)if((f=i>=(l=(h+a)/2))?h=l:a=l,e=s,!(s=s[u=+f]))return e[u]=r,t;if(o=+t._x.call(null,s.data),i===o)return r.next=s,e?e[u]=r:t._root=r,t;do e=e?e[u]=new Array(2):t._root=new Array(2),(f=i>=(l=(h+a)/2))?h=l:a=l;while((u=+f)==(c=+(o>=l)));return e[c]=s,e[u]=r,t}function Dt(t){Array.isArray(t)||(t=Array.from(t));const i=t.length,n=new Float64Array(i);let e=1/0,s=-1/0;for(let r=0,h;r<i;++r)isNaN(h=+this._x.call(null,t[r]))||(n[r]=h,h<e&&(e=h),h>s&&(s=h));if(e>s)return this;this.cover(e).cover(s);for(let r=0;r<i;++r)nt(this,n[r],t[r]);return this}function bt(t){if(isNaN(t=+t))return this;var i=this._x0,n=this._x1;if(isNaN(i))n=(i=Math.floor(t))+1;else{for(var e=n-i||1,s=this._root,r,h;i>t||t>=n;)switch(h=+(t<i),r=new Array(2),r[h]=s,s=r,e*=2,h){case 0:n=i+e;break;case 1:i=n-e;break}this._root&&this._root.length&&(this._root=s)}return this._x0=i,this._x1=n,this}function qt(){var t=[];return this.visit(function(i){if(!i.length)do t.push(i.data);while(i=i.next)}),t}function St(t){return arguments.length?this.cover(+t[0][0]).cover(+t[1][0]):isNaN(this._x0)?void 0:[[this._x0],[this._x1]]}function j(t,i,n){this.node=t,this.x0=i,this.x1=n}function kt(t,i){var n,e=this._x0,s,r,h=this._x1,a=[],l=this._root,o,f;for(l&&a.push(new j(l,e,h)),i==null?i=1/0:(e=t-i,h=t+i);o=a.pop();)if(!(!(l=o.node)||(s=o.x0)>h||(r=o.x1)<e))if(l.length){var u=(s+r)/2;a.push(new j(l[1],u,r),new j(l[0],s,u)),(f=+(t>=u))&&(o=a[a.length-1],a[a.length-1]=a[a.length-1-f],a[a.length-1-f]=o)}else{var c=Math.abs(t-+this._x.call(null,l.data));c<i&&(i=c,e=t-c,h=t+c,n=l.data)}return n}function It(t){if(isNaN(l=+this._x.call(null,t)))return this;var i,n=this._root,e,s,r,h=this._x0,a=this._x1,l,o,f,u,c;if(!n)return this;if(n.length)for(;;){if((f=l>=(o=(h+a)/2))?h=o:a=o,i=n,!(n=n[u=+f]))return this;if(!n.length)break;i[u+1&1]&&(e=i,c=u)}for(;n.data!==t;)if(s=n,!(n=n.next))return this;return(r=n.next)&&delete n.next,s?(r?s.next=r:delete s.next,this):i?(r?i[u]=r:delete i[u],(n=i[0]||i[1])&&n===(i[1]||i[0])&&!n.length&&(e?e[c]=n:this._root=n),this):(this._root=r,this)}function jt(t){for(var i=0,n=t.length;i<n;++i)this.remove(t[i]);return this}function Rt(){return this._root}function Lt(){var t=0;return this.visit(function(i){if(!i.length)do++t;while(i=i.next)}),t}function Ft(t){var i=[],n,e=this._root,s,r,h;for(e&&i.push(new j(e,this._x0,this._x1));n=i.pop();)if(!t(e=n.node,r=n.x0,h=n.x1)&&e.length){var a=(r+h)/2;(s=e[1])&&i.push(new j(s,a,h)),(s=e[0])&&i.push(new j(s,r,a))}return this}function Kt(t){var i=[],n=[],e;for(this._root&&i.push(new j(this._root,this._x0,this._x1));e=i.pop();){var s=e.node;if(s.length){var r,h=e.x0,a=e.x1,l=(h+a)/2;(r=s[0])&&i.push(new j(r,h,l)),(r=s[1])&&i.push(new j(r,l,a))}n.push(e)}for(;e=n.pop();)t(e.node,e.x0,e.x1);return this}function Pt(t){return t[0]}function Et(t){return arguments.length?(this._x=t,this):this._x}function m(t,i){var n=new C(i??Pt,NaN,NaN);return t==null?n:n.addAll(t)}function C(t,i,n){this._x=t,this._x0=i,this._x1=n,this._root=void 0}function Z(t){for(var i={data:t.data},n=i;t=t.next;)n=n.next={data:t.data};return i}var k=m.prototype=C.prototype;k.copy=function(){var t=new C(this._x,this._x0,this._x1),i=this._root,n,e;if(!i)return t;if(!i.length)return t._root=Z(i),t;for(n=[{source:i,target:t._root=new Array(2)}];i=n.pop();)for(var s=0;s<2;++s)(e=i.source[s])&&(e.length?n.push({source:e,target:i.target[s]=new Array(2)}):i.target[s]=Z(e));return t};k.add=$t;k.addAll=Dt;k.cover=bt;k.data=qt;k.extent=St;k.find=kt;k.remove=It;k.removeAll=jt;k.root=Rt;k.size=Lt;k.visit=Ft;k.visitAfter=Kt;k.x=Et;function Tt(t){const i=+this._x.call(null,t),n=+this._y.call(null,t),e=+this._z.call(null,t);return et(this.cover(i,n,e),i,n,e,t)}function et(t,i,n,e,s){if(isNaN(i)||isNaN(n)||isNaN(e))return t;var r,h=t._root,a={data:s},l=t._x0,o=t._y0,f=t._z0,u=t._x1,c=t._y1,_=t._z1,x,w,v,p,y,A,N,z,$,b,K;if(!h)return t._root=a,t;for(;h.length;)if((N=i>=(x=(l+u)/2))?l=x:u=x,(z=n>=(w=(o+c)/2))?o=w:c=w,($=e>=(v=(f+_)/2))?f=v:_=v,r=h,!(h=h[b=$<<2|z<<1|N]))return r[b]=a,t;if(p=+t._x.call(null,h.data),y=+t._y.call(null,h.data),A=+t._z.call(null,h.data),i===p&&n===y&&e===A)return a.next=h,r?r[b]=a:t._root=a,t;do r=r?r[b]=new Array(8):t._root=new Array(8),(N=i>=(x=(l+u)/2))?l=x:u=x,(z=n>=(w=(o+c)/2))?o=w:c=w,($=e>=(v=(f+_)/2))?f=v:_=v;while((b=$<<2|z<<1|N)===(K=(A>=v)<<2|(y>=w)<<1|p>=x));return r[K]=h,r[b]=a,t}function Xt(t){Array.isArray(t)||(t=Array.from(t));const i=t.length,n=new Float64Array(i),e=new Float64Array(i),s=new Float64Array(i);let r=1/0,h=1/0,a=1/0,l=-1/0,o=-1/0,f=-1/0;for(let u=0,c,_,x,w;u<i;++u)isNaN(_=+this._x.call(null,c=t[u]))||isNaN(x=+this._y.call(null,c))||isNaN(w=+this._z.call(null,c))||(n[u]=_,e[u]=x,s[u]=w,_<r&&(r=_),_>l&&(l=_),x<h&&(h=x),x>o&&(o=x),w<a&&(a=w),w>f&&(f=w));if(r>l||h>o||a>f)return this;this.cover(r,h,a).cover(l,o,f);for(let u=0;u<i;++u)et(this,n[u],e[u],s[u],t[u]);return this}function Yt(t,i,n){if(isNaN(t=+t)||isNaN(i=+i)||isNaN(n=+n))return this;var e=this._x0,s=this._y0,r=this._z0,h=this._x1,a=this._y1,l=this._z1;if(isNaN(e))h=(e=Math.floor(t))+1,a=(s=Math.floor(i))+1,l=(r=Math.floor(n))+1;else{for(var o=h-e||1,f=this._root,u,c;e>t||t>=h||s>i||i>=a||r>n||n>=l;)switch(c=(n<r)<<2|(i<s)<<1|t<e,u=new Array(8),u[c]=f,f=u,o*=2,c){case 0:h=e+o,a=s+o,l=r+o;break;case 1:e=h-o,a=s+o,l=r+o;break;case 2:h=e+o,s=a-o,l=r+o;break;case 3:e=h-o,s=a-o,l=r+o;break;case 4:h=e+o,a=s+o,r=l-o;break;case 5:e=h-o,a=s+o,r=l-o;break;case 6:h=e+o,s=a-o,r=l-o;break;case 7:e=h-o,s=a-o,r=l-o;break}this._root&&this._root.length&&(this._root=f)}return this._x0=e,this._y0=s,this._z0=r,this._x1=h,this._y1=a,this._z1=l,this}function mt(){var t=[];return this.visit(function(i){if(!i.length)do t.push(i.data);while(i=i.next)}),t}function Ct(t){return arguments.length?this.cover(+t[0][0],+t[0][1],+t[0][2]).cover(+t[1][0],+t[1][1],+t[1][2]):isNaN(this._x0)?void 0:[[this._x0,this._y0,this._z0],[this._x1,this._y1,this._z1]]}function M(t,i,n,e,s,r,h){this.node=t,this.x0=i,this.y0=n,this.z0=e,this.x1=s,this.y1=r,this.z1=h}function Gt(t,i,n,e){var s,r=this._x0,h=this._y0,a=this._z0,l,o,f,u,c,_,x=this._x1,w=this._y1,v=this._z1,p=[],y=this._root,A,N;for(y&&p.push(new M(y,r,h,a,x,w,v)),e==null?e=1/0:(r=t-e,h=i-e,a=n-e,x=t+e,w=i+e,v=n+e,e*=e);A=p.pop();)if(!(!(y=A.node)||(l=A.x0)>x||(o=A.y0)>w||(f=A.z0)>v||(u=A.x1)<r||(c=A.y1)<h||(_=A.z1)<a))if(y.length){var z=(l+u)/2,$=(o+c)/2,b=(f+_)/2;p.push(new M(y[7],z,$,b,u,c,_),new M(y[6],l,$,b,z,c,_),new M(y[5],z,o,b,u,$,_),new M(y[4],l,o,b,z,$,_),new M(y[3],z,$,f,u,c,b),new M(y[2],l,$,f,z,c,b),new M(y[1],z,o,f,u,$,b),new M(y[0],l,o,f,z,$,b)),(N=(n>=b)<<2|(i>=$)<<1|t>=z)&&(A=p[p.length-1],p[p.length-1]=p[p.length-1-N],p[p.length-1-N]=A)}else{var K=t-+this._x.call(null,y.data),H=i-+this._y.call(null,y.data),Q=n-+this._z.call(null,y.data),V=K*K+H*H+Q*Q;if(V<e){var R=Math.sqrt(e=V);r=t-R,h=i-R,a=n-R,x=t+R,w=i+R,v=n+R,s=y.data}}return s}const Ot=(t,i,n,e,s,r)=>Math.sqrt((t-e)**2+(i-s)**2+(n-r)**2);function Ht(t,i,n,e){const s=[],r=t-e,h=i-e,a=n-e,l=t+e,o=i+e,f=n+e;return this.visit((u,c,_,x,w,v,p)=>{if(!u.length)do{const y=u.data;Ot(t,i,n,this._x(y),this._y(y),this._z(y))<=e&&s.push(y)}while(u=u.next);return c>l||_>o||x>f||w<r||v<h||p<a}),s}function Qt(t){if(isNaN(c=+this._x.call(null,t))||isNaN(_=+this._y.call(null,t))||isNaN(x=+this._z.call(null,t)))return this;var i,n=this._root,e,s,r,h=this._x0,a=this._y0,l=this._z0,o=this._x1,f=this._y1,u=this._z1,c,_,x,w,v,p,y,A,N,z,$;if(!n)return this;if(n.length)for(;;){if((y=c>=(w=(h+o)/2))?h=w:o=w,(A=_>=(v=(a+f)/2))?a=v:f=v,(N=x>=(p=(l+u)/2))?l=p:u=p,i=n,!(n=n[z=N<<2|A<<1|y]))return this;if(!n.length)break;(i[z+1&7]||i[z+2&7]||i[z+3&7]||i[z+4&7]||i[z+5&7]||i[z+6&7]||i[z+7&7])&&(e=i,$=z)}for(;n.data!==t;)if(s=n,!(n=n.next))return this;return(r=n.next)&&delete n.next,s?(r?s.next=r:delete s.next,this):i?(r?i[z]=r:delete i[z],(n=i[0]||i[1]||i[2]||i[3]||i[4]||i[5]||i[6]||i[7])&&n===(i[7]||i[6]||i[5]||i[4]||i[3]||i[2]||i[1]||i[0])&&!n.length&&(e?e[$]=n:this._root=n),this):(this._root=r,this)}function Vt(t){for(var i=0,n=t.length;i<n;++i)this.remove(t[i]);return this}function Wt(){return this._root}function Bt(){var t=0;return this.visit(function(i){if(!i.length)do++t;while(i=i.next)}),t}function Zt(t){var i=[],n,e=this._root,s,r,h,a,l,o,f;for(e&&i.push(new M(e,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));n=i.pop();)if(!t(e=n.node,r=n.x0,h=n.y0,a=n.z0,l=n.x1,o=n.y1,f=n.z1)&&e.length){var u=(r+l)/2,c=(h+o)/2,_=(a+f)/2;(s=e[7])&&i.push(new M(s,u,c,_,l,o,f)),(s=e[6])&&i.push(new M(s,r,c,_,u,o,f)),(s=e[5])&&i.push(new M(s,u,h,_,l,c,f)),(s=e[4])&&i.push(new M(s,r,h,_,u,c,f)),(s=e[3])&&i.push(new M(s,u,c,a,l,o,_)),(s=e[2])&&i.push(new M(s,r,c,a,u,o,_)),(s=e[1])&&i.push(new M(s,u,h,a,l,c,_)),(s=e[0])&&i.push(new M(s,r,h,a,u,c,_))}return this}function Jt(t){var i=[],n=[],e;for(this._root&&i.push(new M(this._root,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));e=i.pop();){var s=e.node;if(s.length){var r,h=e.x0,a=e.y0,l=e.z0,o=e.x1,f=e.y1,u=e.z1,c=(h+o)/2,_=(a+f)/2,x=(l+u)/2;(r=s[0])&&i.push(new M(r,h,a,l,c,_,x)),(r=s[1])&&i.push(new M(r,c,a,l,o,_,x)),(r=s[2])&&i.push(new M(r,h,_,l,c,f,x)),(r=s[3])&&i.push(new M(r,c,_,l,o,f,x)),(r=s[4])&&i.push(new M(r,h,a,x,c,_,u)),(r=s[5])&&i.push(new M(r,c,a,x,o,_,u)),(r=s[6])&&i.push(new M(r,h,_,x,c,f,u)),(r=s[7])&&i.push(new M(r,c,_,x,o,f,u))}n.push(e)}for(;e=n.pop();)t(e.node,e.x0,e.y0,e.z0,e.x1,e.y1,e.z1);return this}function Ut(t){return t[0]}function ti(t){return arguments.length?(this._x=t,this):this._x}function ii(t){return t[1]}function ni(t){return arguments.length?(this._y=t,this):this._y}function ei(t){return t[2]}function ri(t){return arguments.length?(this._z=t,this):this._z}function G(t,i,n,e){var s=new O(i??Ut,n??ii,e??ei,NaN,NaN,NaN,NaN,NaN,NaN);return t==null?s:s.addAll(t)}function O(t,i,n,e,s,r,h,a,l){this._x=t,this._y=i,this._z=n,this._x0=e,this._y0=s,this._z0=r,this._x1=h,this._y1=a,this._z1=l,this._root=void 0}function J(t){for(var i={data:t.data},n=i;t=t.next;)n=n.next={data:t.data};return i}var D=G.prototype=O.prototype;D.copy=function(){var t=new O(this._x,this._y,this._z,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1),i=this._root,n,e;if(!i)return t;if(!i.length)return t._root=J(i),t;for(n=[{source:i,target:t._root=new Array(8)}];i=n.pop();)for(var s=0;s<8;++s)(e=i.source[s])&&(e.length?n.push({source:e,target:i.target[s]=new Array(8)}):i.target[s]=J(e));return t};D.add=Tt;D.addAll=Xt;D.cover=Yt;D.data=mt;D.extent=Ct;D.find=Gt;D.findAllWithinRadius=Ht;D.remove=Qt;D.removeAll=Vt;D.root=Wt;D.size=Bt;D.visit=Zt;D.visitAfter=Jt;D.x=ti;D.y=ni;D.z=ri;function I(t){return(t()-.5)*1e-6}function L(t){return i=>{const n=i[t];return n.d+n.v}}function si(){return 1}function wi({strength:t=1,iterations:i=1,random:n=Math.random,getRadius:e=si}=P){return function(s,r){d.nDim=r,d.strength=t,d.getRadius=e,d.random=n;for(let h=0;h<i;++h){const a=(r===1?m(s,L("x")):r===2?X(s,L("x"),L("y")):r===3?G(s,L("x"),L("y"),L("z")):null).visitAfter(ai);for(let l=0;l<s.length;++l){const o=s[l];d.node=o,d.ri=e(o),d.ri2=d.ri*d.ri,d.xi=o.x.d+o.x.v,r>1&&(d.yi=o.y.d+o.y.v),r>2&&(d.zi=o.z.d+o.z.v),a.visit(hi)}}}}const d={};function hi(t,i,n,e,s,r,h){const a=[i,n,e,s,r,h],l=a[0],o=a[1],f=a[2],u=a[d.nDim],c=a[d.nDim+1],_=a[d.nDim+2];let x=t.data,w=t.r,v=d.ri+w;if(x){if(x.index>d.node.index){let p=d.xi-x.x.d-x.x.v,y=d.nDim>1?d.yi-x.y.d-x.y.v:0,A=d.nDim>2?d.zi-x.z.d-x.z.v:0,N=p*p+y*y+A*A;N<v*v&&(p===0&&(p=I(d.random),N+=p*p),d.nDim>1&&y===0&&(y=I(d.random),N+=y*y),d.nDim>2&&A===0&&(A=I(d.random),N+=A*A),N=(v-(N=Math.sqrt(N)))/N*d.strength,d.node.x.v+=(p*=N)*(v=(w*=w)/(d.ri2+w)),d.nDim>1&&(d.node.y.v+=(y*=N)*v),d.nDim>2&&(d.node.z.v+=(A*=N)*v),x.x.v-=p*(v=1-v),d.nDim>1&&(x.y.v-=y*v),d.nDim>2&&(x.z.v-=A*v))}return}return l>d.xi+v||u<d.xi-v||d.nDim>1&&(o>d.yi+v||c<d.yi-v)||d.nDim>2&&(f>d.zi+v||_<d.zi-v)}function ai(t){if(t.data)return t.r=d.getRadius(t.data);for(let i=t.r=0;i<Math.pow(2,d.nDim);++i)t[i]&&t[i].r>t.r&&(t.r=t[i].r)}function di(t,{getZ:i=W(0),getStrength:n=W(.1)}=P){return function(e,s){for(var r=0,h=e.length,a;r<h;++r)a=e[r],a[t].v+=(i(a,r,e)-a[t].d)*n(a,r,e)*s}}function oi(){return 30}function zi({random:t=Math.random,getDistance:i=oi,iterations:n=1,getStrength:e}=P){let s;const r=[],h=[],a=e||(o=>1/Math.min(h[o.source.index],h[o.target.index]));function l(o){if(s!=o){s=o,r.length=0,h.length=0;const f=o.length;for(let u=0;u<f;++u){const c=o[u];h[c.source.index]=(h[c.source.index]||0)+1,h[c.target.index]=(h[c.target.index]||0)+1}for(let u=0;u<f;++u){const c=o[u];r[u]=h[c.source.index]/(h[c.source.index]+h[c.target.index])}}}return function(o,f,u){l(o);for(let c=0;c<n;++c){let _=0,x=0,w=0;for(let v=0;v<o.length;++v){const p=o[v],y=p.source,A=p.target;_=A.x.d+A.x.v-y.x.d-y.x.v||I(t),f>1&&(x=A.y.d+A.y.v-y.y.d-y.y.v||I(t)),f>2&&(w=A.z.d+A.z.v-y.z.d-y.z.v||I(t));let N=Math.sqrt(_*_+x*x+w*w);N=(N-i(p,v))/N*u*a(p,v),_*=N,x*=N,w*=N;let z=r[v];A.x.v-=_*z,f>1&&(A.y.v-=x*z),f>2&&(A.z.v-=w*z),z=1-z,y.x.v+=_*z,f>1&&(y.y.v+=x*z),f>2&&(y.z.v+=w*z)}}}}function F(t){return i=>i[t].d}const g={};function li(t){return-30}function Ai({distanceMax2:t=1/0,distanceMin2:i=1,theta2:n=.81,random:e=Math.random,getStrenth:s=li}=P){return function(r,h,a){g.alpha=a,g.nDim=h,g.distanceMax2=t,g.distanceMin2=i,g.theta2=n,g.random=e,g.getStrenth=s;const l=(g.nDim===1?m(r,F("x")):g.nDim===2?X(r,F("x"),F("y")):g.nDim===3?G(r,F("x"),F("y"),F("z")):null).visitAfter(fi);for(let o=0,f=r.length;o<f;++o)g.node=r[o],l.visit(ui)}}function fi(t){let i=0,n,e,s=0,r,h,a,l;const o=t.length;if(o){for(r=h=a=l=0;l<o;++l)(n=t[l])&&(e=Math.abs(n.value))&&(i+=n.value,s+=e,r+=e*(n.x||0),h+=e*(n.y||0),a+=e*(n.z||0));i*=Math.sqrt(4/o),t.x=r/s,g.nDim>1&&(t.y=h/s),g.nDim>2&&(t.z=a/s)}else{n=t,n.x=n.data.x.d,g.nDim>1&&(n.y=n.data.y.d),g.nDim>2&&(n.z=n.data.z.d);do i+=g.getStrenth(n.data);while(n=n.next)}t.value=i}function ui(t,i,n,e,s){if(!t.value)return!0;const r=[n,e,s][g.nDim-1];let h=t.x-g.node.x.d,a=g.nDim>1?t.y-g.node.y.d:0,l=g.nDim>2?t.z-g.node.z.d:0,o=r-i,f=h*h+a*a+l*l;if(o*o/g.theta2<f)return f<g.distanceMax2&&(h===0&&(h=I(g.random),f+=h*h),g.nDim>1&&a===0&&(a=I(g.random),f+=a*a),g.nDim>2&&l===0&&(l=I(g.random),f+=l*l),f<g.distanceMin2&&(f=Math.sqrt(g.distanceMin2*f)),g.node.x.v+=h*t.value*g.alpha/f,g.nDim>1&&(g.node.y.v+=a*t.value*g.alpha/f),g.nDim>2&&(g.node.z.v+=l*t.value*g.alpha/f)),!0;if(t.length||f>=g.distanceMax2)return;(t.data!==g.node||t.next)&&(h===0&&(h=I(g.random),f+=h*h),g.nDim>1&&a===0&&(a=I(g.random),f+=a*a),g.nDim>2&&l===0&&(l=I(g.random),f+=l*l),f<g.distanceMin2&&(f=Math.sqrt(g.distanceMin2*f)));do t.data!==g.node&&(o=g.getStrenth(t.data.value)*g.alpha/f,g.node.x.v+=h*o,g.nDim>1&&(g.node.y.v+=a*o),g.nDim>2&&(g.node.z.v+=l*o));while(t=t.next)}const ci=10,_i=Math.PI*(3-Math.sqrt(5)),xi=Math.PI*20/(9+Math.sqrt(221));function rt({nodes:t,fromNodes:i,createForceNode:n}){const e=new ot(t),s=Math.max(t.length,i.length);for(let r=0;r<s;r++){const h=i[r],a=e.get()[r];if(h){const l=h;if(a)if(a.value==l)a.index!=r&&e.replace(r,{...a,index:r});else{const o=e.get().findIndex(f=>f.value==l);if(o<0)e.insert(r,n(h,r,t));else{const f=e.get()[o];e.removeAt(o),e.insert(r,{...f,index:r})}}else e.insert(r,n(h,r,t))}else e.removeAt(r)}return e}function Ni(t){return rt(t).get()}function Mi(t){const i=rt(t),{nodes:n,links:e,fromLinks:s,getNodeKey:r,getSorceKey:h,getTargetKey:a,createFromKey:l,createForceNode:o}=t;function f(c){let _=i.get().find(x=>r(x.value)==c);if(!_){const x=i.get().length;_=o(l(c),x,n),i.insert(x,_)}return _}const u=[];for(let c=0;c<s.length;c++){const _=s[c];u.push({source:f(h(_)),target:f(a(_)),value:_})}return at(u,e,vi)?{nodes:i.get(),links:e}:{nodes:i.get(),links:u}}function $i(t,i,n,e,s){const r=ci*(i>2?Math.cbrt(.5+n):i>1?Math.sqrt(.5+n):n),h=n*_i,a=n*xi;if(i==1)return{index:n,value:t,x:e(r),y:s,z:s};if(i==2)return{index:n,value:t,x:e(r*Math.cos(h)),y:e(r*Math.sin(h)),z:s};if(i==3)return{index:n,value:t,x:e(r*Math.sin(h)*Math.cos(a)),y:e(r*Math.cos(h)),z:e(r*Math.sin(h)*Math.sin(a))};throw new Error("尚不支持")}function vi(t,i){return t.source==i.source&&t.target==i.target&&t.value==i.value}function Di(){return{alphaTarget:0,alpha:1,alphaMin:.001,alphaDecay:1-Math.pow(.001,1/300),velocityDecay:.6}}function T(t,i){if(typeof t.f=="number"){t.v=0,t.d=t.f;return}t.v=t.v*i,t.d=t.d+t.v}let st=2,ht=0;function gi(t){const i=ht,n=st;T(t.x,i),n>1&&T(t.y,i),n>2&&T(t.z,i)}function bi(t,i,n,e){let{alphaDecay:s,alphaTarget:r,alpha:h,velocityDecay:a}=i;h+=(r-h)*s,e(h),st=t,ht=a,n.forEach(gi),i.alpha=h}var yi=class{vSignal;dSignal;fSignal;constructor(t,i,n){this.dSignal=E(t),this.vSignal=E(i),this.fSignal=E(n)}get d(){return this.dSignal.get()}set d(t){this.dSignal.set(t)}get v(){return this.vSignal.get()}set v(t){this.vSignal.set(t)}get f(){return this.fSignal.get()}set f(t){this.fSignal.set(t)}};function qi(t,i=0,n){return new yi(t,i,n)}const U=tt(0),Si={d:0,dSignal:U,v:0,vSignal:U,fSignal:tt(void 0)};export{Ai as a,di as b,$i as c,qi as d,Si as e,zi as f,Ni as g,wi as h,Di as i,Mi as m,bi as t};
